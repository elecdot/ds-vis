{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Documentation Registry &amp; Version Control","text":"<p>This file tracks the current version of design documents and their binding to source code.</p> <p>Protocol for Agents: 1. Check: Before writing code, check this table. If you are modifying a \"Bound Path\", read the corresponding document. 2. Update: If your code changes the design (e.g., new OpCode, new Model method), you MUST update the document and increment the version here.</p> <p>Project state SSOT: see project_state.md for the active phase, assumptions/limitations, and next-phase plan. This is declared here for discoverability; the registry below remains for doc binding.</p> Document Version Status Bound Phase Bound Code Paths Last Updated index.md v1.0 Stable P0.7 Documentation Registry System 2025-12-24 project_state.md v0.7.33 Active P0.7 Project phase SSOT 2025-12-24 requirements.md v0.1 Stable P0.2 N/A 2025-12-14 architecture.md v0.5 Stable P0.6 <code>src/ds_vis/</code> (Global Structure) 2025-12-15 scene_graph.md v0.6.1 Active P0.7 <code>src/ds_vis/core/scene/</code> 2025-12-24 renderer.md v0.4.2 Draft P0.7 <code>src/ds_vis/renderers/</code> 2025-12-24 model.md v0.8.4 Draft P0.7 <code>src/ds_vis/core/models/</code> 2025-12-24 layout.md v0.7.4 Draft P0.7 <code>src/ds_vis/core/layout/</code> 2025-12-24 layout_v2.md v2.0 Draft P0.8 Layout Architecture Overhaul 2025-12-24 ops_spec.md v1.3 Stable P0.6 <code>src/ds_vis/core/ops/</code> 2025-12-20 animation.md v0.8 Draft P0.7 <code>src/ds_vis/core/models/</code>, <code>layout/</code>, <code>renderers/</code> 2025-12-24 dsl.md v0.2 Active P0.7 <code>src/ds_vis/dsl/</code>, <code>src/ds_vis/ui/main_window.py</code> (Interactive DSL), <code>src/ds_vis/dsl/cli.py</code> 2025-12-24 json.md v0.4 Active P0.7 <code>src/ds_vis/persistence/json_io.py</code> 2025-12-24 llm.md v0.1 Draft P0.7 <code>src/ds_vis/llm/</code> 2025-12-24 environment.md v0.2 Stable P0.2 <code>pyproject.toml</code>, <code>.github/</code> 2025-12-14 tdd_guide.md v1.1 Active P0.3 <code>tests/</code> (TDD workflow) 2025-12-15 dev_kb.md rolling Living P0.6 N/A 2025-12-21 dsl/parser.py v0.2 Active P0.7 DSL parsing (Interactive support) 2025-12-24 dsl/cli.py v0.1 Stub P0.7 CLI DSL/JSON runner 2025-12-24 persistence/json_io.py v0.3 Active P0.7 Scene-level JSON import/export 2025-12-24 PLAN.md v0.1 Draft P0.7 Iteration roadmap 2025-12-24 full_dev_guide.md v0.1 Draft P0.7 Full delivery workflow guide 2025-12-24"},{"location":"#documentation-reorganization-v01-2025-12-14","title":"Documentation Reorganization (v0.1 \u2014 2025-12-14)","text":"<p>As of December 14, 2025, the documentation structure has been reorganized for better navigation and mkdocs integration:</p> <p>Directory Changes: - <code>docs/design/</code> \u2014 Design and specification documents (requirements, architecture, ops, animation) - <code>docs/engineering/</code> \u2014 Engineering and development knowledge (environment, dev KB)</p> <p>File Renames: - <code>REQUEST.md</code> \u2192 <code>design/requirements.md</code> - <code>ARCHITECTURE.md</code> \u2192 <code>design/architecture.md</code> - <code>OPS_SPEC.md</code> \u2192 <code>design/ops_spec.md</code> - <code>ANIMATION_REQUIREMENTS.md</code> \u2192 <code>design/animation.md</code> - <code>ENVIRONMENT.md</code> \u2192 <code>engineering/environment.md</code> - <code>DEV_KNOWLEDGE_BASE.md</code> \u2192 <code>engineering/dev_kb.md</code></p> <p>Impact: All internal document links and external references must use the new paths. If you encounter a reference to an old path, update it to point to the new location. This change is tracked in the registry table above (version v0.2, updated 2025-12-14).</p>"},{"location":"#front-matter-metadata-phase-bound","title":"Front Matter Metadata (Phase-Bound)","text":"<p>Every design/engineering document carries a YAML front matter block with:</p> <ul> <li><code>bound_phase</code>: active delivery phase this document is aligned to (e.g., P0.2).</li> <li><code>version</code>: document version per registry above.</li> <li><code>status</code>: Stable / Draft / Living.</li> <li><code>last_updated</code>: ISO date for the latest substantive touch.</li> </ul> <p>This metadata is authoritative for doc status and should match the registry table. Update both when a document\u2019s phase alignment or version changes.</p>"},{"location":"#versioning-convention","title":"Versioning Convention","text":"<ul> <li>v0.x: Draft / Prototype phase.</li> <li>v1.x: Stable protocol (breaking changes require v2.x).</li> <li>Patch (v1.0.1): Clarifications, typos (no code changes required).</li> </ul>"},{"location":"project_state/","title":"Project State \u2014 Single Source of Truth","text":"<p>This document captures the active delivery phase, what is complete, current assumptions/limitations, and the next planned phase. It is the canonical status reference (SSOT) and should stay minimal.</p>"},{"location":"project_state/#active-phase-p07-list-tree-baselinemodel-first","title":"Active Phase: P0.7 \u2014 List + Tree Baseline\uff08Model-First\uff09","text":"<ul> <li>Scope: \u5728 ListModel \u5168\u94fe\u8def\u57fa\u7840\u4e0a\uff0c\u4ea4\u4ed8 BST/Tree \u6700\u5c0f\u53ef\u7528\u7248\u672c\uff08create/insert/search/delete/delete_all\uff09\uff0c\u9a8c\u8bc1\u201c\u6309\u6307\u4ee4\u5feb\u901f\u6269\u5c55\u201d\u94fe\u8def\uff0c\u4e3a AVL/Huffman \u7b49\u6811\u7c7b\u6a21\u578b\u6253\u6837\u3002</li> <li>Completion highlights:</li> <li>ListModel\uff1acreate/insert/delete_index/delete_all/search/update\uff08index/value \u53cc\u6a21\u5f0f\uff09\u5168\u94fe\u8def L2 \u5fae\u6b65\u9aa4 + \u6d88\u606f\u63d0\u793a\uff1bsentinel \u5c55\u793a\u7528\uff0cID \u4f7f\u7528 allocator\uff1bDev hook \u4e32\u8054\u5168\u64cd\u4f5c\uff0cUI \u5192\u70df\u6d4b\u8bd5\u8986\u76d6\u3002</li> <li>SeqlistModel\uff1a\u652f\u6301 create/insert/delete_index/delete_all/search/update\uff0c\u77e9\u5f62\u8282\u70b9 + \u6876\u5bb9\u5668\uff08\u4e13\u7528 LINEAR \u5e03\u5c40\uff09\uff0c\u6d88\u606f+\u72b6\u6001 L2 \u5fae\u6b65\u9aa4\uff1b\u547d\u4ee4\u6ce8\u518c/SceneGraph \u8def\u7531/\u63a7\u5236\u9762\u677f\u64cd\u4f5c\u53ef\u7528\uff0c\u6a21\u578b/UI \u6d4b\u8bd5\u8986\u76d6\u3002</li> <li>StackModel\uff1acreate/push/pop/delete_all/search\uff08\u7ebf\u6027\u626b\u63cf\uff09\u5168\u94fe\u8def\uff0c\u6808\u9876\u5728 index0\uff08top\u2192bottom \u987a\u5e8f\uff09\uff0c\u77e9\u5f62\u5355\u5143 + \u6876\u5bb9\u5668\uff08LINEAR \u7ad6\u5411\u3001\u5bb9\u5668\u6309\u8282\u70b9 bbox \u5c45\u4e2d\uff09\uff1b\u547d\u4ee4\u6ce8\u518c/SceneGraph \u8def\u7531/UI push/pop \u53ef\u7528\uff0c\u6a21\u578b/\u5e03\u5c40/UI \u6d4b\u8bd5\u8986\u76d6\u3002</li> <li>Huffman\uff08\u8fdb\u884c\u4e2d\uff09\uff1a\u65b0\u589e HuffmanModel\uff08build/delete_all\uff09\uff0c\u5c0f\u9876\u5806\u9a71\u52a8 L2 \u5fae\u6b65\u9aa4\uff08\u9009\u4e24\u6700\u5c0f\u2192\u5efa\u7236\u2192\u91cd\u6392\u961f\u5217\uff09\uff0cTreeLayout \u652f\u6301 queue_index \u53cc\u533a\u5e03\u5c40\uff08\u961f\u5217\u6a2a\u6392 + \u5b50\u6811\u5411\u4e0b\u5c55\u5f00\uff09\uff1bschema/SceneGraph \u6ce8\u518c\u3001UI kind \u6dfb\u52a0\uff0c\u6a21\u578b/\u5e03\u5c40/SceneGraph \u6d4b\u8bd5\u8986\u76d6\uff0c\u5b8c\u6574 UI/\u6e32\u67d3\u4f53\u9a8c\u5f85\u540e\u7eed\u9a8c\u6536\u3002</li> <li>BST\uff1a\u652f\u6301 create/insert/search/delete_value/delete_all\uff1b\u5220\u9664\u4f7f\u7528\u540e\u7ee7\u66ff\u6362\u6cd5\u5e76\u5904\u7406\u540e\u7ee7\u5e26\u53f3\u5b50\uff1b\u641c\u7d22/\u63d2\u5165/\u5220\u9664\u7684\u8282\u70b9\u4e0e\u8fb9\u72b6\u6001\u6709\u7edf\u4e00\u6062\u590d\uff1b\u6d88\u606f\u951a\u70b9\u57fa\u4e8e\u573a\u666f bbox\uff0c\u9760\u8fd1\u7ed3\u6784\u533a\u57df\uff1bDev hook <code>_play_bst_full_demo</code> \u8986\u76d6\u547d\u4e2d/\u672a\u547d\u4e2d\u641c\u7d22\u4e0e\u4e09\u7c7b\u5220\u9664\uff0c\u52a8\u753b\u5df2\u901a\u8fc7\u5f53\u524d\u9a8c\u6536\uff08\u4ecd\u9700\u5173\u6ce8\u540e\u7ee7\u904d\u5386\u6062\u590d\u3001\u6d88\u606f\u62c6\u5206\u7b49\u7ec6\u5316\u9879\uff09\u3002</li> <li>Layout\uff1aSceneGraph \u6309 kind\u2192\u7b56\u7565\u8def\u7531\uff08list\u2192LINEAR\uff0cbst\u2192TREE\uff09\uff0c\u4e3a\u6bcf\u4e2a\u7ed3\u6784\u5206\u914d <code>(dx, dy)</code> \u504f\u79fb\uff08\u6309\u7b56\u7565\u5206\u7ec4\u884c\u7d2f\u52a0\uff09\u6ce8\u5165 LayoutEngine\uff0c\u907f\u514d\u591a\u7ed3\u6784\u91cd\u53e0\uff1bTreeLayout \u6ce8\u5165 SET_POS\u3002</li> <li>SceneGraph/Schema\uff1a\u901a\u8fc7\u5168\u5c40 registry \u6ce8\u518c\u547d\u4ee4\u4e0e model factory\uff0cbst \u65e0\u9700\u786c\u7f16\u7801\uff1b\u6821\u9a8c\u51fd\u6570\u5177\u540d\u4e14\u7edf\u4e00\u629b CommandError\u3002</li> <li>Persistence (JSON)\uff1a\u5b9e\u73b0\u573a\u666f\u7ea7 JSON \u5bfc\u5165\u5bfc\u51fa\uff0c\u652f\u6301\u591a\u7ed3\u6784\u72b6\u6001\u6301\u4e45\u5316\uff1b\u89e3\u51b3 Git/Huffman \u5e03\u5c40\u5e72\u6270\u95ee\u9898\uff08\u901a\u8fc7\u8fc7\u6ee4\u673a\u5236\uff09\uff1bUI \u83dc\u5355\u96c6\u6210\u5bfc\u5165\u5bfc\u51fa\u529f\u80fd\u3002</li> <li>DSL (Interactive)\uff1a\u5b9e\u73b0\u6587\u672c DSL \u89e3\u6790\u5668\uff0c\u652f\u6301 <code>list L1=[1,2]</code> \u7b49\u81ea\u7136\u8bed\u6cd5\uff1bUI \u96c6\u6210\u201cInteractive DSL\u201d\u6309\u94ae\uff0c\u652f\u6301\u5728\u5f53\u524d\u573a\u666f\u6ce8\u5165\u547d\u4ee4\uff1bSceneGraph \u652f\u6301 late-binding kind resolution\uff0c\u5141\u8bb8 DSL \u64cd\u4f5c UI \u521b\u5efa\u7684\u7ed3\u6784\u3002</li> <li>Tests\uff1a\u5168\u91cf <code>uv run pytest</code>\u3001ruff/mypy \u901a\u8fc7\uff08\u6388\u6743\u8bbf\u95ee uv \u7f13\u5b58\uff09\uff1b\u65b0\u589e\u201c\u540e\u7ee7\u5e26\u53f3\u5b50\u201d\u56de\u5f52\u7528\u4f8b\u8986\u76d6\u91cd\u8fde\u903b\u8f91\u3002</li> <li>Active assumptions/limitations:</li> <li>\u52a8\u753b\u4ecd\u4e3a\u540c\u6b65\u963b\u585e\u63d2\u503c\uff0c\u672a\u652f\u6301 seek/skip/\u5012\u64ad\uff1b\u540e\u7ee7\u904d\u5386\u7684\u6062\u590d\u4ecd\u53ef\u7ec6\u5316\uff0c\u4f46\u4e0d\u5f71\u54cd\u62d3\u6251\u6b63\u786e\u6027\u3002</li> <li>Layout \u5206\u533a\u4e3a\u5360\u4f4d\u7b97\u6cd5\uff0c\u504f\u79fb\u5e38\u91cf\u786c\u7f16\u7801\uff1b\u6d88\u606f\u951a\u70b9\u4f9d\u8d56\u573a\u666f bbox\uff0c\u672a\u6309\u7ed3\u6784\u5c40\u90e8\u4f18\u5316\u3002</li> <li>Renderer \u65e0\u7bad\u5934/\u7aef\u70b9\u88c1\u526a\uff0c\u8fb9\u6e10\u5165\u6e10\u51fa\u4e3a\u6574\u4f53\u63d2\u503c\uff1b\u72b6\u6001/\u989c\u8272\u672a\u914d\u7f6e\u5316\u3002</li> <li>Renderer/\u5e03\u5c40\u6682\u7f3a\u7279\u5b9a\u5f62\u72b6\u4e0e\u5bb9\u5668\uff1a\u987a\u5e8f\u8868/\u6808\u7684\u201c\u6876+\u77e9\u5f62\u5355\u5143\u201d\u3001Huffman \u6784\u5efa\u8fc7\u7a0b\u7684\u53cc\u533a\u57df\uff08\u961f\u5217+\u6811\u533a\uff09\u3001Git DAG \u7eb5\u5411 lane \u5e03\u5c40\u5747\u672a\u843d\u5730\u3002</li> <li>UI \u4e3a Dev playground\uff1a\u5355\u573a\u666f\uff0c\u65e0\u591a Timeline \u7ba1\u7406\uff1bBST/DSL \u5165\u53e3\u4e3a\u5f00\u53d1\u8005\u83dc\u5355\uff0c\u672a\u505a\u6b63\u5f0f\u7528\u6237\u6d41\u7a0b\u3002</li> <li>DSL \u4ecd\u662f JSON \u5360\u4f4d\uff0c\u65e0\u53d8\u91cf/\u8bed\u6cd5\uff1bLLM \u4ec5\u63a5\u53e3\uff0c\u65e0\u5916\u90e8\u8c03\u7528\u3002</li> <li>Qt \u6d4b\u8bd5\u4f9d\u8d56 <code>QT_QPA_PLATFORM=offscreen</code>\uff1b\u5982\u9700\u81ea\u5b9a\u4e49 uv \u7f13\u5b58\u53ef\u8bbe <code>UV_CACHE_DIR=./tmp/uv-cache</code>\u3002</li> <li>\u5386\u53f2\u91cc\u7a0b\u7891\u5df2\u79fb\u51fa\u6b64\u6587\u6863\uff0c\u9700\u67e5\u9605\u8bbe\u8ba1\u6587\u6863\u6216 <code>docs/PLAN.md</code>\u3002</li> </ul>"},{"location":"project_state/#high-order-issues-critical","title":"High-order issues (critical)","text":"<ul> <li>\u52a8\u753b\u8c03\u5ea6\u963b\u585e\uff0c\u7f3a\u5c11 skip/seek/\u5012\u64ad\uff1bRenderer/scene \u4ecd\u5355\u7ebf\u7a0b\u64ad\u653e\uff0c\u590d\u6742\u7ed3\u6784\u53ef\u80fd\u5361\u987f\u3002</li> <li>\u591a\u7ed3\u6784\u89c6\u89c9\u5206\u533a\u4ecd\u4e3a\u5e38\u91cf\u504f\u79fb\uff0c\u672a\u6709\u5bb9\u5668/\u81ea\u52a8\u5206\u533a\uff1b\u6d88\u606f\u951a\u70b9\u57fa\u4e8e\u573a\u666f bbox\uff0c\u672a\u6309\u7ed3\u6784\u5b9a\u5236\u3002</li> <li>Renderer \u6837\u5f0f/\u52a8\u753b\u53c2\u6570\u672a\u914d\u7f6e\u5316\uff1a\u65e0\u7bad\u5934\u3001\u65e0\u7aef\u70b9\u88c1\u526a\uff0c\u6e10\u7ed8/\u7f29\u56de\u7f3a\u5931\uff1b\u989c\u8272/\u72b6\u6001\u672a\u96c6\u4e2d\u89c4\u8303\u3002</li> <li>Layout stateful\uff0c\u7f3a\u5c11\u91cd\u653e/\u91cd\u5efa\u63a5\u53e3\uff0c\u672a\u6765 seek/\u91cd\u6392 timeline \u53d7\u963b\uff1bDAG/\u591a\u6811\u5e03\u5c40\u7b56\u7565\u7f3a\u4f4d\u3002</li> <li>DSL \u4ec5 JSON \u5360\u4f4d\uff0c\u65e0\u8bed\u6cd5/\u53d8\u91cf/\u4f5c\u7528\u57df\uff1bLLM \u4ec5\u63a5\u53e3\uff0c\u65e0\u5b89\u5168\u8fc7\u6ee4\uff1b\u547d\u4ee4\u6279\u91cf\u4ecd\u963b\u585e\u3002</li> <li>UI \u4e3a Dev playground\uff0c\u65e0\u6b63\u5f0f\u64ad\u653e\u63a7\u5236\u3001\u65e0\u591a Timeline \u7ba1\u7406\u3002</li> <li>\u6587\u6863\u9700\u6301\u7eed\u540c\u6b65\uff1a\u65b0\u589e\u6811\u7c7b\u6a21\u578b\u3001\u6d88\u606f\u951a\u70b9\u4e0e\u5e03\u5c40\u504f\u79fb\u9700\u5728\u8bbe\u8ba1\u6587\u6863\u548c registry \u4e2d\u66f4\u65b0\uff1b\u672a\u6765 Agent \u9700\u8981\u201c\u5168\u6d41\u7a0b\u6307\u5357\u201d\u4f5c\u4e3a\u9ed8\u8ba4\u5165\u53e3\u3002</li> </ul>"},{"location":"project_state/#planned-next-phase-v01-v02","title":"Planned Next Phase \u2014 v0.1 / v0.2 \u4ea4\u4ed8\u8def\u7ebf\uff08\u5feb\u901f\u8fed\u4ee3\uff09","text":"<ul> <li>\u76ee\u6807\uff1a\u5b8c\u6210 v0.1 \u5168\u90e8\u5fc5\u505a\uff08\u987a\u5e8f\u8868/\u6808/Huffman/Git DAG \u57fa\u7840/\u6301\u4e45\u5316\uff09\u5e76\u63a8\u8fdb v0.2 \u6838\u5fc3\uff08AVL\u3001DSL \u6587\u672c\u3001Git \u6269\u5c55\u3001\u591a\u7ed3\u6784\u573a\u666f\u3001\u56de\u653e\uff09\uff0c\u6bcf\u8f6e\u539f\u5b50\u53ef\u5ba1\u67e5\u3002</li> </ul>"},{"location":"project_state/#_1","title":"\u8fed\u4ee3\u8bc4\u4f30\u4e0e\u540e\u7eed\u89c4\u5212","text":"\u8fed\u4ee3\u7f16\u53f7 \u76ee\u6807\u5185\u5bb9 \u6267\u884c\u4e0e\u4ea4\u4ed8\u60c5\u51b5 \u540e\u7eed\u8fed\u4ee3\u95ee\u9898/\u5f85\u529e \u8fed\u4ee3 L \u5e03\u5c40\u67b6\u6784\u91cd\u6784 \u542f\u52a8\u4e2d\u3002\u9488\u5bf9\u6811\u91cd\u53e0\u3001\u62d3\u6251\u55c5\u63a2\u8106\u5f31\u6027\u3001\u4e2a\u6027\u5316\u5e03\u5c40\u7f3a\u5931\u8fdb\u884c\u5927\u4fee\u3002 1. \u5b9a\u4e49 <code>Layoutable</code> \u534f\u8bae\uff1b2. \u5b9e\u73b0\u65e0\u72b6\u6001\u5e03\u5c40\u8ba1\u7b97\uff1b3. \u5f15\u5165 Buchheim \u6811\u7b97\u6cd5\u3002 \u8fed\u4ee3 0 \u57fa\u7ebf\u5de9\u56fa (BST) \u90e8\u5206\u4ea4\u4ed8\u3002BST \u589e\u5220\u6539\u67e5\u903b\u8f91\u5df2\u901a\uff0c\u56de\u5f52\u6d4b\u8bd5\u8986\u76d6\u4e86\u540e\u7ee7\u5e26\u53f3\u5b50\u573a\u666f\u3002 1. \u6d88\u606f\u62c6\u5206\u9700\u66f4\u7ec6\u7c92\u5ea6\uff08\u6559\u5b66\u5411\uff09\uff1b2. \u590d\u6742\u5220\u9664\u540e\u7684\u72b6\u6001\u6062\u590d\uff08\u9ad8\u4eae\u6b8b\u7559\uff09\u9700\u8fdb\u4e00\u6b65\u9a8c\u8bc1\u3002 \u8fed\u4ee3 1 \u987a\u5e8f\u8868 Seqlist \u5df2\u4ea4\u4ed8\u3002\u6a21\u578b\u3001LINEAR \u5e03\u5c40\u3001\u6876\u5bb9\u5668\u6e32\u67d3\u3001Dev Hook \u5168\u94fe\u8def\u6253\u901a\u3002 \u65e0\uff08\u8f6c\u5165\u7ef4\u62a4\uff09\u3002 \u8fed\u4ee3 3 Huffman \u6784\u5efa \u90e8\u5206\u4ea4\u4ed8\u3002\u6a21\u578b\u903b\u8f91\u4e0e\u53cc\u533a\u5e03\u5c40\uff08\u961f\u5217+\u6811\uff09\u5df2\u843d\u5730\uff0cSceneGraph \u5df2\u6ce8\u518c\u3002 1. \u4e25\u91cd\uff1a\u6811\u5e03\u5c40\u5b58\u5728\u8282\u70b9\u91cd\u53e0\uff1b2. \u6784\u5efa\u8fc7\u7a0b\u7684\u6e32\u67d3\u5e73\u6ed1\u5ea6\u9700\u4f18\u5316\u3002 \u8fed\u4ee3 4 Git DAG \u57fa\u7840 \u90e8\u5206\u4ea4\u4ed8\u3002<code>init</code>/<code>commit</code>/<code>checkout</code> \u903b\u8f91\u5df2\u901a\uff0c\u652f\u6301\u57fa\u7840 DAG \u5e03\u5c40\u3002 1. Lane \u5e03\u5c40\u7b97\u6cd5\u9700\u4f18\u5316\u4ee5\u652f\u6301\u590d\u6742\u5206\u652f\uff1b2. \u5206\u652f/HEAD \u6807\u7b7e\u7684\u89c6\u89c9\u533a\u5206\u5ea6\u589e\u5f3a\u3002 \u8fed\u4ee3 P Persistence \u5df2\u4ea4\u4ed8\u3002\u652f\u6301 SceneGraph \u5168\u91cf\u573a\u666f\u5bfc\u51fa/\u5bfc\u5165\uff0c\u5177\u5907\u201cDry Run\u201d\u6821\u9a8c\u673a\u5236\uff0c\u652f\u6301 List/Git/Huffman \u7b49\u7ed3\u6784\u7684\u903b\u8f91\u72b6\u6001\u6062\u590d\u3002 1. \u589e\u52a0\u66f4\u591a\u590d\u6742\u7ed3\u6784\u7684\u6062\u590d\u903b\u8f91\uff08\u5982 BST\uff09\uff1b2. UI \u5bfc\u51fa/\u5bfc\u5165\u5bf9\u8bdd\u6846\u96c6\u6210\u3002 \u8fed\u4ee3 U UI/UX \u4ea4\u4ed8\u5316 \u8fdb\u884c\u4e2d (Playground)\u3002Dev \u83dc\u5355\u53ef\u7528\uff0c\u57fa\u7840\u6e32\u67d3\u5668\u652f\u6301\u591a\u72b6\u6001\u3002 1. \u5b9e\u73b0\u6b63\u5f0f\u5de6\u4fa7\u63a7\u5236\u9762\u677f\uff1b2. \u6d88\u606f\u951a\u70b9\u7531\u5168\u5c40\u6539\u4e3a\u6309\u7ed3\u6784\u5c40\u90e8\u4f18\u5316\uff1b3. \u81ea\u52a8\u5206\u533a\u5e03\u5c40\u7b97\u6cd5\u3002 \u8fed\u4ee3 5 DSL \u6587\u672c \u5f85\u542f\u52a8\u3002\u76ee\u524d\u4ec5\u4e3a JSON \u5360\u4f4d\u3002 1. \u8bbe\u8ba1\u5e76\u5b9e\u73b0\u6700\u5c0f DSL \u8bed\u6cd5\u89e3\u6790\u5668\uff1b2. \u63a5\u5165 UI \u8f93\u5165\u6846\u3002 \u8fed\u4ee3 6 v0.2 \u6269\u5c55 \u5f85\u542f\u52a8\u3002 1. AVL \u65cb\u8f6c\u52a8\u753b\uff1b2. \u52a8\u753b\u5386\u53f2\u56de\u653e\u529f\u80fd\u3002"},{"location":"project_state/#invariants","title":"Invariants","text":"<ul> <li>project_state.md is the only authority on current phase.</li> <li>Other docs must not restate \"current status\", only bind to phases.</li> </ul>"},{"location":"quickstart/","title":"QUICKSTART \u2014 \u5feb\u901f\u5f00\u59cb\u6307\u5357","text":""},{"location":"quickstart/#1","title":"1. \u9879\u76ee\u67b6\u6784\u6982\u89c8","text":"<p>\u672c\u9879\u76ee\u91c7\u7528\u5206\u5c42\u67b6\u6784\u8bbe\u8ba1\uff0c\u4ece\u4e0a\u5230\u4e0b\u5206\u522b\u4e3a\uff1aUI \u5c42\u3001\u573a\u666f\u7ba1\u7406\u5c42\u3001\u6a21\u578b\u5c42\u3001\u5e03\u5c40\u5c42\u3001\u52a8\u753b\u5f15\u64ce\u548c\u6e32\u67d3\u5668\u3002</p> <pre><code>graph TD\n    subgraph UI[\"UI / DSL / Persistence\"]\n        UILayer[\"UI \u754c\u9762&lt;br/&gt;DSL \u89e3\u6790&lt;br/&gt;\u6570\u636e\u6301\u4e45\u5316\"]\n    end\n\n    subgraph Scene[\"Scene \u5c42\"]\n        SG[\"SceneGraph&lt;br/&gt;Command \u8def\u7531\"]\n    end\n\n    subgraph Model[\"Model \u5c42\"]\n        Models[\"\u6570\u636e\u7ed3\u6784\u6a21\u578b&lt;br/&gt;List / Stack / BST / AVL&lt;br/&gt;GitGraph / Huffman ...\"]\n    end\n\n    subgraph Layout[\"Layout \u5c42\"]\n        LayoutEngine[\"\u5e03\u5c40\u7b97\u6cd5&lt;br/&gt;\u6811\u5e03\u5c40 / \u7ebf\u6027\u5e03\u5c40&lt;br/&gt;DAG \u5e03\u5c40\"]\n    end\n\n    subgraph Animation[\"Animation \u5c42\"]\n        AnimOps[\"AnimationOps&lt;br/&gt;+ Timeline&lt;br/&gt;\u65f6\u95f4\u7ebf\u7ba1\u7406\"]\n    end\n\n    subgraph Renderer[\"Renderer \u5c42\"]\n        PySide6[\"PySide6 \u6e32\u67d3\u5668&lt;br/&gt;QGraphicsScene/View\"]\n        WebRender[\"\ud83d\udd2e Web \u6e32\u67d3\u5668&lt;br/&gt;React + Canvas/WebGL\"]\n    end\n\n    UILayer --&gt;|\"\u53d1\u9001 Command\"| SG\n    SG --&gt;|\"\u8c03\u7528\u6a21\u578b\u65b9\u6cd5&lt;br/&gt;\u751f\u6210\u7ed3\u6784 Ops\"| Models\n    Models --&gt;|\"\u7ed3\u6784\u62d3\u6251\"| LayoutEngine\n    LayoutEngine --&gt;|\"\u6ce8\u5165 SET_POS Ops\"| AnimOps\n    AnimOps --&gt;|\"Timeline + Ops\"| PySide6\n    AnimOps --&gt;|\"Timeline + Ops\"| WebRender\n\n    style UI fill:#e1f5ff\n    style Scene fill:#fff3e0\n    style Model fill:#f3e5f5\n    style Layout fill:#e8f5e9\n    style Animation fill:#fce4ec\n    style Renderer fill:#f1f8e9</code></pre> <p>\u6838\u5fc3\u7279\u70b9\uff1a</p> <ul> <li>\u2705 \u5206\u5c42\u6e05\u6670\uff1a\u6bcf\u5c42\u804c\u8d23\u660e\u786e\uff0c\u5355\u5411\u4f9d\u8d56</li> <li>\u2705 \u6a21\u578b\u72ec\u7acb\uff1a\u6570\u636e\u7ed3\u6784\u6a21\u578b\u4e0e UI/Renderer \u5b8c\u5168\u89e3\u8026</li> <li>\u2705 \u52a8\u753b\u89e3\u8026\uff1a\u901a\u8fc7 AnimationOps \u548c Timeline \u7edf\u4e00\u63cf\u8ff0\u52a8\u753b</li> <li>\u2705 \u591a\u6e32\u67d3\u5668\uff1a\u652f\u6301 PySide6\uff08\u5f53\u524d\uff09\u548c\u672a\u6765\u7684 Web \u6e32\u67d3</li> </ul> <pre><code>flowchart TB\n  %% =========================\n  %% DS-Vis Official Architecture\n  %% =========================\n\n  %% ---- Layer: UI Shell ----\n  subgraph L4[\"L4 UI Shell\"]\n    UI[\"ui.main_window\\n(PySide6 App Shell)\"]\n  end\n\n  %% ---- Layer: Renderer Implementation ----\n  subgraph L3[\"L3 Renderer Implementation\"]\n    RQtPkg[\"renderers.pyside6\\n(Qt bindings &amp; glue)\"]\n    RQt[\"renderers.pyside6.renderer\\n(Qt Renderer Impl)\"]\n    QtLib[\"PySide6\\n(External)\"]\n    RQtPkg --&gt; RQt\n    RQt --&gt; QtLib\n  end\n\n  %% ---- Layer: Renderer Abstraction ----\n  subgraph L2[\"L2 Renderer Abstraction\"]\n    RBase[\"renderers.base\\n(Renderer API / Port)\"]\n  end\n\n  %% ---- Layer: Core Domain ----\n  subgraph L1[\"L1 Core Domain\"]\n    %% Models\n    subgraph Models[\"models (Domain Structures)\"]\n      MBase[\"models.base\\n(Model interface &amp; invariants)\"]\n      MList[\"models.list_model\"]\n      MBST[\"models.bst\"]\n      MDiGraph[\"models.digraph\"]\n      MBase --&gt; MList\n      MBase --&gt; MBST\n      MBase --&gt; MDiGraph\n    end\n\n    %% Layout\n    subgraph Layout[\"layout (Layout Strategy)\"]\n      LCore[\"layout\\n(Layout API)\"]\n      LSimple[\"layout.simple\\n(Simple Layout Impl)\"]\n      LCore --&gt; LSimple\n    end\n\n    %% Scene pipeline\n    subgraph Scene[\"scene (Scene Pipeline)\"]\n      Cmd[\"scene.command\\n(Command semantics)\"]\n      Schema[\"scene.command_schema\\n(Command schema)\"]\n      Graph[\"scene.scene_graph\\n(Resolved graph)\"]\n      World[\"scene.scene\\n(Scene state / World)\"]\n\n      Schema --&gt; Cmd\n      Cmd --&gt; Graph\n      Graph --&gt; World\n    end\n\n    Ex[\"core.exceptions\"]\n  end\n\n  %% ---- Layer: Use-cases / Orchestration ----\n  subgraph L0[\"L0 Ops / Use-Cases\"]\n    Ops[\"core.ops\\n(Application Services / Use-cases)\"]\n    TL[\"core.ops.timeline\\n(Deterministic history)\"]\n    Ops --&gt; TL\n  end\n\n  %% =========================\n  %% Cross-layer dependencies\n  %% =========================\n\n  %% UI drives renderer + ops (thin shell)\n  UI --&gt; RQt\n  UI --&gt; Ops\n\n  %% Renderer depends on abstraction + core\n  RQt --&gt; RBase\n  RQt --&gt; World\n  RQt --&gt; Graph\n  RQt --&gt; LCore\n  RQt --&gt; MBase\n\n  %% Abstraction depends on core types (ports reference domain)\n  RBase --&gt; World\n  RBase --&gt; Graph\n\n  %% Ops orchestrates core pipeline\n  Ops --&gt; Cmd\n  Ops --&gt; Schema\n  Ops --&gt; Graph\n  Ops --&gt; World\n  Ops --&gt; LCore\n  Ops --&gt; MBase\n  Ops --&gt; Ex\n\n  %% Layout applies to models/scene\n  LCore --&gt; World\n  LCore --&gt; MBase\n\n  %% Exceptions shared across core/ops\n  Ex -.-&gt; Ops\n  Ex -.-&gt; Scene\n  Ex -.-&gt; Models</code></pre>"},{"location":"quickstart/#2","title":"2. \u73af\u5883\u914d\u7f6e\u4e0e\u4f9d\u8d56\u5b89\u88c5","text":""},{"location":"quickstart/#21","title":"2.1 \u524d\u7f6e\u8981\u6c42","text":"<ul> <li>Python 3.11+</li> <li><code>uv</code> \u5305\u7ba1\u7406\u5de5\u5177\uff08\u5b89\u88c5\u6307\u5357\uff09</li> </ul>"},{"location":"quickstart/#22","title":"2.2 \u5b89\u88c5\u6b65\u9aa4","text":"<pre><code># 1. \u8fdb\u5165\u9879\u76ee\u6839\u76ee\u5f55\ncd /path/to/ds-vis\n\n# 2. \u5b89\u88c5\u4f9d\u8d56\uff08\u521b\u5efa\u865a\u62df\u73af\u5883\uff09\nuv sync\n\n# 3. \u9a8c\u8bc1\u5b89\u88c5\nuv run python --version  # \u5e94\u8f93\u51fa Python 3.11+\n</code></pre> <p>\u8be6\u7ec6\u73af\u5883\u914d\u7f6e\u89c1 <code>docs/engineering/environment.md</code>\u3002</p>"},{"location":"quickstart/#3","title":"3. \u6838\u5fc3\u6982\u5ff5","text":""},{"location":"quickstart/#31-command","title":"3.1 Command\uff08\u547d\u4ee4\uff09","text":"<p>\u7528\u6237\u754c\u9762\u6216 DSL \u901a\u8fc7 <code>Command</code> \u4e0e SceneGraph \u4ea4\u4e92\u3002</p> <p>\u793a\u4f8b\uff1a <pre><code># \u5728 BST \u4e2d\u63d2\u5165\u503c 5\ncmd = Command(\n    type=\"INSERT\",\n    structure_id=\"bst_1\",\n    payload={\"value\": 5}\n)\n</code></pre></p>"},{"location":"quickstart/#32-animationops-timeline","title":"3.2 AnimationOps \u4e0e Timeline\uff08\u52a8\u753b\u6307\u4ee4\uff09","text":"<p>Model \u6267\u884c\u64cd\u4f5c\u540e\u751f\u6210\u4e00\u7cfb\u5217 AnimationOps\uff0c\u7531 Timeline \u7ec4\u7ec7\u64ad\u653e\u3002</p> <p>\u4e3b\u8981 Ops \u7c7b\u578b\uff1a</p> Op \u7c7b\u578b \u8bf4\u660e \u793a\u4f8b <code>CREATE_NODE</code> \u521b\u5efa\u8282\u70b9 <code>CREATE_NODE(id=\"n1\", label=\"5\")</code> <code>DELETE_NODE</code> \u5220\u9664\u8282\u70b9 <code>DELETE_NODE(id=\"n1\")</code> <code>SET_POS</code> \u8bbe\u7f6e\u4f4d\u7f6e <code>SET_POS(id=\"n1\", x=100, y=200)</code> <code>SET_STATE</code> \u8bbe\u7f6e\u72b6\u6001 <code>SET_STATE(id=\"n1\", state=\"highlight\")</code> <code>CREATE_EDGE</code> \u521b\u5efa\u8fb9 <code>CREATE_EDGE(id=\"e1\", from=\"n1\", to=\"n2\")</code> <p>\u8be6\u7ec6\u89c4\u8303\u89c1 <code>docs/design/ops_spec.md</code>\u3002</p>"},{"location":"quickstart/#4","title":"4. \u8fd0\u884c\u4e0e\u6d4b\u8bd5","text":""},{"location":"quickstart/#41","title":"4.1 \u8fd0\u884c\u5e94\u7528","text":"<pre><code># \u542f\u52a8\u684c\u9762\u5e94\u7528\uff08PySide6\uff09\nuv run python -m ds_vis.ui.main_window\n</code></pre>"},{"location":"quickstart/#42","title":"4.2 \u8fd0\u884c\u6d4b\u8bd5","text":"<pre><code># \u8fd0\u884c\u6240\u6709\u6d4b\u8bd5\nuv run pytest\n\n# \u8fd0\u884c\u7279\u5b9a\u6587\u4ef6\u7684\u6d4b\u8bd5\nuv run pytest tests/test_skeleton_flow.py -v\n\n# \u8fd0\u884c\u4ee3\u7801\u68c0\u67e5\u4e0e\u7c7b\u578b\u68c0\u67e5\nuv run ruff check src tests    # Linting\nuv run mypy src                # \u7c7b\u578b\u68c0\u67e5\uff08\u53ef\u9009\uff09\n</code></pre>"},{"location":"quickstart/#5","title":"5. \u5178\u578b\u5f00\u53d1\u6d41\u7a0b","text":"<p>\u6839\u636e\u4f60\u8981\u5b9e\u73b0\u7684\u529f\u80fd\uff0c\u9075\u5faa\u4e0d\u540c\u7684\u5f00\u53d1\u6d41\u7a0b\uff1a</p>"},{"location":"quickstart/#51","title":"5.1 \u5b9e\u73b0\u6570\u636e\u7ed3\u6784\u6a21\u578b","text":"<p>\u76ee\u6807\uff1a \u5b9e\u73b0\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u7ed3\u6784\uff08\u5982 AVL \u6811\uff09</p> <ol> <li>\u5728 <code>src/ds_vis/core/models/</code> \u4e2d\u521b\u5efa\u6a21\u578b\u7c7b</li> <li>\u5b9e\u73b0\u6570\u636e\u7ed3\u6784\u903b\u8f91\uff0c\u751f\u6210 AnimationOps Timeline</li> <li>\u7f16\u5199\u5355\u5143\u6d4b\u8bd5 <code>tests/test_avl.py</code></li> <li>\u8fd0\u884c <code>uv run pytest tests/test_avl.py</code> \u9a8c\u8bc1</li> </ol> <p>\u793a\u4f8b\uff1a \u89c1 <code>src/ds_vis/core/models/bst.py</code></p>"},{"location":"quickstart/#52","title":"5.2 \u5b9e\u73b0\u5e03\u5c40\u7b97\u6cd5","text":"<p>\u76ee\u6807\uff1a \u4e3a\u6570\u636e\u7ed3\u6784\u8ba1\u7b97\u8282\u70b9\u5750\u6807</p> <ol> <li>\u5728 <code>src/ds_vis/core/layout/</code> \u4e2d\u5b9e\u73b0\u5e03\u5c40\u7b97\u6cd5</li> <li>\u63a5\u6536 Ops \u6d41\u548c\u62d3\u6251\u4fe1\u606f\uff0c\u6ce8\u5165 SET_POS Ops</li> <li>\u7f16\u5199\u5e03\u5c40\u6d4b\u8bd5 <code>tests/test_layout_*.py</code></li> <li>\u8fd0\u884c\u9a8c\u8bc1</li> </ol> <p>\u7ea6\u675f\uff1a \u5e03\u5c40\u5c42\u4e0d\u5e94\u4f9d\u8d56\u6570\u636e\u7ed3\u6784\u7684\u4e1a\u52a1\u903b\u8f91\uff0c\u4ec5\u57fa\u4e8e\u62d3\u6251\u7ed3\u6784\u8ba1\u7b97\u5750\u6807</p> <p>\u8be6\u89c1 <code>docs/design/architecture.md</code></p>"},{"location":"quickstart/#53-renderer","title":"5.3 \u5b9e\u73b0 Renderer","text":"<p>\u76ee\u6807\uff1a \u5c06 Ops \u548c Timeline \u6e32\u67d3\u6210\u53ef\u89c6\u5316\u52a8\u753b</p> <ol> <li>\u7ee7\u627f <code>src/ds_vis/renderers/base.py</code> \u4e2d\u7684 <code>Renderer</code> \u62bd\u8c61\u7c7b</li> <li>\u5b9e\u73b0 <code>render(timeline: Timeline)</code> \u65b9\u6cd5</li> <li>\u7f16\u5199\u6e32\u67d3\u6d4b\u8bd5 <code>tests/test_renderer_*.py</code></li> <li>\u8fd0\u884c\u9a8c\u8bc1</li> </ol> <p>\u793a\u4f8b\uff1a \u89c1 <code>src/ds_vis/renderers/pyside6/renderer.py</code></p>"},{"location":"quickstart/#54-ui","title":"5.4 \u5b9e\u73b0 UI \u529f\u80fd","text":"<p>\u76ee\u6807\uff1a \u6dfb\u52a0\u7528\u6237\u754c\u9762\uff0c\u8fde\u63a5 Command \u4e0e SceneGraph</p> <ol> <li>\u5728 <code>src/ds_vis/ui/</code> \u4e2d\u5b9e\u73b0 UI \u7ec4\u4ef6</li> <li>\u6355\u83b7\u7528\u6237\u4ea4\u4e92\uff08\u70b9\u51fb\u3001\u8f93\u5165\u7b49\uff09\u751f\u6210 Command</li> <li>\u901a\u8fc7 SceneGraph \u6267\u884c Command\uff0c\u83b7\u53d6 Timeline</li> <li>\u5c06 Timeline \u9001\u7ed9 Renderer \u64ad\u653e</li> </ol> <p>\u8be6\u89c1 <code>docs/design/architecture.md</code></p>"},{"location":"quickstart/#6","title":"6. \u6587\u4ef6\u5bfc\u822a","text":"\u6587\u4ef6/\u76ee\u5f55 \u8bf4\u660e <code>docs/design/requirements.md</code> \u9700\u6c42\u4e0e\u7528\u4f8b\u8bf4\u660e <code>docs/design/architecture.md</code> \u8be6\u7ec6\u67b6\u6784\u4e0e\u5206\u5c42\u8bbe\u8ba1 <code>docs/design/animation.md</code> \u52a8\u753b\u5fae\u6b65\u9aa4\u8bbe\u8ba1 <code>docs/design/ops_spec.md</code> AnimationOps \u7c7b\u578b\u4e0e\u89c4\u8303 <code>docs/engineering/environment.md</code> \u73af\u5883\u914d\u7f6e\u4e0e\u547d\u4ee4 <code>docs/engineering/dev_kb.md</code> \u5f00\u53d1\u5e38\u89c1\u95ee\u9898\u4e0e\u6700\u4f73\u5b9e\u8df5 <code>AGENTS.md</code> Agents \u6743\u9650\u4e0e\u5de5\u4f5c\u6d41 <code>src/ds_vis/core/</code> \u6838\u5fc3\u5f15\u64ce\uff08\u6a21\u578b\u3001\u5e03\u5c40\u3001Ops\u3001SceneGraph\uff09 <code>src/ds_vis/renderers/</code> \u6e32\u67d3\u5668\u5b9e\u73b0 <code>src/ds_vis/ui/</code> UI \u754c\u9762 <code>tests/</code> \u5355\u5143\u6d4b\u8bd5"},{"location":"quickstart/#7","title":"7. \u5e38\u89c1\u95ee\u9898","text":"<p>Q: \u6211\u60f3\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5e94\u8be5\u4ece\u54ea\u91cc\u5f00\u59cb\uff1f</p> <p>A: \u4ece <code>src/ds_vis/core/models/</code> \u5f00\u59cb\u5b9e\u73b0\u6a21\u578b\uff0c\u751f\u6210 AnimationOps\uff0c\u65e0\u9700\u5173\u5fc3 UI \u6216 Renderer\u3002\u8be6\u89c1 Section 5.1</p> <p>Q: Model \u5c42\u53ef\u4ee5\u5bfc\u5165 Renderer \u5417\uff1f</p> <p>A: \u4e0d\u53ef\u4ee5\u3002\u8fd9\u8fdd\u53cd\u4e86\u67b6\u6784\u89c4\u5219\u3002\u6240\u6709\u4ea4\u4e92\u5fc5\u987b\u901a\u8fc7 SceneGraph \u548c Command \u8fdb\u884c\u3002\u8be6\u89c1 <code>AGENTS.md</code></p> <p>Q: \u5982\u4f55\u8c03\u8bd5 Timeline \u751f\u6210\uff1f</p> <p>A: \u5728 <code>tests/</code> \u4e2d\u7f16\u5199\u5355\u5143\u6d4b\u8bd5\uff0c\u76f4\u63a5\u8c03\u7528 Model \u65b9\u6cd5\u5e76\u68c0\u67e5\u8fd4\u56de\u7684 Timeline \u5bf9\u8c61\u3002\u8be6\u89c1 <code>docs/engineering/dev_kb.md</code></p>"},{"location":"quickstart/#8","title":"8. \u4e0b\u4e00\u6b65","text":"<ul> <li>\u9605\u8bfb <code>docs/design/architecture.md</code> \u4e86\u89e3\u8be6\u7ec6\u7684\u5206\u5c42\u8bbe\u8ba1</li> <li>\u67e5\u770b <code>AGENTS.md</code> \u4e86\u89e3\u5f00\u53d1\u6743\u9650\u4e0e\u5de5\u4f5c\u6d41</li> <li>\u9009\u62e9\u4e00\u4e2a\u4efb\u52a1\u5f00\u59cb\u8d21\u732e\uff1a\u5b9e\u73b0\u6a21\u578b / \u5e03\u5c40 / Renderer \u4e4b\u4e00</li> </ul>"},{"location":"api/","title":"API Reference","text":""},{"location":"api/#package-ds_vis","title":"Package: ds_vis","text":"<p>mkdocstrings \u63d2\u4ef6\u6d4b\u8bd5\uff0c\u76f4\u63a5\u5bfc\u5165\u9876\u5c42\u6e90\u7801\u5305 </p> <p>ds_vis \u2014 Data Structure Visualizer core package.</p> <p>This package contains the core engine, renderers, UI, DSL, and persistence modules for the data-structure visualization project.</p>"},{"location":"design/animation/","title":"ANIMATION_REQUIREMENTS \u2014 \u52a8\u753b\u8981\u6c42\u4e0e\u6559\u5b66\u89c4\u8303","text":""},{"location":"design/animation/#1","title":"1. \u52a8\u753b\u76ee\u6807","text":"<p>\u672c\u9879\u76ee\u7684\u52a8\u753b\u670d\u52a1\u4e8e\u6559\u5b66\u6f14\u793a\uff0c\u76ee\u6807\u662f\uff1a</p> <ol> <li>\u8ba9\u521d\u5b66\u8005\u6e05\u6670\u5730\u7406\u89e3\u6bcf\u4e00\u6b65\u7ed3\u6784\u53d8\u5316\u8fc7\u7a0b\uff0c\u800c\u4e0d\u4ec5\u662f\u770b\u5230\u7ed3\u679c\u3002</li> <li>\u4e3a\u6559\u5e08\u6216\u5b66\u4e60\u8005\u63d0\u4f9b\u5408\u9002\u7684\u8bb2\u89e3\u8282\u594f\uff08\u81ea\u52a8\u64ad\u653e / \u5355\u6b65 / \u56de\u770b\uff09\u3002</li> <li>\u5728\u4e0d\u540c\u6570\u636e\u7ed3\u6784\u4e4b\u95f4\u4fdd\u6301\u4e00\u81f4\u7684\u89c6\u89c9\u8bed\u8a00\u4e0e\u4ea4\u4e92\u6a21\u5f0f\u3002</li> </ol>"},{"location":"design/animation/#2","title":"2. \u52a8\u753b\u7cbe\u7ec6\u5ea6\u7b49\u7ea7","text":"<p>\u5b9a\u4e49\u4e09\u4e2a\u7cbe\u7ec6\u5ea6\u7b49\u7ea7\uff1a</p> <ul> <li>L1\uff1a\u7ed3\u679c\u7ea7\u52a8\u753b</li> <li>\u4ec5\u5728\u64cd\u4f5c\u524d\u540e\u7ed9\u51fa\u4e24\u4e2a\u72b6\u6001\uff0c\u4f7f\u7528\u7b80\u5355\u8fc7\u6e21\u3002</li> <li>L2\uff1a\u6559\u5b66\u7ea7\u52a8\u753b\uff08\u672c\u9879\u76ee\u7684\u9ed8\u8ba4\u76ee\u6807\uff09</li> <li>\u5c06\u4e00\u4e2a\u64cd\u4f5c\u62c6\u6210 3\u201310 \u4e2a\u201c\u5fae\u6b65\u9aa4\u201d\uff08micro-steps\uff09\u3002</li> <li>\u6bcf\u4e00\u6b65\u6709\u660e\u786e\u7684\u89c6\u89c9\u7126\u70b9\uff08\u9ad8\u4eae\u3001\u79fb\u52a8\u3001\u6807\u6ce8\uff09\u3002</li> <li>L3\uff1a\u6df1\u5ea6\u89e3\u5256\u7ea7\u52a8\u753b</li> <li>\u5c55\u793a\u5185\u90e8\u5b9e\u73b0\u7ec6\u8282\uff08\u6307\u9488\u5b57\u6bb5\u3001\u5e73\u8861\u56e0\u5b50\u66f4\u65b0\u3001\u5185\u5b58\u5730\u5740\u7b49\uff09\u3002</li> </ul> <p>\u672c\u9879\u76ee\u5f53\u524d\u7edf\u4e00\u91c7\u7528 L2 \u6559\u5b66\u7ea7\u52a8\u753b \u4f5c\u4e3a\u76ee\u6807\u3002 L3 \u4f5c\u4e3a\u6269\u5c55\u65b9\u5411\uff0c\u4e0d\u7eb3\u5165\u5f53\u524d\u8bfe\u7a0b\u8bbe\u8ba1\u5fc5\u505a\u8303\u56f4\u3002</p>"},{"location":"design/animation/#3-l2","title":"3. \u5404\u6570\u636e\u7ed3\u6784\u7684 L2 \u52a8\u753b\u8981\u6c42\uff08\u793a\u4f8b\uff09","text":"<p>\u4ee5\u4e0b\u4e3a v0.2 \u793a\u4f8b\uff0c\u540e\u7eed\u53ef\u6839\u636e\u9700\u8981\u7ec6\u5316/\u4fee\u6539</p>"},{"location":"design/animation/#31-arraylist","title":"3.1 \u987a\u5e8f\u8868\uff08Array/List\uff09","text":"<ul> <li>\u63d2\u5165\uff08\u4f4d\u7f6e i\uff09\uff1a</li> <li>\u9ad8\u4eae\u7d22\u5f15 <code>i</code> \u5904\u7684\u683c\u5b50\uff08\u76ee\u6807\u4f4d\u7f6e\uff09\u3002</li> <li>\u9ad8\u4eae\u533a\u95f4 <code>[i, size-1]</code> \u7684\u6240\u6709\u5143\u7d20\uff08\u5f85\u79fb\u52a8\u533a\u95f4\uff09\u3002</li> <li>\u5e73\u79fb\uff1a\u533a\u95f4\u5143\u7d20\u6574\u4f53\u5411\u53f3\u6ed1\u52a8\u4e00\u4e2a\u5355\u4f4d\u3002</li> <li>\u6de1\u5165\uff1a\u65b0\u5143\u7d20\u4ece\u4e0a\u65b9\u98de\u5165\u6216\u5728\u7a7a\u4f4d\u6de1\u5165\u3002</li> <li>\u66f4\u65b0 <code>size</code> \u6807\u6ce8\u3002</li> <li>\u5220\u9664\uff08\u4f4d\u7f6e i\uff09\uff1a</li> <li>\u9ad8\u4eae\u7d22\u5f15 <code>i</code> \u5904\u7684\u5143\u7d20\u3002</li> <li>\u6de1\u51fa\uff1a\u8be5\u5143\u7d20\u6d88\u5931\u3002</li> <li>\u9ad8\u4eae\u533a\u95f4 <code>[i+1, size-1]</code>\u3002</li> <li>\u5e73\u79fb\uff1a\u533a\u95f4\u5143\u7d20\u6574\u4f53\u5411\u5de6\u6ed1\u52a8\u3002</li> <li>\u66f4\u65b0 <code>size</code> \u6807\u6ce8\u3002</li> </ul>"},{"location":"design/animation/#32-linked-list","title":"3.2 \u94fe\u8868\uff08Linked List\uff09","text":"<ul> <li>\u63d2\u5165\uff08\u8282\u70b9 p \u540e\uff09\uff1a</li> <li>\u904d\u5386\uff1a\u4ece\u5934\u8282\u70b9\u5f00\u59cb\uff0c\u9010\u4e2a\u9ad8\u4eae\u8282\u70b9\u76f4\u5230 <code>p</code>\u3002</li> <li>\u521b\u5efa\uff1a\u5728\u4fa7\u8fb9\u521b\u5efa\u65b0\u8282\u70b9 <code>x</code>\u3002</li> <li>\u8fde\u7ebf 1\uff1a\u865a\u7ebf\u8868\u793a\u6293\u53d6\u5e76\u65ad\u5f00\u539f\u672c\u7684<code>p.next</code>\u5e76\u9010\u6e10\u7ed8\u5236<code>x.next</code> \u6307\u5411 <code>p.next</code>\u3002</li> <li>\u8fde\u7ebf 2\uff1a\u9010\u6e10\u7ed8\u5236<code>p.next</code> \u6307\u5411 <code>x</code>\u3002</li> <li>\u91cd\u6392\uff1a\u8c03\u7528\u5e03\u5c40\u5f15\u64ce\uff0c\u4f7f\u94fe\u8868\u91cd\u65b0\u5bf9\u9f50\u3002</li> </ul> <p>\u5f53\u524d\u94fe\u8868\u63d2\u5165\u91cd\u6392\u4e00\u6b65\u4e0e\u521b\u5efa\u540c\u65f6\u5b8c\u6210</p>"},{"location":"design/animation/#33-push-pop","title":"3.3 \u6808 push / pop","text":"<ul> <li>\u5165\u6808\uff1a</li> <li>\u9ad8\u4eae\u5165\u53e3\u4f4d\u7f6e\u3002</li> <li>\u5143\u7d20\u4ece\u5916\u90e8\u5e73\u6ed1\u79fb\u52a8\u5230\u76ee\u6807\u4f4d\u7f6e\u3002</li> <li>\u66f4\u65b0\u6307\u9488\uff08TOP\uff09\u4f4d\u7f6e\u3002</li> <li>\u51fa\u6808/\u51fa\u961f\uff1a</li> <li>\u9ad8\u4eae\u5f85\u51fa\u5143\u7d20\u3002</li> <li>\u5143\u7d20\u5411\u5916\u5e73\u6ed1\u79fb\u52a8\u5e76\u6de1\u51fa\u3002</li> <li>\u66f4\u65b0\u6307\u9488\uff08TOP\uff09\u4f4d\u7f6e\u3002</li> </ul>"},{"location":"design/animation/#34-bst","title":"3.4 BST \u67e5\u627e\u4e0e\u63d2\u5165","text":"<ul> <li>\u67e5\u627e\uff1a</li> <li>\u6bd4\u8f83\uff1a\u9ad8\u4eae\u5f53\u524d\u8282\u70b9\uff0c\u663e\u793a\u6bd4\u8f83\u6c14\u6ce1\uff08\u5982 <code>42 &gt; 30</code>, \u5e26\u989c\u8272\uff09\u3002</li> <li>\u51b3\u7b56\uff1a\u9ad8\u4eae\u5bf9\u5e94\u7684\u5b50\u8fb9\uff08\u5de6\u6216\u53f3\uff09\u3002</li> <li>\u79fb\u52a8\uff1a\u7126\u70b9\u79fb\u52a8\u5230\u5b50\u8282\u70b9\u3002</li> <li>\u63d2\u5165\uff1a</li> <li>\u6267\u884c\u67e5\u627e\u6d41\u7a0b\u76f4\u5230\u7a7a\u4f4d\u3002</li> <li>\u5728\u7a7a\u4f4d\u5904\u6de1\u5165\u65b0\u8282\u70b9\u3002</li> <li>\u52a8\u753b\u5c55\u793a: \u7236\u8282\u70b9\u94fe\u63a5\u8be5\u65b0\u8282\u70b9</li> </ul> <p>\u5f53\u524d\u5b9e\u73b0\u57fa\u7ebf\uff08P0.7\uff09\uff1a\u67e5\u627e/\u63d2\u5165\u7684\u8282\u70b9\u9ad8\u4eae\u4e0e\u8def\u5f84\u8fb9 secondary \u9ad8\u4eae\u5728\u5c3e\u90e8\u7edf\u4e00\u6062\u590d\uff1b\u6d88\u606f\u5728\u6bcf\u6b65\u663e\u793a\uff0c\u6536\u5c3e CLEAR_MESSAGE\uff1b\u53ef\u8fdb\u4e00\u6b65\u7ec6\u5316\u201c\u6bd4\u8f83\u6c14\u6ce1\u201d\u989c\u8272\u4e0e\u8fb9\u6062\u590d\u7c92\u5ea6\u3002</p>"},{"location":"design/animation/#35-bst","title":"3.5 BST \u5220\u9664\uff08\u6559\u5b66\u5316\u96be\u70b9\uff09","text":"<ul> <li>\u53f6\u5b50\u8282\u70b9\uff1a\u76f4\u63a5\u6de1\u51fa\u8282\u70b9\u53ca\u7236\u8fb9\u3002</li> <li>\u5355\u5b50\u6811\uff1a</li> <li>\u9ad8\u4eae\u5f85\u5220\u8282\u70b9 D \u53ca\u5176\u552f\u4e00\u5b50\u8282\u70b9 C\u3002</li> <li>\u63a5\u7ba1\uff1aD\u7684\u7236\u8282\u70b9\u6307\u9488\uff08\u5373\u8fb9\uff09\u76f4\u63a5\u6307\u5411 C\u3002</li> <li>D\uff08\u53ca\u5176\u5176\u8fde\u63a5\u5b50\u8282\u70b9 C \u7684\u8fb9\uff09\u6de1\u51fa\uff0cC \u53ca\u5176\u5b50\u6811\u5e73\u6ed1\u79fb\u52a8\u5230 D \u7684\u539f\u4f4d\u7f6e\u3002</li> <li>\u53cc\u5b50\u6811\uff08\u540e\u7ee7\u66ff\u6362\u6cd5\uff09\uff1a</li> <li>\u9ad8\u4eae\u5f85\u5220\u8282\u70b9 D\u3002</li> <li>\u5bfb\u627e\u540e\u7ee7\uff1a\u9ad8\u4eae D \u7684\u53f3\u5b50\u6811\uff0c\u5e76\u6cbf\u5de6\u8def\u5f84\u9010\u4e2a\u627e\u5230\u6700\u5c0f\u8282\u70b9 S\u3002</li> <li>\u503c\u590d\u5236\uff1a\u5c06 S \u7684\u503c\u201c\u98de\u5411\u201d D\uff08\u66f4\u65b0 D \u7684\u6807\u7b7e\uff09\u3002</li> <li>\u5220\u9664\u540e\u7ee7\uff1a\u9ad8\u4eae S\uff0c\u6309\u201c\u53f6\u5b50\u201d\u6216\u201c\u5355\u5b50\u6811\u201d\u60c5\u51b5\u5220\u9664 S\u3002</li> </ul> <p>\u5f53\u524d\u5b9e\u73b0\u57fa\u7ebf\uff08P0.7\uff09\uff1a\u5df2\u843d\u5730\u540e\u7ee7\u66ff\u6362\u6cd5\uff0c\u652f\u6301\u540e\u7ee7\u5e26\u53f3\u5b50\uff1b\u5220\u9664\u9636\u6bb5\u5305\u542b\u8fb9\u91cd\u8fde/\u5220\u9664\u4e0e\u8282\u70b9\u5220\u9664\uff0c\u7edf\u4e00 Restore \u72b6\u6001\uff1b\u540e\u7ee7\u904d\u5386\u7684\u6062\u590d/\u5206\u6b65\u6d88\u606f\u4ecd\u53ef\u7ec6\u5316\u3002</p>"},{"location":"design/animation/#36-avl-model-layout-engine","title":"3.6 AVL \u65cb\u8f6c\uff08\u91cd\u70b9\u5728 Model -- Layout Engine \u7684\u914d\u5408\uff09","text":"<ul> <li>\u663e\u793a\u5e73\u8861\u56e0\u5b50\u6c14\u6ce1</li> <li>\u663e\u793a\u5f53\u524d\u65cb\u8f6c\u7c7b\u578b</li> <li>\u5355\u65cb\uff08LL/RR\uff09\uff1a<ol> <li>\u9ad8\u4eae\u5931\u8861\u8282\u70b9 A\u3001\u5b50\u8282\u70b9 B\u3002</li> <li>\u91cd\u5fc3\u8f6c\u6362\uff1aB \u5411\u4e0a\u79fb\u52a8\uff0cA \u5411\u4e0b\u5e76\u5411\u4fa7\u8fb9\u79fb\u52a8\u3002</li> <li>\u5b50\u6811\u6302\u63a5\uff1a\u82e5 B \u6709\u5185\u4fa7\u5b50\u6811\uff0c\u52a8\u753b\u6f14\u793a\u5176\u65ad\u5f00\u5e76\u6302\u63a5\u5230 A\u3002</li> </ol> </li> <li>\u53cc\u65cb\uff08LR/RL\uff09\uff1a</li> <li>\u5206\u4e3a\u4e24\u6b21\u5355\u65cb\uff0c\u4e2d\u95f4\u505c\u987f\u5e76\u663e\u793a\u201c\u4e2d\u95f4\u72b6\u6001\u201d\u3002</li> <li>\u66f4\u65b0\u5e73\u8861\u56e0\u5b50\u6c14\u6ce1</li> </ul>"},{"location":"design/animation/#37","title":"3.7 \u54c8\u592b\u66fc\u6811\u6784\u5efa","text":"<ol> <li>\u6309\u5927\u5c0f\u987a\u5e8f\u6392\u5217\u6240\u6709\u5019\u9009\u8282\u70b9</li> <li>\u5bf9\u6bcf\u4e00\u6b65\u5408\u5e76\uff1a</li> <li>\u9ad8\u4eae\u6743\u503c\u6700\u5c0f\u7684\u4e24\u8282\u70b9\uff08\u5373\u524d\u4e24\u4e2a\uff09\u3002</li> <li>\u805a\u7126\u4e24\u4e2a\u5b50\u8282\u70b9\u5e76\u5411\u4e0a\u201c\u6c47\u805a\u201d\uff08\u8fb9\u52a8\u753b\uff09\u5230\u4e00\u4e2a\u6de1\u5165\u7684\u65b0\u7236\u8282\u70b9\u3002</li> <li>\u5c06\u7236\u52a0\u5165\uff08\u5e73\u79fb\u81f3\uff09\u5019\u9009\u8282\u70b9\u6392\u5217\uff08\u4ee5\u7236\u8282\u70b9\u4e3a\u6839\u7684\u6811\u4e00\u540c\u79fb\u52a8\uff09</li> <li>\u54c8\u592b\u66fc\u6811\u6784\u5efa\u5b8c\u6210\u540e\u5168\u4f53\u8282\u70b9\u95ea\u70c1\u4e00\u6b21\u3002</li> </ol>"},{"location":"design/animation/#38-git","title":"3.8 Git \u6559\u5b66\u64cd\u4f5c\u52a8\u753b\uff08\u65b0\u589e\uff09","text":"<p>\u672c\u9879\u76ee\u652f\u6301\u5c55\u793a Git \u5185\u90e8\u6570\u636e\u7ed3\u6784\u5728\u4e00\u7ec4\u865a\u62df\u64cd\u4f5c\u4e0b\u7684\u53d8\u5316\u8fc7\u7a0b\uff0c\u7528\u4e8e\u6559\u5b66\u76ee\u7684\u3002 \u6240\u6709\u52a8\u753b\u9075\u5faa L2 \u6559\u5b66\u7ea7\u8981\u6c42\uff0c\u5c06 Git \u547d\u4ee4\u62c6\u89e3\u4e3a\u82e5\u5e72 micro-steps\u3002 \u8fd9\u91cc\u53ea\u505a\u6587\u5b57\u53d9\u8ff0\uff0c\u5e94\u5728\u5b9e\u73b0\u662f\u6839\u636e\u5f53\u65f6\u5177\u4f53\u7684 Renderer \u7684\u5b9e\u73b0\u60c5\u51b5\u8003\u8651\u6700\u4f18 \u7684\u5b9e\u73b0\u65b9\u6848\u3002</p>"},{"location":"design/animation/#git-init","title":"git init","text":"<ol> <li>\u521b\u5efa\u4e00\u4e2a\u7a7a DAG \u533a\u57df\u3002</li> <li>\u521b\u5efa main \u5206\u652f\u5f15\u7528\uff08branch label\uff09\u3002</li> <li>HEAD \u6307\u5411 main\u3002</li> </ol>"},{"location":"design/animation/#git-commit-m","title":"git commit -m \"\" <ol> <li>\u9ad8\u4eae HEAD \u6307\u5411\u7684 commit\uff08\u7a7a\u4ed3\u5e93\u65f6\u7684 main \u6216\u4e0d\u9ad8\u4eae\uff09\u3002</li> <li>\u5728\u540c\u4e00 lane \u4e0a\u65b9\u751f\u6210\u65b0 commit \u8282\u70b9\u3002</li> <li>\u52a8\u753b\u7ed8\u5236\u4ece\u7236 commit \u5230\u65b0 commit \u7684\u8fb9\u3002</li> <li>\u5c06 branch label \u79fb\u52a8\u5230\u65b0 commit\u3002</li> <li>\u5c06 HEAD \u79fb\u52a8\u5230 branch label\u3002</li> </ol>","text":""},{"location":"design/animation/#git-branch","title":"git branch  <ol> <li>\u9ad8\u4eae HEAD \u6240\u5728 commit\u3002</li> <li>\u5728\u8be5 commit \u65c1\u5c55\u793a\u65b0\u5206\u652f label\u3002</li> <li>\u52a0\u5165\u63d0\u793a\u6587\u5b57\uff1a\u201cbranch  \u6307\u5411\u5f53\u524d\u63d0\u4ea4\u201d\u3002","text":""},{"location":"design/animation/#git-checkout","title":"git checkout  <ol> <li>\u9ad8\u4eae\u5f53\u524d HEAD \u4e0e\u76ee\u6807\u5206\u652f label\u3002</li> <li>\u5c06 HEAD label \u4ece\u539f\u5206\u652f\u79fb\u52a8\u5230\u76ee\u6807\u5206\u652f\u3002</li> <li>\u9ad8\u4eae\u76ee\u6807 commit\u3002</li> <li>\u82e5\u8fdb\u5165 detached \u72b6\u6001\uff1a</li> <li>\u76f4\u63a5\u5c06 HEAD \u6307\u5411 commit \u8282\u70b9\u3002</li> <li>\u663e\u793a\u63d0\u793a\uff1a\u201cdetached HEAD\u201d\u3002</li> </ol>","text":""},{"location":"design/animation/#git-merge","title":"git merge \uff08\u7b80\u5316\u65e0\u51b2\u7a81\u7248\u672c\uff09 <ol> <li>\u9ad8\u4eae\u5f53\u524d\u5206\u652f HEAD\u3002</li> <li>\u9ad8\u4eae\u5f85\u5408\u5e76\u5206\u652f HEAD\u3002</li> <li>\u751f\u6210 merge commit \u8282\u70b9\uff08\u4e24\u4e2a parent edge\uff09\u3002</li> <li>\u5f53\u524d branch label \u4e0e HEAD \u5171\u540c\u79fb\u52a8\u5230 merge commit\u3002</li> <li>\u52a0\u5165\u63d0\u793a\u6587\u5b57\uff1a\u201cmerge commit\uff08\u7b80\u5316\u7248\uff09\u201d\u3002</li> </ol>","text":""},{"location":"design/animation/#4","title":"4. \u89c6\u89c9\u3001\u72b6\u6001\u4e0e\u4ea4\u4e92\u7edf\u4e00\u89c4\u8303","text":""},{"location":"design/animation/#41","title":"4.1 \u72b6\u6001\u503c\u4e0e\u989c\u8272\uff08\u63a8\u8350\u8868\uff09","text":"State \u7528\u9014\u793a\u4f8b \u9ed8\u8ba4\u989c\u8272\uff08RendererConfig\uff09 normal \u9ed8\u8ba4\u72b6\u6001 <code>#6b7280</code> active \u5f53\u524d\u64cd\u4f5c\u7126\u70b9 <code>#2563eb</code> highlight \u5173\u952e\u8282\u70b9/\u65b0\u8fb9\u5f3a\u8c03 <code>#f59e0b</code> secondary \u904d\u5386\u8def\u5f84\u3001\u8f85\u52a9\u9ad8\u4eae <code>#059669</code> to_delete \u5c06\u88ab\u66ff\u6362/\u5220\u9664\u7684\u5143\u7d20\uff08\u65e7\u8fb9\u7b49\uff09 <code>#dc2626</code> faded \u5f31\u5316/\u964d\u6743\u663e\u793a <code>#9ca3af</code> error \u9519\u8bef\u63d0\u793a <code>#f97316</code> <p>\u8bf4\u660e\uff1a\u72b6\u6001\u5b57\u7b26\u4e32\u53ef\u6269\u5c55\uff0cRendererConfig \u53ef\u8986\u5199\u989c\u8272\uff1b\u65b0\u6a21\u578b\u5e94\u590d\u7528\u4e0a\u8ff0\u8bed\u4e49\uff0c\u907f\u514d\u81ea\u5b9a\u4e49\u6563\u4e71\u547d\u540d\u3002</p>"},{"location":"design/animation/#42","title":"4.2 \u52a8\u753b\u65f6\u95f4\u4e0e\u63a7\u5236","text":"<ul> <li>\u5355\u4e2a micro-step \u52a8\u753b\u65f6\u957f\u5efa\u8bae\u5728 300\u2013600 ms\u3002</li> <li>\u5168\u5c40\u901f\u5ea6\u56e0\u5b50\uff1a0.5x / 1x / 2x\uff08\u5f53\u524d PySide6Renderer \u540c\u6b65\u963b\u585e\u63d2\u503c\uff09\u3002</li> <li>\u64ad\u653e\u63a7\u5236\uff1aPlay / Pause / Step / \u91cd\u7f6e\uff1bseek/skip/\u975e\u963b\u585e\u4e3a\u540e\u7eed\u65b9\u5411\uff08\u5360\u4f4d\uff09\u3002</li> <li>max_frames/easing\uff1aRendererConfig \u63d0\u4f9b\u5360\u4f4d\u53c2\u6570\uff08\u9ed8\u8ba4 10 \u5e27\u3001\u7ebf\u6027\uff09\uff0c\u884c\u4e3a\u4e0e\u65e7\u7248\u4e00\u81f4\u3002</li> </ul>"},{"location":"design/animation/#43","title":"4.3 \u6587\u672c\u4e0e\u8f85\u52a9\u63d0\u793a\uff08\u6d88\u606f\u7b56\u7565\uff09","text":"<ul> <li>\u4f7f\u7528 <code>SET_MESSAGE</code> / <code>CLEAR_MESSAGE</code> \u663e\u793a HUD \u6587\u672c\uff1b\u5f53\u524d PySide6Renderer \u5c06\u6d88\u606f\u951a\u5b9a\u5230\u573a\u666f bbox \u9876\u90e8\u5c45\u4e2d\uff08\u907f\u514d\u4e0e\u7ed3\u6784\u8fc7\u8fdc\uff09\uff0c\u53ef\u6839\u636e\u7ed3\u6784 bbox \u518d\u7ec6\u5316\u3002</li> <li>RendererConfig <code>show_messages</code> \u53ef\u7981\u7528\u6d88\u606f\u6e32\u67d3\uff1b\u951a\u5b9a\u8282\u70b9/\u5bcc\u63d0\u793a\u4e3a\u672a\u6765\u6269\u5c55\u3002</li> <li>\u63a8\u8350\uff1a\u5728\u64cd\u4f5c\u5f00\u59cb/\u7ed3\u679c\u65f6\u63d0\u4f9b\u7b80\u77ed\u63d0\u793a\uff0c\u907f\u514d\u6bcf\u6b65\u9891\u7e41\u5237\u5c4f\uff1b\u5b8c\u6210\u540e\u52a1\u5fc5 CLEAR_MESSAGE\u3002</li> </ul>"},{"location":"design/animation/#44","title":"4.4 \u8282\u70b9\u4e0e\u8fb9\u7684\u89c6\u89c9\u98ce\u683c","text":"<ul> <li>\u987a\u5e8f\u8868/\u6808\uff1a\u77e9\u5f62\u5757\uff1b\u94fe\u8868\uff1a\u503c+next \u533a\u57df\uff1b\u6811\u8282\u70b9\uff1a\u5706/\u5706\u89d2\u77e9\u5f62\uff1bGit \u8282\u70b9\uff1a\u5c0f\u5706\u70b9+\u6807\u7b7e\u3002</li> <li>\u5f53\u524d\u7126\u70b9\u7528 active/highlight\uff1b\u5f85\u66ff\u6362/\u5220\u9664\u7528 to_delete\u3002</li> <li>\u5f62\u72b6/\u5c3a\u5bf8\u7531 RendererConfig \u51b3\u5b9a\uff0c\u7f3a\u7701\u4fdd\u6301\u73b0\u6709\u89c6\u89c9\uff1b\u4e0e Layout \u7684\u5c3a\u5bf8/\u95f4\u8ddd\u8054\u52a8\u4e3a\u540e\u7eed\u4f18\u5316\u3002</li> </ul>"},{"location":"design/animation/#5-animationops","title":"5. \u4e0e AnimationOps \u7684\u5173\u7cfb","text":"<p>\u672c\u6587\u4ef6\u63cf\u8ff0\u7684\u662f\"\u52a8\u753b\u5e94\u8be5\u5c55\u793a\u4ec0\u4e48\"\u7684\u6559\u5b66\u9700\u6c42\u5c42\u9762\u3002 \u5728\u5b9e\u73b0\u65f6\uff1a</p> <ul> <li>Model \u4e0e SceneGraph \u5e94\u6839\u636e\u8fd9\u4e9b\u8981\u6c42\uff0c\u5c06\u4e00\u4e2a\u9ad8\u5c42\u64cd\u4f5c\u62c6\u6210\u82e5\u5e72 AnimationOps \u5e8f\u5217\uff0c\u5e76\u7ec4\u7ec7\u4e3a Timeline\u3002</li> <li>AnimationOps \u548c Timeline \u7684\u5177\u4f53\u7c7b\u578b\u4e0e\u5b57\u6bb5\u5b9a\u4e49\u5728 <code>ops_spec.md</code> \u4e2d\u3002</li> <li>Renderer\uff08PySide6/Web\uff09\u8d1f\u8d23\uff1a</li> <li>\u63a5\u6536 Timeline\uff0c\u6309 Step \u987a\u5e8f\u64ad\u653e</li> <li>\u5728\u6bcf\u4e2a Step \u7684 <code>duration_ms</code> \u65f6\u95f4\u5185\uff0c\u4ece\u5f53\u524d\u53ef\u89c6\u72b6\u6001\u8fc7\u6e21\u5230\u5e94\u7528\u6240\u6709 Ops \u540e\u7684\u7ec8\u6001</li> <li>\u4e0d\u91cd\u65b0\u51b3\u5b9a\u6559\u5b66\u7c92\u5ea6\u4e0e\u6d41\u7a0b\uff0c\u4ec5\u8d1f\u8d23\u5177\u4f53\u7684\u6e32\u67d3\u4e0e\u52a8\u753b\u5b9e\u73b0</li> </ul> <p>\u5982\u679c\u73b0\u6709\u7684 AnimationOps \u5b9a\u4e49\u4e0d\u8db3\u4ee5\u652f\u6491\u76ee\u524d\u7684\u52a8\u753b\u8981\u6c42\uff0c\u5e94\u8be5\u7ecf\u8fc7\u8c28\u614e\u8003\u8651\u540e\u6269\u5c55</p>"},{"location":"design/animation/#6-p06","title":"6. \u5f53\u524d\u5b9e\u73b0\u57fa\u7ebf\uff08P0.6\uff09","text":"<ul> <li>\u64ad\u653e\u7c92\u5ea6\uff1a\u4ecd\u4ee5 Step \u4e3a\u5355\u4f4d\uff0c\u4e0d\u652f\u6301 seek/\u5012\u64ad/skip\u3002</li> <li>\u52a8\u753b\u5b9e\u73b0\uff1aPySide6 renderer \u57fa\u4e8e <code>duration_ms</code> \u505a\u540c\u6b65\u63d2\u503c\uff08\u7ebf\u6027\uff09\uff0cCREATE/DELETE \u6de1\u5165\u6de1\u51fa\uff0c<code>SET_POS</code>/<code>SET_STATE</code> \u7ebf\u6027\u8fc7\u6e21\uff0c\u5e27\u6570\u6700\u591a 10 \u5e27\uff1b\u53ef\u5168\u5c40\u5f00\u5173\u3001\u901f\u5ea6\u500d\u7387\uff080.5/1/2\uff09\u3002</li> <li>\u9650\u5236\uff1a\u52a8\u753b\u4e3a\u963b\u585e\u5f0f\uff08\u4f7f\u7528 qWait\uff09\uff0c\u957f\u65f6\u957f\u6216\u5927\u91cf\u8282\u70b9\u53ef\u80fd\u5361 UI\uff1b\u65e0\u81ea\u5b9a\u4e49\u7f13\u52a8\u3001\u65e0\u5f02\u6b65\u8c03\u5ea6\u3002</li> <li>UI \u63a7\u4ef6\uff1aDev \u64ad\u653e\u63a7\u5236 Play/Pause/Step/Speed \u4e0e\u52a8\u753b\u5f00\u5173\uff0c\u5355\u573a\u666f\u6f14\u793a\u7528\uff0c\u4e0d\u542b seek/\u591a\u65f6\u95f4\u7ebf\u7ba1\u7406\u3002</li> </ul> <p>\u4ea4\u53c9\u5f15\u7528\uff1a<code>kind</code> \u7684\u8bed\u4e49\u7c7b\u578b\u4e0e Style/Metrics \u7684\u6ce8\u5165\u7ea6\u675f\u8bf7\u53c2\u89c1 <code>docs/design/architecture.md</code> \u7b2c 6.3 \u8282\u3002</p>"},{"location":"design/animation/#7-p06","title":"7. \u5df2\u77e5\u7f3a\u53e3\uff08P0.6\uff09","text":"<ul> <li>Model\uff1a\u94fe\u8868\u63d2\u5165\u7f3a\u5c11\u201c\u4ece\u5934\u8282\u70b9\u904d\u5386\u5230\u76ee\u6807\u4f4d\u7f6e\u201d\u7684\u9ad8\u4eae/\u7184\u706d\u5faa\u73af\u6b65\u9aa4\uff08\u9700\u8865 L2 traversal\uff09\u3002</li> <li>Renderer\uff1a\u8fb9\u52a8\u753b\u7f3a\u5931\uff08\u4ec5\u652f\u6301\u8fb9\u521b\u5efa\u4e0e\u72b6\u6001\u8272\u53d8\u5316\uff09\uff1b\u672a\u5b9e\u73b0\u201c\u9010\u6e10\u7ed8\u5236/\u865a\u7ebf\u6293\u53d6/\u5220\u9664\u8fb9\u201d\u7684\u8868\u73b0\u3002</li> <li>Layout\uff1a\u8282\u70b9\u201c\u4fa7\u8fb9\u60ac\u505c/\u4ece\u4e0a\u65b9\u5165\u573a\u201d\u7684\u4f4d\u7f6e\u9884\u7559\u672a\u5b9e\u73b0\u3002\u8be5\u9700\u6c42\u6807\u8bb0\u4e3a\u4f4e\u4f18\u5148\u7ea7\uff0c\u4e14\u5e94\u5728 Layout \u5c42\u5b9e\u73b0\uff0c\u907f\u514d Renderer \u901a\u8fc7\u79c1\u6709\u4f4d\u79fb\u89c4\u5219\u5f15\u5165\u9690\u5f0f\u8026\u5408\u3002</li> </ul>"},{"location":"design/architecture/","title":"ARCHITECTURE \u2014 \u67b6\u6784\u8bbe\u8ba1\u8bf4\u660e","text":""},{"location":"design/architecture/#1","title":"1. \u9876\u5c42\u5206\u5c42\u7ed3\u6784","text":"<p>\u672c\u9879\u76ee\u91c7\u7528\u5206\u5c42\u67b6\u6784\uff0c\u5c06\u201c\u7b97\u6cd5\u903b\u8f91 / \u573a\u666f\u72b6\u6001 / \u52a8\u753b\u6307\u4ee4 / \u6e32\u67d3\u5668 / UI\u201d\u660e\u786e\u62c6\u5206\uff1a</p> <pre><code>UI / DSL / LLM\n        \u2502\n        \u2502 (Command)\n        \u25bc\n SceneGraph  \u2014\u2014  Persistence\n        \u2502\n        \u2502 (\u8c03\u7528 Model\uff0c\u66f4\u65b0\u5185\u90e8\u72b6\u6001)\n        \u25bc\n     Models (\u6570\u636e\u7ed3\u6784\uff1aList / Stack / BST / AVL / Huffman / GitGraph ...)\n        \u2502\n     Layout \u6a21\u5757\u6ce8\u5165\uff1aSET_POS Ops\n        \u2502 (AnimationOps + Timeline)\n        \u25bc\n Animation Engine\n   (AnimationOps \u7c7b\u578b + \u65f6\u95f4\u7ebf\u7ba1\u7406)\n        \u2502\n        \u2502\n        \u25bc\n Renderers\n   \u251c\u2500 PySide6 Renderer \uff08\u5f53\u524d MVP\uff09\n   \u2514\u2500 \u672a\u6765\uff1aWeb Renderer (React + Canvas/WebGL)\n</code></pre> <p>\u9519\u8bef\u5904\u7406 (Error Handling) \u8d2f\u7a7f\u5168\u5c42\uff1a - Model \u629b\u51fa\u903b\u8f91\u5f02\u5e38 - SceneGraph \u629b\u51fa\u573a\u666f\u5f02\u5e38 - UI/DSL \u7edf\u4e00\u6355\u83b7\u5e76\u5c55\u793a</p> <p>\u76ee\u6807\uff1a</p> <ul> <li>Renderer \u5b8c\u5168\u72ec\u7acb\u4e8e\u6570\u636e\u7ed3\u6784\u5b9e\u73b0\uff1b</li> <li>DSL / LLM / UI \u901a\u8fc7\u7edf\u4e00\u547d\u4ee4\u63a5\u53e3\u4e0e SceneGraph \u4ea4\u4e92\uff1b</li> <li>Persistence \u53ea\u9700\u4e0e SceneGraph \u6253\u4ea4\u9053\uff0c\u5373\u53ef\u6062\u590d/\u4fdd\u5b58\u5f53\u524d\u573a\u666f\u3002</li> </ul>"},{"location":"design/architecture/#2","title":"2. \u6a21\u5757\u5212\u5206\u4e0e\u76ee\u5f55","text":"<p>\u5bf9\u5e94 <code>src/ds_vis/</code> \u4e0b\u7684\u6a21\u5757\u89c4\u5212\u5982\u4e0b\uff1a</p> <pre><code>src/ds_vis/\n  core/\n    models/       # \u5404\u79cd\u6570\u636e\u7ed3\u6784\u6a21\u578b\uff1alist, stack, bst, avl, huffman, gitgraph\n                  # - gitgraph \u7528\u4e8e\u8868\u793a\u7b80\u5316\u7684 Git \u63d0\u4ea4\u56fe\uff08commit DAG\uff09\u3001\u5206\u652f\u5f15\u7528\u4e0e HEAD \u72b6\u6001\u3002\n    ops/          # AnimationOps \u7c7b\u578b\u5b9a\u4e49\u4e0e\u65f6\u95f4\u7ebf\uff08timeline\uff09\u7ba1\u7406\n    scene/        # Command \u7c7b\u578b\u4e0e SceneGraph\uff08\u7edf\u4e00\u573a\u666f\u72b6\u6001\uff09\n    layout/       # \u5e03\u5c40\u7b97\u6cd5\uff08\u6811\u5e03\u5c40\u3001\u7ebf\u6027\u5e03\u5c40\u3001Git DAG \u5e03\u5c40\uff09\n    exceptions.py # \u7edf\u4e00\u5f02\u5e38\u5b9a\u4e49\n  renderers/\n    base.py       # \u62bd\u8c61 Renderer \u63a5\u53e3\n    pyside6/      # PySide6 \u6e32\u67d3\u5668\u5177\u4f53\u5b9e\u73b0\n  ui/\n    main_window.py  # PySide6 \u4e3b\u7a97\u53e3\u4e0e\u4ea4\u4e92\u63a7\u4ef6\n    # \u5176\u4ed6 UI \u7ec4\u4ef6 ...\n  dsl/\n    # DSL \u89e3\u6790\u4e0e\u6267\u884c\uff08\u540e\u671f\u5b9e\u73b0\uff09\n  persistence/\n    # \u573a\u666f\u4fdd\u5b58\u4e0e\u52a0\u8f7d\n</code></pre>"},{"location":"design/architecture/#3-scenegraph-command","title":"3. SceneGraph \u4e0e Command","text":""},{"location":"design/architecture/#31-command","title":"3.1 Command","text":"<p><code>Command</code> \u8868\u8fbe\u7684\u662f\u201c\u5bf9\u67d0\u4e2a\u6570\u636e\u7ed3\u6784\u8fdb\u884c\u67d0\u79cd\u9ad8\u5c42\u6b21\u64cd\u4f5c\u201d\uff0c\u800c\u4e0d\u662f\u4f4e\u5c42\u52a8\u753b\u6307\u4ee4\u3002</p> <p>\u793a\u4f8b\uff1a</p> <ul> <li>\u5bf9 BST \u63d2\u5165\u4e00\u4e2a\u503c\uff1a<code>INSERT</code> with payload <code>{ \"value\": 5, \"structure_type\": \"bst\" }</code></li> <li>\u521b\u5efa\u4e00\u4e2a\u94fe\u8868\uff1a<code>CREATE_STRUCTURE</code> with payload <code>{ \"kind\": \"list\", \"values\": [1,2,3] }</code></li> </ul> <p>Command \u662f\uff1a</p> <ul> <li>UI \u6309\u94ae\u70b9\u51fb\u7684\u7edf\u4e00\u62bd\u8c61\uff1b</li> <li>DSL \u89e3\u6790\u7684\u7edf\u4e00\u8f93\u51fa\u5f62\u5f0f\uff1b</li> <li>Persistence \u56de\u653e\u64cd\u4f5c\u5386\u53f2\u7684\u57fa\u7840\u5355\u4f4d\u3002</li> </ul>"},{"location":"design/architecture/#32-scenegraph","title":"3.2 SceneGraph","text":"<p><code>SceneGraph</code> \u8d1f\u8d23\uff1a</p> <ol> <li>\u7ba1\u7406\u6240\u6709\u5f53\u524d\u5b58\u5728\u7684\u7ed3\u6784\u5b9e\u4f8b\uff08list / stack / bst / avl / gitgraph \u7b49\uff09\u3002</li> <li>\u63a5\u53d7 <code>Command</code>\uff0c\u8def\u7531\u5230\u6b63\u786e\u7684 Model \u5b9e\u4f8b\u4e0e\u65b9\u6cd5\u3002</li> <li>\u63a5\u6536 Model \u8fd4\u56de\u7684 Timeline \u8c03\u7528 Layout \u5b8c\u6210 Timeline\uff0c\u4f9b Renderer \u64ad\u653e\u3002</li> <li>\u63d0\u4f9b\u5f53\u524d\u573a\u666f\u72b6\u6001\u7684\u5bfc\u5165/\u5bfc\u51fa\u63a5\u53e3\uff0c\u4f9b Persistence \u4f7f\u7528\u3002</li> </ol> <p>SceneGraph \u4e0d\u505a\uff1a</p> <ul> <li>\u5177\u4f53\u52a8\u753b\u5b9e\u73b0\uff08\u7531 AnimationOps + Renderer \u8d1f\u8d23\uff09\uff1b</li> <li>\u6570\u636e\u7ed3\u6784\u6a21\u578b\u903b\u8f91\uff08\u7531 Model \u8d1f\u8d23\uff09\uff1b</li> <li>\u5e03\u5c40\u8ba1\u7b97\uff08\u7531 Layout \u8d1f\u8d23\uff09\uff1b</li> <li>UI \u903b\u8f91\uff08\u7531 UI \u8d1f\u8d23\uff09\uff1b</li> <li>DSL \u6587\u672c\u89e3\u6790\uff08\u7531 DSL \u8d1f\u8d23\uff09\u3002</li> </ul> <p>P0.4 \u7ea6\u5b9a\uff1a - \u547d\u4ee4\u5165\u53e3\u901a\u8fc7 (CommandType, kind) \u2192 schema + \u6a21\u578b op \u6ce8\u518c\u8868\u9a71\u52a8\uff0c\u7edf\u4e00\u8bed\u6cd5\u6821\u9a8c\u4e0e\u8def\u7531\uff1b\u672a\u77e5\u547d\u4ee4/\u79cd\u7c7b\u76f4\u63a5\u629b <code>CommandError</code>\u3002 - \u5220\u9664\u8bed\u4e49\u62c6\u5206\u4e3a <code>DELETE_STRUCTURE</code>\uff08\u6574\u7ed3\u6784\u5220\u9664\uff09\u4e0e <code>DELETE_NODE</code>\uff08\u6309\u7d22\u5f15/ID \u5220\u9664\uff09\uff1b\u4e0d\u518d\u4f7f\u7528\u91cd\u8f7d\u7684 DELETE\u3002 - SceneGraph \u4e0d\u518d\u76f4\u63a5\u8bbf\u95ee\u6a21\u578b\u5185\u90e8\u72b6\u6001\uff0c\u4f9d\u8d56 BaseModel \u63a5\u53e3\uff08kind/node_count/apply_operation\uff09\u3002</p>"},{"location":"design/architecture/#4-error-handling","title":"4. \u9519\u8bef\u5904\u7406 (Error Handling)","text":"<p>\u4e3a\u4e86\u4fdd\u8bc1\u7cfb\u7edf\u7684\u5065\u58ee\u6027\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u7edf\u4e00\u7684\u5f02\u5e38\u5c42\u7ea7\uff1a</p>"},{"location":"design/architecture/#41-srcds_viscoreexceptionspy","title":"4.1 \u5f02\u5e38\u7c7b\u5b9a\u4e49 (<code>src/ds_vis/core/exceptions.py</code>)","text":"<ul> <li><code>DsVisError</code>: \u6240\u6709\u81ea\u5b9a\u4e49\u5f02\u5e38\u7684\u57fa\u7c7b\u3002</li> <li><code>SceneError</code>: \u573a\u666f\u64cd\u4f5c\u5931\u8d25\uff08\u5982\u627e\u4e0d\u5230 ID\uff09\u3002</li> <li><code>ModelError</code>: \u903b\u8f91\u975e\u6cd5\uff08\u5982\u7a7a\u6808\u5f39\u51fa\uff09\u3002</li> <li><code>LayoutError</code>: \u5e03\u5c40\u8ba1\u7b97\u5931\u8d25\u3002</li> <li><code>CommandError</code>: \u6307\u4ee4\u53c2\u6570\u9519\u8bef\u3002</li> </ul>"},{"location":"design/architecture/#42","title":"4.2 \u5904\u7406\u7b56\u7565","text":"<ol> <li>Model \u5c42: \u9047\u5230\u975e\u6cd5\u64cd\u4f5c\uff08\u5982 <code>pop</code> \u7a7a\u6808\uff09\u5e94\u629b\u51fa <code>ModelError</code>\uff0c\u800c\u4e0d\u662f\u8fd4\u56de\u7a7a Timeline \u6216\u5d29\u6e83\u3002</li> <li>SceneGraph \u5c42: \u8d1f\u8d23\u6355\u83b7 <code>ModelError</code> \u6216\u9a8c\u8bc1 <code>Command</code>\uff0c\u5fc5\u8981\u65f6\u629b\u51fa <code>SceneError</code>\u3002</li> <li>UI / DSL \u5c42: \u662f\u5f02\u5e38\u7684\u6700\u7ec8\u6355\u83b7\u8005\u3002<ul> <li>UI \u5e94\u6355\u83b7 <code>DsVisError</code> \u5e76\u901a\u8fc7\u5f39\u7a97\u6216\u72b6\u6001\u680f\u63d0\u793a\u7528\u6237\uff08\u4e0d\u8981 Crash\uff09\u3002</li> <li>DSL \u5e94\u6355\u83b7\u5f02\u5e38\u5e76\u8f93\u51fa\u9519\u8bef\u884c\u53f7\u548c\u539f\u56e0\u3002</li> </ul> </li> </ol>"},{"location":"design/architecture/#5-model","title":"5. Model \u5c42","text":""},{"location":"design/architecture/#51","title":"5.1 \u6838\u5fc3\u804c\u8d23","text":"<p>Model \u5c42\u7ef4\u62a4\u771f\u5b9e\u7684\u6570\u636e\u7ed3\u6784\u5185\u90e8\u72b6\u6001\uff0c\u5e76\u5728\u6bcf\u6b21\u64cd\u4f5c\u540e\u751f\u6210\u76f8\u5e94\u7684\"\u7ed3\u6784 Ops\"\u3002\u5b83\u7684\u6838\u5fc3\u804c\u8d23\u662f\uff1a</p> <ol> <li>\u7ef4\u62a4\u6570\u636e\u7ed3\u6784\u72b6\u6001\uff1a</li> <li>\u7ba1\u7406\u771f\u5b9e\u7684\u6811\u3001\u94fe\u8868\u3001\u6808\u7b49\u7684\u5185\u90e8\u72b6\u6001\uff08\u6307\u9488\u3001\u503c\u3001\u5e73\u8861\u56e0\u5b50\u7b49\uff09</li> <li> <p>\u72b6\u6001\u9a71\u52a8\u5b8c\u5168\u7531\u6570\u636e\u7ed3\u6784\u672c\u8eab\u7684\u903b\u8f91\u51b3\u5b9a</p> </li> <li> <p>\u751f\u6210\u7ed3\u6784 Ops\uff1a</p> </li> <li>\u5c06\u6bcf\u6b21\u64cd\u4f5c\u62c6\u89e3\u4e3a\u4e00\u7cfb\u5217 AnimationOps</li> <li>\u53ea\u5173\u6ce8\u7ed3\u6784\u53d8\u5316\uff08CREATE_NODE\u3001DELETE_NODE\u3001CREATE_EDGE\u3001SET_STATE\u3001SET_LABEL \u7b49\uff09</li> <li>\u4e0d\u5f97\u5305\u542b\u4efb\u4f55\u5e03\u5c40\u4fe1\u606f\uff08\u5982\u5750\u6807\u3001\u4f4d\u7f6e\uff09</li> </ol>"},{"location":"design/architecture/#52-model","title":"5.2 Model \u5c42\u7684\u7ea6\u675f","text":"<p>Model \u5c42\u7981\u6b62\uff1a</p> <ul> <li>\u4f9d\u8d56 Renderer\u3001UI\u3001DSL \u6216\u5176\u4ed6\u9ad8\u5c42\u6a21\u5757</li> <li>\u4f7f\u7528 PySide6 \u6216\u4efb\u4f55 UI \u6846\u67b6 API</li> <li>\u4f9d\u8d56\u6216\u751f\u6210 Timeline\uff08Timeline \u662f\u4e0a\u5c42\u7684\u804c\u8d23\uff09</li> <li>\u5904\u7406\u6216\u4f7f\u7528\u5750\u6807\u3001\u4f4d\u7f6e\u7b49\u89c6\u89c9\u5c5e\u6027\uff08\u8fd9\u662f Layout \u7684\u804c\u8d23\uff09</li> <li>\u4fee\u6539 SceneGraph \u7684\u5185\u90e8\u72b6\u6001</li> <li>\u8fdb\u884c\u4efb\u4f55 UI \u903b\u8f91\u5224\u65ad</li> </ul> <p>\u5173\u952e\u8bbe\u8ba1\u601d\u60f3\uff1aModel \u5c42\u5e94\u8be5\u5c31\u50cf\u4e00\u4e2a\"\u4e0d\u77e5\u9053\u81ea\u5df1\u4f1a\u88ab\u53ef\u89c6\u5316\"\u7684\u7eaf\u6570\u636e\u7ed3\u6784\u5e93\uff0c\u5b8c\u5168\u72ec\u7acb\u53ef\u7528\u3002</p>"},{"location":"design/architecture/#6-layout","title":"6. Layout \u5c42","text":""},{"location":"design/architecture/#61","title":"6.1 \u6838\u5fc3\u804c\u8d23","text":"<p>Layout \u5f15\u64ce\u662f Model \u548c Renderer \u4e4b\u95f4\u7684\"\u51e0\u4f55\u4e2d\u4ecb\"\u3002\u5b83\u8d1f\u8d23\uff1a</p> <ol> <li>\u7406\u89e3\u7ed3\u6784\u4fe1\u606f\uff1a</li> <li>\u63a5\u6536 Model \u5c42\u751f\u6210\u7684\u7ed3\u6784 Ops</li> <li> <p>\u7406\u89e3\u6570\u636e\u7ed3\u6784\u7684\u62d3\u6251\u4fe1\u606f\uff08\u6811\u6df1\u3001\u94fe\u8868\u957f\u5ea6\u3001\u8282\u70b9\u5173\u7cfb\u7b49\uff09</p> </li> <li> <p>\u8ba1\u7b97\u51e0\u4f55\u5e03\u5c40\uff1a</p> </li> <li>\u57fa\u4e8e\u6570\u636e\u7ed3\u6784\u7684\u62d3\u6251\uff0c\u8ba1\u7b97\u6bcf\u4e2a Node \u5e94\u8be5\u5728\u54ea\u91cc\uff08x, y \u5750\u6807\uff09</li> <li>\u652f\u6301\u591a\u79cd\u5e03\u5c40\u7b97\u6cd5\uff08\u6811\u5e03\u5c40\u3001\u7ebf\u6027\u5e03\u5c40\u3001DAG \u5e03\u5c40\u7b49\uff09</li> <li> <p>\u8003\u8651\u6559\u5b66\u6548\u679c\uff08\u5982\u4fdd\u6301\u8282\u70b9\u95f4\u8ddd\u3001\u907f\u514d\u91cd\u53e0\u7b49\uff09</p> </li> <li> <p>\u6ce8\u5165 SET_POS Ops\uff1a</p> </li> <li>\u5728 Model \u751f\u6210\u7684 Ops \u4e2d\u7684\u5173\u952e\u6b65\u9aa4\u63d2\u5165 SET_POS Ops</li> <li>\u4fdd\u8bc1\u5750\u6807\u7684\u751f\u6210\u65f6\u673a\u4e0e\u7ed3\u6784\u53d8\u5316\u540c\u6b65</li> <li>\u8fd4\u56de\u5b8c\u6574\u7684\"\u53ef\u6e32\u67d3 Ops \u5e8f\u5217\"\uff08\u7ed3\u6784 Ops + SET_POS Ops\uff09</li> </ol>"},{"location":"design/architecture/#62-layout","title":"6.2 Layout \u5c42\u7684\u7ea6\u675f","text":"<p>Layout \u5c42\u7981\u6b62\uff1a</p> <ul> <li>\u4fee\u6539\u6216\u5220\u9664\u7ed3\u6784\u7c7b Ops\uff08\u5982\u4e0d\u5e94\u6539\u5199 CREATE_NODE \u7684\u5185\u5bb9\uff09</li> <li>\u63a8\u6d4b\u6570\u636e\u7ed3\u6784\u7684\u8bed\u4e49\u6216\u4e1a\u52a1\u903b\u8f91\uff08\u53ea\u5e94\u7406\u89e3\u5176\u62d3\u6251\u7ed3\u6784\uff09</li> <li>\u4e0e Model \u5c42\u5f62\u6210\u53cc\u5411\u4f9d\u8d56\uff08\u5355\u5411\u6d41\u5411\uff1aModel \u2192 Layout\uff09</li> <li>\u4e0e Renderer \u5c42\u7684\u53cc\u5411\u8026\u5408\uff08\u53ea\u8f93\u51fa Ops\uff0c\u4e0d\u5173\u5fc3\u5982\u4f55\u6e32\u67d3\uff09</li> </ul> <p>\u5173\u952e\u8bbe\u8ba1\u601d\u60f3\uff1aLayout \u662f\u4e00\u4e2a\u7eaf\u51e0\u4f55\u8ba1\u7b97\u5c42\uff0c\u5728\u4e0d\u7406\u89e3\u5177\u4f53\u6570\u636e\u7ed3\u6784\u4e1a\u52a1\u7684\u60c5\u51b5\u4e0b\uff0c\u4e5f\u80fd\u4e3a\u4efb\u4f55\u7ed3\u6784\u7c7b\u578b\u8ba1\u7b97\u5408\u7406\u7684\u5750\u6807\u3002</p>"},{"location":"design/architecture/#63-style-metrics","title":"6.3 Style / Metrics \u914d\u7f6e\uff08\u8de8\u5c42\u7ea6\u675f\uff09","text":"<p>\u4e3a\u907f\u514d Layout \u4e0e Renderer \u7684\u9690\u5f0f\u8026\u5408\uff0c\u89c6\u89c9\u6837\u5f0f\u4e0e\u51e0\u4f55\u5ea6\u91cf\u5fc5\u987b\u901a\u8fc7\u53ef\u9009\u914d\u7f6e\u6ce8\u5165\uff0c\u800c\u975e\u8de8\u5c42\u8bfb\u53d6\uff1a</p> <ul> <li>StyleRegistry\uff08Renderer \u4fa7\uff09\uff1a\u6309 <code>kind</code> \u51b3\u5b9a\u5f62\u72b6/\u989c\u8272/\u7ebf\u578b\u7b49\u89c6\u89c9\u6837\u5f0f\uff1b\u7f3a\u5931\u5219\u56de\u9000\u9ed8\u8ba4\u6837\u5f0f\u3002</li> <li>MetricsRegistry\uff08Layout \u4fa7\uff09\uff1a\u6309 <code>kind</code> \u63d0\u4f9b\u8282\u70b9\u5c3a\u5bf8/\u95f4\u8ddd\u7b49\u5ea6\u91cf\u4fe1\u606f\uff1b\u7f3a\u5931\u5219\u56de\u9000\u9ed8\u8ba4\u5c3a\u5bf8\u4e0e spacing\u3002</li> <li>\u6ce8\u5165\u8def\u5f84\uff1a\u7531 UI/\u4e0a\u5c42\u6784\u5efa\u5e76\u6ce8\u5165\u5230 Layout/Renderer\uff1bLayout/Renderer \u4e0d\u53cd\u5411\u4f9d\u8d56\u5bf9\u65b9\u6216 Model\u3002</li> <li>Model \u8d23\u4efb\uff1a\u53ea\u8f93\u51fa <code>kind</code> \u4f5c\u4e3a\u8bed\u4e49\u7c7b\u578b\uff08\u5f3a\u70c8\u5efa\u8bae\u5fc5\u586b\uff09\uff1b\u4e0d\u8f93\u51fa\u5177\u4f53\u5c3a\u5bf8\u6216\u6e32\u67d3\u7ec6\u8282\u3002</li> <li>\u5bb9\u5668/\u7ed3\u6784\u6846\uff1a\u53ef\u4f5c\u4e3a Renderer \u4fa7\u53ef\u9009\u80fd\u529b\uff08\u6309 <code>structure_id</code> \u8ba1\u7b97\u5305\u56f4\u76d2\u7ed8\u5236\uff09\uff0c\u4e0d\u6539\u53d8 Ops \u534f\u8bae\u3002 Layout \u7684\u4fe1\u606f\u6765\u6e90\uff1aOps \u6d41 + \u62d3\u6251\u67e5\u8be2\u63a5\u53e3</li> </ul>"},{"location":"design/architecture/#64-p04-simplelayout-20","title":"6.4 \u5f53\u524d\u5b9e\u73b0\u72b6\u6001\uff08P0.4 SimpleLayout 2.0\uff09","text":"<ul> <li>\u591a\u7ed3\u6784\u5782\u76f4\u5806\u53e0\uff1a\u6bcf\u4e2a\u7ed3\u6784\u5360\u7528\u4e00\u884c\uff0c<code>row_spacing</code> \u63a7\u5236\u884c\u8ddd\uff0c\u7ed3\u6784\u5220\u9664\u540e\u884c\u538b\u7f29\u907f\u514d\u7eb5\u5411\u6f02\u79fb\u3002</li> <li>\u810f\u68c0\u67e5\uff1a\u4ec5\u5bf9\u4f4d\u7f6e\u53d1\u751f\u53d8\u5316\u7684\u8282\u70b9\u53d1 <code>SET_POS</code>\uff1b\u63d2\u5165/\u5220\u9664\u4f1a\u5c06\u53d7\u5f71\u54cd\u7ed3\u6784\u6807\u8bb0\u4e3a\u810f\u4ee5\u8986\u76d6\u7ea7\u8054\u4f4d\u79fb\u3002</li> <li>\u5bf9\u9f50\u4e0e\u5c3a\u5bf8\u5047\u8bbe\uff1a\u9ed8\u8ba4\u5de6\u5bf9\u9f50\uff0c\u5047\u5b9a\u8282\u70b9\u5c3a\u5bf8\u56fa\u5b9a\uff0c<code>spacing/row_spacing</code> \u57fa\u4e8e\u5355\u4e00\u5bbd\u9ad8\uff1b\u672a\u5b9e\u73b0\u6811/DAG \u7684\u5c45\u4e2d\u6216\u53ef\u53d8\u5c3a\u5bf8\u3002</li> <li>\u72b6\u6001\u6027\uff1a\u5e03\u5c40\u5f15\u64ce\u7ef4\u62a4\u5185\u90e8\u5feb\u7167\uff0c\u5047\u5b9a\u6309 Timeline \u987a\u5e8f\u64ad\u653e\uff0c\u4e0d\u652f\u6301 seek/\u5012\u64ad\uff1b\u82e5\u9700\u968f\u673a\u8bbf\u95ee\u9700\u91cd\u653e\u6216\u91cd\u5efa\u72b6\u6001\u3002</li> </ul>"},{"location":"design/architecture/#7-animationops-renderer","title":"7. AnimationOps \u4e0e Renderer","text":""},{"location":"design/architecture/#71-animationops-timeline","title":"7.1 AnimationOps \u5c42\u6b21\u4e0e Timeline","text":"<p>AnimationOps \u88ab\u7ec4\u7ec7\u4e3a\u6309\u987a\u5e8f\u64ad\u653e\u7684 Timeline\uff0c\u7531\u82e5\u5e72 AnimationStep \u7ec4\u6210\uff1a</p> <ul> <li>AnimationStep\uff1a\u4e00\u4e2a\u6559\u5b66\u4e0a\u7684\u539f\u5b50\u6b65\u9aa4\uff0c\u5305\u542b\uff1a</li> <li><code>duration_ms</code>\uff1a\u8be5\u6b65\u9aa4\u7684\u64ad\u653e\u65f6\u957f\uff08\u6beb\u79d2\uff09</li> <li><code>label</code>\uff1a\u53ef\u9009\u7684\u4eba\u7c7b\u53ef\u8bfb\u6807\u7b7e</li> <li> <p><code>ops</code>\uff1a\u5c5e\u4e8e\u672c\u6b65\u9aa4\u7684\u6240\u6709 AnimationOp\uff08\u5e76\u884c\u6267\u884c\uff09</p> </li> <li> <p>AnimationOp\uff1a\u539f\u5b50\u7ea7\u52a8\u753b\u6307\u4ee4\uff0c\u63cf\u8ff0\u5355\u4e2a\u72b6\u6001\u53d8\u5316\uff1a</p> </li> <li> <p><code>CREATE_NODE</code>\u3001<code>DELETE_NODE</code>\u3001<code>CREATE_EDGE</code>\u3001<code>DELETE_EDGE</code>\uff08\u7ed3\u6784\u53d8\u5316\uff09</p> </li> <li><code>SET_POS</code>\uff08\u5e03\u5c40\u4e0e\u4f4d\u7f6e\uff09</li> <li><code>SET_STATE</code>\u3001<code>SET_LABEL</code>\uff08\u72b6\u6001\u4e0e\u6837\u5f0f\uff09</li> <li><code>SET_MESSAGE</code>\uff08\u5168\u5c40\u63d0\u793a\uff09</li> </ul> <p>\u5173\u952e\u8bbe\u8ba1\u539f\u5219\uff1a</p> <ul> <li>Op \u672c\u8eab\u4e0d\u5e26\u65f6\u95f4\u6982\u5ff5\uff0c\u53ea\u63cf\u8ff0\u7ec8\u6001\uff1b\u65f6\u95f4\u63a7\u5236\u7edf\u4e00\u5728 Step \u5c42\u9762\u3002</li> <li>\u4e00\u4e2a Step \u5185\u7684\u6240\u6709 Ops \u5e94\u8bed\u4e49\u4e0a\u5c5e\u4e8e\u540c\u4e00\u4e2a\u6559\u5b66\u5fae\u6b65\u9aa4\uff0cRenderer \u53ef\u987a\u5e8f\u5904\u7406\u5b83\u4eec\u3002</li> <li>Model \u4e0e SceneGraph \u53ea\u9700\u8981\u7ec4\u5408\u8fd9\u4e9b Ops\uff0c\u4e0d\u5173\u5fc3\u5b83\u4eec\u5728 PySide6 / Web \u4e0a\u5982\u4f55\u5177\u4f53\u5b9e\u73b0\u3002</li> <li>Renderer \u53ea\u6d88\u8d39 Ops \u4e0e Timeline\uff0c\u4e0d\u77e5\u9053\u4e5f\u4e0d\u5173\u5fc3 Model \u7684\u5185\u90e8\u903b\u8f91\u3002</li> </ul> <p>\u8be6\u7ec6\u89c4\u8303\u89c1 <code>ops_spec.md</code>\uff0c\u8be5\u6587\u6863\u5b9a\u4e49\u4e86\uff1a</p> <ul> <li>Timeline \u4e0e Step \u7684\u5b8c\u6574 JSON \u7ed3\u6784</li> <li>\u6807\u51c6 Op \u96c6\u5408\uff08v0.1\uff09\uff1a<code>CREATE_NODE</code>\u3001<code>DELETE_NODE</code>\u3001<code>CREATE_EDGE</code>\u3001<code>DELETE_EDGE</code>\u3001<code>SET_POS</code>\u3001<code>SET_STATE</code>\u3001<code>SET_LABEL</code> \u7b49</li> <li>Op \u7684\u53c2\u6570\u683c\u5f0f\u4e0e\u8bed\u4e49</li> <li>\u5bf9\u8c61 ID \u7ea6\u5b9a\u4e0e\u6837\u5f0f\u6620\u5c04</li> </ul>"},{"location":"design/architecture/#72-renderer","title":"7.2 Renderer \u63a5\u53e3\u4e0e\u804c\u8d23","text":"<p>\u6838\u5fc3\u63a5\u53e3\uff1a</p> <p>Renderer \u63a5\u6536\u4e00\u4e2a Timeline\uff08\u7531\u82e5\u5e72 AnimationStep \u7ec4\u6210\uff09\uff0c\u5e76\u8d1f\u8d23\u5c06\u5176\u64ad\u653e\u4e3a\u53ef\u89c6\u5316\u52a8\u753b\u3002\u4f8b\u5982:</p> <ul> <li><code>render(self, timeline: Timeline) -&gt; None:</code></li> </ul> <p>\u6838\u5fc3\u804c\u8d23\uff1a</p> <ol> <li>\u7ef4\u62a4\u53ef\u89c6\u72b6\u6001\uff1a</li> <li>\u5f53\u524d\u6240\u6709\u53ef\u89c1\u7684 Node\u3001Edge \u53ca\u5176\u5c5e\u6027\uff08\u4f4d\u7f6e\u3001\u6837\u5f0f\u3001\u6807\u7b7e\u7b49\uff09</li> <li> <p>\u5168\u5c40\u6d88\u606f\u6216\u63d0\u793a</p> </li> <li> <p>\u6b65\u8fdb\u5f0f\u64ad\u653e\uff1a</p> </li> <li>\u5bf9\u4e8e\u6bcf\u4e2a Step\uff0c\u4ece\u524d\u4e00\u72b6\u6001\u4f5c\u4e3a\u8d77\u70b9</li> <li>\u5e94\u7528\u672c Step \u7684\u6240\u6709 Ops\uff0c\u8ba1\u7b97\u7ec8\u6001</li> <li>\u5728 <code>duration_ms</code> \u5185\uff0c\u4ece\u8d77\u70b9\u63d2\u503c\u5230\u7ec8\u6001\uff08\u652f\u6301\u5e73\u6ed1\u8fc7\u6e21\uff09</li> <li> <p>Step \u7ed3\u675f\u65f6\u7684\u72b6\u6001\u6210\u4e3a\u4e0b\u4e00 Step \u7684\u8d77\u70b9</p> </li> <li> <p>Ops \u89e3\u91ca\uff1a</p> </li> <li>\u6839\u636e Op \u7c7b\u578b\uff08CREATE_NODE / SET_POS / SET_STATE \u7b49\uff09\u66f4\u65b0\u53ef\u89c6\u72b6\u6001</li> <li> <p>\u5177\u4f53\u6e32\u67d3\u7ec6\u8282\uff08\u989c\u8272\u3001\u5f62\u72b6\u3001\u5b57\u4f53\u7b49\uff09\u7531 Renderer \u81ea\u884c\u51b3\u5b9a</p> </li> <li> <p>\u4e0d\u5173\u5fc3\uff1a</p> </li> <li>\u6570\u636e\u7ed3\u6784\u6a21\u578b\u7684\u5185\u90e8\u903b\u8f91</li> <li>\u5982\u4f55\u751f\u6210\u8fd9\u4e9b Ops\uff08\u90a3\u662f Model \u548c SceneGraph \u7684\u804c\u8d23\uff09</li> </ol> <p>\u5177\u4f53\u5b9e\u73b0\uff1a</p> <ul> <li><code>renderers/pyside6/</code>\uff1a</li> <li>\u4f7f\u7528 QGraphicsScene/QGraphicsView</li> <li>\u5c06 Node \u6620\u5c04\u5230 QGraphicsItem</li> <li> <p>\u4f7f\u7528 QPropertyAnimation \u5b9e\u73b0\u8fc7\u6e21\u52a8\u753b</p> </li> <li> <p>\u672a\u6765 <code>renderers/web/</code>\uff1a</p> </li> <li>\u4f7f\u7528 Canvas/WebGL</li> <li>\u5b9e\u73b0\u76f8\u540c\u7684 Timeline \u64ad\u653e\u534f\u8bae</li> </ul>"},{"location":"design/architecture/#8","title":"8. \u4f9d\u8d56\u65b9\u5411\u4e0e\u67b6\u6784\u7ea6\u675f","text":""},{"location":"design/architecture/#81-data-flow","title":"8.1 \u4f9d\u8d56\u65b9\u5411\uff08Data Flow\uff09","text":"<p>\u4ee3\u7801\u7684\u4f9d\u8d56\u5e94\u8be5\u4e25\u683c\u9075\u5faa\u4ece\u4e0a\u5230\u4e0b\u7684\u5355\u5411\u6d41\u5411\uff1a</p> <pre><code>UI / DSL / Persistence\n        \u2193\n    SceneGraph\n        \u2193\n     Models (\u751f\u6210\u7ed3\u6784 Ops)\n        \u2193\n     Layout (\u6ce8\u5165\u5750\u6807 Ops)\n        \u2193\n    Renderer (\u6d88\u8d39 Ops)\n</code></pre> <p>\u53cd\u5411\u4f9d\u8d56\uff08\u5411\u4e0a\u4f9d\u8d56\uff09\u662f\u7edd\u5bf9\u7981\u6b62\u7684\u3002</p>"},{"location":"design/architecture/#82","title":"8.2 \u5177\u4f53\u7ea6\u675f\u89c4\u5219","text":"\u5c42\u7ea7 \u5141\u8bb8\u4f9d\u8d56 \u7981\u6b62\u4f9d\u8d56 Models \u65e0\uff08\u4ec5\u5185\u90e8\uff09 Renderer, UI, DSL, Layout, SceneGraph Layout core.models\uff08\u7ed3\u6784\u7406\u89e3\uff09, core.ops Renderer, UI, DSL, SceneGraph Renderer core.ops Models\uff08\u5185\u90e8\u5b9e\u73b0\uff09, UI, DSL, SceneGraph SceneGraph core.models, core.layout, core.ops Renderer, UI, DSL\uff08\u53cd\u5411\uff09 UI core.scene\uff08\u901a\u8fc7 Command\uff09, renderers core.models \u5185\u90e8\u7ec6\u8282 DSL core.scene.Command Models, Renderer, UI\uff08\u5185\u90e8\u7ec6\u8282\uff09 Persistence core.scene\uff08\u5bfc\u51fa/\u5bfc\u5165\uff09 Models \u5185\u90e8"},{"location":"design/architecture/#83","title":"8.3 \u8fdd\u89c4\u5904\u7406","text":"<p>\u82e5\u9700\u8981\u6253\u7834\u4e0a\u8ff0\u89c4\u5219\uff08\u5982\u5faa\u73af\u4f9d\u8d56\u3001\u8de8\u5c42\u8026\u5408\uff09\uff0c\u5fc5\u987b\uff1a</p> <ol> <li>\u5728 PR \u4e2d\u660e\u786e\u8bf4\u660e\u539f\u56e0</li> <li>\u66f4\u65b0\u672c\u6587\u6863\u89e3\u91ca\u4f8b\u5916\u60c5\u51b5  </li> <li>\u901a\u8fc7\u4ee3\u7801\u5ba1\u67e5</li> <li>\u8003\u8651\u662f\u5426\u9700\u8981\u91cd\u6784\u6765\u6d88\u9664\u8026\u5408</li> </ol>"},{"location":"design/architecture/#9","title":"9. \u5f53\u524d\u9636\u6bb5\u7684\u5b9e\u73b0\u4f18\u5148\u7ea7","text":"<p>\u6309\u4f18\u5148\u7ea7\u6392\u5e8f\uff1a</p> <ol> <li>\u6587\u6863\u4e0e\u63a5\u53e3\u8bbe\u8ba1\uff08\u672c\u6587\u4ef6 + requirements + environment + animation\uff09\u3002</li> <li><code>core.scene</code> \u4e2d <code>Command</code> \u4e0e <code>SceneGraph</code> \u7684\u63a5\u53e3\u5b9a\u4e49\uff08\u53ef\u5148\u4e3a\u7a7a\u5b9e\u73b0\uff09\u3002</li> <li><code>core.ops</code> \u4e2d AnimationOps \u7c7b\u578b\u9aa8\u67b6\u4e0e Timeline \u63a5\u53e3\u3002</li> <li>\u4e00\u4e2a\u6700\u5c0f\u7684 PySide6 Renderer \u4e0e\u7a7a\u7a97\u53e3 UI\uff08\u7528\u4e8e\u9a8c\u8bc1\u73af\u5883\u4e0e\u4f9d\u8d56\u65e0\u8bef\uff09\u3002</li> </ol>"},{"location":"design/dsl/","title":"DSL \u8bbe\u8ba1\u8bf4\u660e","text":"<p>\u672c\u6587\u4ef6\u63cf\u8ff0\u5f53\u524d\u9636\u6bb5\u7684 DSL \u8bed\u6cd5\u8bbe\u8ba1\u3001\u89e3\u6790\u903b\u8f91\u4e0e\u4ea4\u4e92\u652f\u6301\u3002</p>"},{"location":"design/dsl/#1","title":"1. \u76ee\u6807\u4e0e\u8303\u56f4","text":"<ul> <li>\u76ee\u6807\uff1a\u63d0\u4f9b\u4ece\u6587\u672c\u8f93\u5165\u5230 <code>Command</code> \u5e8f\u5217\u7684\u95ed\u73af\uff0c\u652f\u6301\u81ea\u7136\u6307\u4ee4\u64cd\u63a7\u6570\u636e\u7ed3\u6784\u3002</li> <li>\u8303\u56f4\uff1a<code>parse_dsl</code>\uff08\u652f\u6301\u6587\u672c\u8bed\u6cd5\u4e0e JSON\uff09\u3001<code>run_commands</code>\u3001UI \u4ea4\u4e92\u5f0f\u6ce8\u5165\u3001\u6ce8\u91ca\u4e0e\u591a\u884c\u652f\u6301\u3002</li> <li>\u7279\u8272\uff1a\u652f\u6301 Late-binding \u7c7b\u578b\u63a8\u65ad\uff0c\u5141\u8bb8 DSL \u64cd\u4f5c UI \u521b\u5efa\u7684\u7ed3\u6784\u3002</li> </ul>"},{"location":"design/dsl/#2-v02","title":"2. \u8bed\u6cd5\u89c4\u8303 (v0.2)","text":""},{"location":"design/dsl/#21","title":"2.1 \u57fa\u7840\u683c\u5f0f","text":"<ul> <li>\u8bed\u53e5\u4ee5 <code>;</code> \u6216\u6362\u884c\u7b26\u5206\u9694\u3002</li> <li>\u652f\u6301 <code>#</code> \u5f00\u5934\u7684\u5355\u884c\u6ce8\u91ca\u3002</li> <li>\u5b57\u7b26\u4e32\u4f7f\u7528\u53cc\u5f15\u53f7 <code>\"</code>\u3002</li> </ul>"},{"location":"design/dsl/#22-assignment","title":"2.2 \u7ed3\u6784\u521b\u5efa (Assignment)","text":"<p>\u683c\u5f0f\uff1a<code>&lt;kind&gt; &lt;id&gt; [= [values...]]</code> - \u793a\u4f8b\uff1a<code>list L1 = [1, 2, 3]</code> - \u793a\u4f8b\uff1a<code>bst B1</code> (\u521b\u5efa\u7a7a\u6811) - \u652f\u6301\u8de8\u884c\u5217\u8868\uff1a   <pre><code>list L1 = [\n  1,\n  2\n]\n</code></pre></p>"},{"location":"design/dsl/#23-command","title":"2.3 \u7ed3\u6784\u64cd\u4f5c (Command)","text":"<p>\u683c\u5f0f\uff1a<code>&lt;op&gt; &lt;id&gt; [args...]</code> - \u63d2\u5165\uff1a<code>insert &lt;id&gt; &lt;index?&gt; &lt;value?&gt;</code> (\u5982 <code>insert L1 1 99</code>) - \u5220\u9664\uff1a<code>delete &lt;id&gt; &lt;index?&gt;</code> \u6216 <code>delete &lt;id&gt; val=&lt;value&gt;</code> - \u641c\u7d22\uff1a<code>search &lt;id&gt; &lt;value&gt;</code> - \u6808\u64cd\u4f5c\uff1a<code>push &lt;id&gt; &lt;value&gt;</code> / <code>pop &lt;id&gt;</code> - Git \u64cd\u4f5c\uff1a<code>git &lt;id&gt; init</code> / <code>commit &lt;id&gt; \"msg\"</code> / <code>checkout &lt;id&gt; main</code></p>"},{"location":"design/dsl/#3","title":"3. \u6838\u5fc3\u7279\u6027","text":""},{"location":"design/dsl/#31-late-binding","title":"3.1 \u4e0a\u4e0b\u6587\u611f\u77e5\u4e0e Late-binding","text":"<ul> <li>\u89e3\u6790\u65f6\u63a8\u65ad\uff1a<code>parse_dsl</code> \u63a5\u53d7 <code>existing_kinds</code> \u53c2\u6570\u3002\u5982\u679c\u5728\u540c\u4e00\u811a\u672c\u4e2d\u5148\u521b\u5efa\u4e86 <code>list L1</code>\uff0c\u540e\u7eed\u7684 <code>insert L1</code> \u4f1a\u81ea\u52a8\u8bc6\u522b <code>L1</code> \u4e3a <code>list</code> \u7c7b\u578b\u3002</li> <li>\u8fd0\u884c\u65f6\u63a8\u65ad\uff1a\u5982\u679c DSL \u4e2d\u672a\u6307\u5b9a\u7c7b\u578b\u4e14\u89e3\u6790\u5668\u65e0\u6cd5\u63a8\u65ad\uff08\u4f8b\u5982\u64cd\u4f5c UI \u9884\u5148\u521b\u5efa\u7684\u7ed3\u6784\uff09\uff0c<code>SceneGraph</code> \u4f1a\u5728\u6267\u884c\u65f6\u6839\u636e <code>structure_id</code> \u81ea\u52a8\u8865\u5168 <code>kind</code>\u3002</li> </ul>"},{"location":"design/dsl/#32","title":"3.2 \u9c81\u68d2\u7684\u8bcd\u6cd5\u5206\u6790","text":"<ul> <li>\u81ea\u52a8\u5904\u7406 <code>L1=[1,2]</code>\uff08\u65e0\u7a7a\u683c\u8d4b\u503c\uff09\u7b49\u7d27\u51d1\u5199\u6cd5\u3002</li> <li>\u4fdd\u6301 <code>[...]</code> \u5185\u90e8\u7684\u5b8c\u6574\u6027\uff0c\u4e0d\u53d7\u7a7a\u683c\u5f71\u54cd\u3002</li> </ul>"},{"location":"design/dsl/#4","title":"4. \u4ea4\u4e92\u5165\u53e3","text":"<ul> <li>Interactive DSL (UI)\uff1a\u63a7\u5236\u9762\u677f\u65b0\u589e\u6309\u94ae\uff0c\u652f\u6301\u5728\u5f53\u524d\u573a\u666f\u6ce8\u5165\u6307\u4ee4\u3002</li> <li>Dev Hook\uff1aMainWindow \u83dc\u5355\u652f\u6301\u6279\u91cf\u6267\u884c DSL \u811a\u672c\u3002</li> <li>CLI\uff1a\u652f\u6301\u901a\u8fc7\u547d\u4ee4\u884c\u6267\u884c DSL \u6587\u4ef6\u3002</li> </ul>"},{"location":"design/dsl/#5","title":"5. \u5173\u8054\u6587\u4ef6","text":"<ul> <li><code>src/ds_vis/dsl/parser.py</code>\uff1a\u6838\u5fc3\u89e3\u6790\u5668\u3002</li> <li><code>src/ds_vis/core/scene/scene_graph.py</code>\uff1a\u5904\u7406 Late-binding \u903b\u8f91\u3002</li> <li><code>src/ds_vis/ui/main_window.py</code>\uff1aUI \u4ea4\u4e92\u5b9e\u73b0\u3002</li> </ul>"},{"location":"design/json/","title":"JSON \u6301\u4e45\u5316\u534f\u8bae","text":"<p>\u672c\u6587\u4ef6\u8bf4\u660e\u5f53\u524d\u9636\u6bb5\u7684\u573a\u666f\u7ea7 JSON \u5e8f\u5217\u5316\u534f\u8bae\u3001\u9a8c\u8bc1\u89c4\u5219\u4e0e\u5e03\u5c40\u5904\u7406\u3002</p>"},{"location":"design/json/#1-v04","title":"1. \u573a\u666f\u7ea7\u6301\u4e45\u5316 (v0.4)","text":"<p>\u4e0d\u540c\u4e8e\u65e9\u671f\u7684\u5355\u6761\u547d\u4ee4\u5e8f\u5217\u5316\uff0c\u73b0\u5728\u7684\u6301\u4e45\u5316\u5173\u6ce8\u573a\u666f\u72b6\u6001\u3002 - \u5bfc\u51fa\uff1a\u5c06\u5f53\u524d\u573a\u666f\u4e2d\u6240\u6709\u7ed3\u6784\u7684\u521b\u5efa\u6307\u4ee4\u53ca\u540e\u7eed\u64cd\u4f5c\u5e8f\u5217\u5316\u4e3a JSON\u3002 - \u5bfc\u5165\uff1a\u6e05\u7a7a\u5f53\u524d\u573a\u666f\uff0c\u5e76\u6309 JSON \u4e2d\u7684\u6307\u4ee4\u5e8f\u5217\u91cd\u5efa\u6240\u6709\u7ed3\u6784\u3002</p>"},{"location":"design/json/#2","title":"2. \u6570\u636e\u683c\u5f0f","text":"<p>\u5916\u5c42\u4e3a JSON \u6570\u7ec4\uff0c\u6bcf\u4e2a\u5143\u7d20\u8868\u793a\u4e00\u6761 <code>Command</code>\u3002 <pre><code>[\n  {\n    \"structure_id\": \"L1\",\n    \"type\": \"CREATE_STRUCTURE\",\n    \"payload\": {\n      \"kind\": \"list\",\n      \"values\": [1, 2]\n    }\n  },\n  {\n    \"structure_id\": \"L1\",\n    \"type\": \"INSERT\",\n    \"payload\": {\n      \"kind\": \"list\",\n      \"index\": 1,\n      \"value\": 3\n    }\n  }\n]\n</code></pre></p>"},{"location":"design/json/#3","title":"3. \u5e03\u5c40\u9694\u79bb\u4e0e\u8fc7\u6ee4","text":"<p>\u5728\u5bfc\u5165\u5bfc\u51fa\u8fc7\u7a0b\u4e2d\uff0c\u7cfb\u7edf\u4f1a\u81ea\u52a8\u5904\u7406\u4e0d\u540c\u7ed3\u6784\u95f4\u7684\u5e03\u5c40\u5e72\u6270\uff1a - \u8fc7\u6ee4\u673a\u5236\uff1a\u5bfc\u51fa\u65f6\u4f1a\u6839\u636e\u7ed3\u6784\u7c7b\u578b\uff08\u5982 Git\u3001Huffman\uff09\u8fc7\u6ee4\u6389\u4e0d\u5c5e\u4e8e\u8be5\u7ed3\u6784\u7684\u5e03\u5c40\u6307\u4ee4\uff0c\u786e\u4fdd\u91cd\u65b0\u52a0\u8f7d\u540e\u5e03\u5c40\u4f9d\u7136\u6b63\u786e\u3002 - \u5750\u6807\u6062\u590d\uff1a<code>CREATE_STRUCTURE</code> \u8d1f\u8f7d\u4e2d\u53ef\u5305\u542b\u521d\u59cb\u72b6\u6001\uff0c\u540e\u7eed\u901a\u8fc7 <code>SET_POS</code> \u7b49 Ops \u6062\u590d\u89c6\u89c9\u4f4d\u7f6e\u3002</p>"},{"location":"design/json/#4","title":"4. \u6821\u9a8c\u89c4\u5219","text":"<ul> <li>\u89e3\u6790\u7531 <code>persistence/json_io.commands_from_json</code> \u5b8c\u6210\u3002</li> <li>\u9a8c\u8bc1\uff1a</li> <li><code>structure_id</code>/<code>type</code>/<code>payload</code> \u5fc5\u586b\u3002</li> <li><code>SCHEMA_REGISTRY</code> \u6839\u636e <code>(CommandType, kind)</code> \u6267\u884c\u5b57\u6bb5\u6821\u9a8c\u3002</li> <li>\u5bfc\u5165\u65f6\u5982\u679c\u7f3a\u5c11 <code>kind</code> \u4e14\u7ed3\u6784\u5c1a\u672a\u521b\u5efa\uff0c\u4f1a\u629b\u51fa <code>CommandError</code>\u3002</li> </ul>"},{"location":"design/json/#5-ui","title":"5. UI \u96c6\u6210","text":"<ul> <li>File -&gt; Import Scene\uff1a\u4ece\u6587\u4ef6\u52a0\u8f7d JSON \u5e76\u91cd\u5efa\u573a\u666f\u3002</li> <li>File -&gt; Export Scene\uff1a\u5c06\u5f53\u524d\u573a\u666f\u72b6\u6001\u4fdd\u5b58\u4e3a JSON \u6587\u4ef6\u3002</li> </ul>"},{"location":"design/json/#6","title":"6. \u5173\u8054\u6587\u4ef6","text":"<ul> <li><code>src/ds_vis/persistence/json_io.py</code> \u2014 \u6838\u5fc3\u5b9e\u73b0\u3002</li> <li><code>src/ds_vis/ui/main_window.py</code> \u2014 UI \u83dc\u5355\u7ed1\u5b9a\u3002</li> </ul>"},{"location":"design/layout/","title":"LAYOUT \u2014 \u8bbe\u8ba1\u8bf4\u660e\uff08\u8f7b\u91cf\uff09","text":"<p>\u672c\u6587\u4ef6\u63cf\u8ff0 Layout \u7684\u804c\u8d23\u8fb9\u754c\u4e0e\u6269\u5c55\u65b9\u5f0f\uff0c\u907f\u514d\u5b9e\u73b0\u7ec6\u8282\u8026\u5408\u3002</p>"},{"location":"design/layout/#1","title":"1. \u89d2\u8272\u4e0e\u804c\u8d23","text":"<ul> <li>\u7406\u89e3\u7ed3\u6784 Ops \u63a8\u65ad\u62d3\u6251\u4fe1\u606f\u3002</li> <li>\u8ba1\u7b97\u51e0\u4f55\u5e03\u5c40\u5e76\u6ce8\u5165 <code>SET_POS</code>\u3002</li> <li>\u4fdd\u969c\u4e0d\u540c\u7ed3\u6784\u95f4\u7684\u53ef\u89c6\u5206\u5e03\uff08\u5f53\u524d\u4ec5\u7ebf\u6027\u5806\u53e0\uff09\u3002</li> </ul>"},{"location":"design/layout/#2","title":"2. \u8f93\u5165\u8f93\u51fa","text":"<ul> <li>\u8f93\u5165\uff1a\u7ed3\u6784 Ops\uff08Timeline\uff09\u3002</li> <li>\u8f93\u51fa\uff1a\u7ed3\u6784 Ops + <code>SET_POS</code> \u6ce8\u5165\u540e\u7684 Timeline\u3002</li> <li>\u53ef\u9009\uff1a\u63d0\u4f9b <code>reset()</code> / \u91cd\u5efa\u5165\u53e3\u4ee5\u652f\u6301 seek/\u5012\u64ad\u6216\u72b6\u6001\u91cd\u653e\u3002</li> </ul>"},{"location":"design/layout/#3","title":"3. \u7ea6\u675f\u4e0e\u8fb9\u754c","text":"<ul> <li>\u4e0d\u5f97\u4fee\u6539\u7ed3\u6784 Ops\uff08CREATE/DELETE \u7b49\uff09\u3002</li> <li>\u4e0d\u5f97\u4f9d\u8d56 Renderer \u6216 UI\u3002</li> <li>\u4ec5\u6ce8\u5165 <code>SET_POS</code>\u3002</li> <li>\u5e94\u6d88\u8d39 MetricsRegistry\uff08\u6309 <code>kind</code> \u7684\u5c3a\u5bf8/\u95f4\u8ddd\u63d0\u793a\uff09\uff0c\u7f3a\u7701\u65f6\u56de\u9000\u9ed8\u8ba4\u503c\u3002</li> <li>\u5e94\u63d0\u4f9b\u6e05\u7406\u63a5\u53e3 <code>reset()</code>\uff08\u6216\u540c\u7b49\u80fd\u529b\uff09\u4ee5\u4fbf\u573a\u666f\u5207\u6362/\u91cd\u653e\u3002</li> </ul>"},{"location":"design/layout/#4","title":"4. \u63a5\u53e3\u4e0e\u6269\u5c55","text":"<ul> <li>\u63a5\u53e3\uff1a<code>LayoutEngine.apply_layout(timeline) -&gt; Timeline</code>\uff1b\u53ef\u9009 <code>reset()</code> \u6e05\u7406\u5185\u90e8\u72b6\u6001\u3002</li> <li>\u7b56\u7565\uff1a<code>LayoutStrategy</code> \u679a\u4e3e\uff08LINEAR/TREE/DAG\uff09\uff0c\u7528\u4e8e\u4e0a\u5c42\u9009\u62e9\u5e03\u5c40\u5b9e\u73b0\u3002</li> <li>\u517c\u5bb9\uff1a\u9ed8\u8ba4 SimpleLayout \u4f5c\u4e3a LINEAR \u7b56\u7565\u5b9e\u73b0\uff0c\u4fdd\u6301 stateful \u987a\u5e8f\u884c\u4e3a\u3002</li> <li>\u6269\u5c55\uff1aTree/DAG \u5e03\u5c40\u53ef\u4f5c\u4e3a\u5360\u4f4d\u5b9e\u73b0\u63a5\u5165\uff1b\u91cd\u5efa/\u65e0\u72b6\u6001\u6a21\u5f0f\u53ef\u5728\u672a\u6765\u652f\u6301 seek/\u5012\u64ad\u3002</li> </ul>"},{"location":"design/layout/#5-p07","title":"5. \u5f53\u524d\u5b9e\u73b0\uff08P0.7\uff09","text":"<ul> <li>SimpleLayoutEngine (LINEAR)\uff1astateful \u987a\u5e8f\u5f15\u64ce\uff0c\u56fa\u5b9a\u5c3a\u5bf8\u4e0e\u5de6\u5bf9\u9f50\uff0c\u6309\u7ed3\u6784\u884c\u5806\u53e0\uff1b\u65e0 seek/\u5012\u64ad\u3002</li> <li>TreeLayoutEngine (\u5360\u4f4d TREE)\uff1a\u57fa\u4e8e CREATE_EDGE \u7684\u7236\u5b50\u5173\u7cfb\uff0c\u4e2d\u5e8f\u904d\u5386\u7f16\u53f7\uff0c\u6c34\u5e73\u7b49\u8ddd\u3001\u7eb5\u5411\u5206\u5c42\uff1b\u7528\u4e8e\u6811\u6a21\u578b\u5192\u70df\uff08kind=bst/tree \u9884\u7559\uff09\u3002</li> <li>GitLayoutEngine (DAG \u5360\u4f4d)\uff1a\u6309 commit \u521b\u5efa\u987a\u5e8f\u7eb5\u5411\u6392\u5e03\uff08\u5355\u5217 lane\uff09\uff0c\u6d88\u8d39 <code>SET_LABEL.attach_to</code> \u5c06 HEAD/branch label \u7ed1\u5b9a\u5230\u76ee\u6807 commit \u4e4b\u4e0a\u5e76\u5806\u53e0\uff1b\u4ec5\u6ce8\u5165 SET_POS\uff0c\u4fdd\u6301\u7ed3\u6784 Ops \u4e0d\u53d8\u3002</li> <li>SceneGraph \u8def\u7531\u4e0e\u5206\u533a\uff1akind\u2192LayoutStrategy\uff08list/seqlist/stack\u2192LINEAR\uff0cbst/huffman\u2192TREE\uff0cgit\u2192DAG\uff09\uff0c\u6bcf\u4e2a\u7ed3\u6784\u5206\u914d <code>(dx, dy)</code> \u504f\u79fb\uff08\u6309\u7b56\u7565\u5206\u7ec4\u3001\u884c\u7d2f\u52a0\uff1bDAG \u5177\u5907\u6a2a\u5411 lane \u504f\u79fb\uff09\u6ce8\u5165 LayoutEngine\uff0c\u907f\u514d\u591a\u7ed3\u6784\u91cd\u53e0\uff1b\u504f\u79fb\u4e3a\u5360\u4f4d\u53c2\u6570\uff0c\u53ef\u540e\u7eed\u66ff\u6362\u4e3a\u914d\u7f6e\u5316/\u5206\u533a\u7b97\u6cd5\u3002list \u95f4\u8ddd 120\uff0cseqlist \u95f4\u8ddd 80\uff08\u77e9\u5f62\u5355\u5143\uff09\uff0cstack \u95f4\u8ddd 80\uff08\u7ad6\u5411\uff09\uff0chuffman \u961f\u5217\u95f4\u8ddd\u9ed8\u8ba4 80\u3002</li> <li>Per-kind \u5e03\u5c40\u914d\u7f6e\uff1aLINEAR \u5f15\u64ce\u652f\u6301\u6309\u7ed3\u6784\u6ce8\u5165 orientation/spacing/row_spacing/start_x/start_y\uff08stack \u9ed8\u8ba4 vertical\uff1blist/seqlist \u9ed8\u8ba4 horizontal\uff09\uff1b\u6876\u5bb9\u5668\uff08bucket\uff09\u901a\u8fc7 SET_POS \u5355\u72ec\u5b9a\u4f4d\uff0cvertical \u65f6\u4ee5\u8282\u70b9 bbox \u7eb5\u5411\u5c45\u4e2d\u3002TreeLayout \u652f\u6301 <code>queue_spacing/queue_start_y/tree_offset_y/tree_span</code>\uff08Huffman \u53cc\u533a\u5e03\u5c40\uff1a\u961f\u5217\u6839\u5728\u4e0a\u65b9\u6a2a\u6392\uff0c\u5b50\u6811\u6cbf <code>tree_offset_y</code> \u5411\u4e0b\u5c55\u5f00\uff09\u3002</li> </ul>"},{"location":"design/layout/#6-p08","title":"6. \u5373\u5c06\u6269\u5c55\u7684\u5e03\u5c40\u9700\u6c42\uff08P0.8 \u8ba1\u5212\uff09","text":"<ul> <li>\u987a\u5e8f\u8868\uff08seqlist\uff09/\u6808\uff08stack\uff09\uff1a\u5df2\u5177\u5907\u6876\u5bb9\u5668 + \u77e9\u5f62\u5355\u5143\u5b9a\u4f4d\uff1b\u540e\u7eed\u9700\u652f\u6301\u81ea\u52a8\u5c3a\u5bf8\u63a8\u5bfc\u3001\u5bb9\u5668 label/\u6307\u9488\u7b49\u589e\u5f3a\u3002</li> <li>Huffman \u6784\u5efa\uff1a\u53cc\u533a\u57df\u5e03\u5c40\uff08\u961f\u5217\u6a2a\u6392 + \u6811\u5411\u4e0b\u5c55\u5f00\uff09\u5df2\u521d\u7248\u652f\u6301\uff0c\u961f\u5217\u6839\u8282\u70b9\u6309 <code>queue_index</code> \u6392\u5e8f\u5b9a\u4f4d\uff0c\u5b50\u6811\u4ece\u6839\u5411\u4e0b\u504f\u79fb\uff1b\u540e\u7eed\u53ef\u7ec6\u5316\u5b50\u6811\u6c34\u5e73\u538b\u7f29\u4e0e\u52a8\u6001\u961f\u5217\u5c3a\u5bf8\u3002</li> <li>Git DAG\uff1a\u7eb5\u5411 lane \u5360\u4f4d\u5e03\u5c40\uff08\u591a\u5217\u6216\u5355\u5217\uff09\uff0c\u8282\u70b9\u5c0f\u5706\u70b9+\u6807\u7b7e\uff0c\u6309\u65f6\u95f4/\u5e8f\u53f7\u9012\u589e\u504f\u79fb\uff1b\u5206\u652f/merge \u9700\u8981\u6a2a\u5411\u79fb\u4f4d\u6216\u5e73\u884c lane\u3002</li> <li>\u591a\u7ed3\u6784\u5206\u533a\uff1aSceneGraph \u9700\u6839\u636e kind \u5212\u5206\u533a\u57df\u5e76\u4f20\u9012 <code>(dx, dy)</code>\uff0c\u907f\u514d\u77e9\u5f62\u6876\u4e0e\u6811/DAG \u91cd\u53e0\uff1b\u504f\u79fb\u5e94\u914d\u7f6e\u5316\u800c\u975e\u9b54\u6570\u3002</li> </ul> <p>\u4e0a\u8ff0\u9700\u6c42\u5e94\u901a\u8fc7 LayoutStrategy \u6269\u5c55\u6216\u53c2\u6570\u5316\u5b9e\u73b0\uff0c\u4fdd\u6301\u201c\u4ec5\u6ce8\u5165 SET_POS\u201d\uff0c\u4e0d\u5f97\u8026\u5408 Renderer \u7ec6\u8282\u3002</p>"},{"location":"design/layout/#7","title":"7. \u5f53\u524d\u9650\u5236","text":"<ul> <li>SimpleLayout \u4e3a stateful \u987a\u5e8f\u5f15\u64ce\uff0c\u56fa\u5b9a\u5c3a\u5bf8\u4e0e\u5de6\u5bf9\u9f50\uff1b\u4e0d\u652f\u6301 seek/\u5012\u64ad\u3002</li> <li>\u591a\u7ed3\u6784\u51b2\u7a81\u5904\u7406\u6709\u9650\uff1a\u6811/\u7ebf\u6027\u6df7\u6392\u53ef\u80fd\u62e5\u6324\uff1b\u65e0\u81ea\u52a8\u5206\u533a\u3002</li> <li>\u5206\u533a/\u504f\u79fb\u4e3a\u56fa\u5b9a\u5e38\u91cf\uff0c\u672a\u66b4\u9732\u914d\u7f6e\uff1b\u672a\u6765\u9700\u6839\u636e\u7ed3\u6784\u5c3a\u5bf8/\u5e03\u5c40\u7b56\u7565\u81ea\u52a8\u5206\u914d\u3002</li> <li>\u65e0 seek/\u5012\u64ad/\u91cd\u5efa\uff1b\u5e03\u5c40\u72b6\u6001\u4f9d\u8d56\u987a\u5e8f\u6267\u884c\u3002</li> <li>\u6811\u5e03\u5c40\u4e3a\u5360\u4f4d\u7b97\u6cd5\uff0c\u65e0\u5e73\u8861/\u91cd\u6392\u52a8\u753b\uff0c\u590d\u6742\u6811\uff08\u65cb\u8f6c\u7b49\uff09\u53ef\u80fd\u9700\u8981\u66f4\u7cbe\u7ec6\u7b97\u6cd5\u3002</li> </ul> <p>\u4ea4\u53c9\u5f15\u7528\uff1aOps \u8bed\u4e49\u89c1 <code>ops_spec.md</code>\uff0cStyle/Metrics \u7ea6\u675f\u89c1 <code>architecture.md</code> \u7b2c 7 \u8282\u3002</p>"},{"location":"design/layout_v2/","title":"LAYOUT V2 \u2014 \u62d3\u6251\u611f\u77e5\u4e0e\u65e0\u72b6\u6001\u5e03\u5c40\u91cd\u6784","text":""},{"location":"design/layout_v2/#1","title":"1. \u80cc\u666f\u4e0e\u52a8\u673a","text":"<p>\u5f53\u524d P0.7 \u7684\u5e03\u5c40\u5f15\u64ce\uff08Layout Engine\uff09\u5b58\u5728\u4ee5\u4e0b\u6838\u5fc3\u7f3a\u9677\uff1a - \u4fe1\u606f\u964d\u7ea7\uff1a\u901a\u8fc7\u89e3\u6790\u6307\u4ee4\u6d41\uff08Ops Sniffing\uff09\u9006\u5411\u63a8\u65ad\u62d3\u6251\uff0c\u8106\u5f31\u4e14\u4f4e\u6548\u3002 - \u72b6\u6001\u8026\u5408\uff1a\u5f15\u64ce\u5185\u90e8\u7ef4\u62a4\u72b6\u6001\uff0c\u4e0d\u652f\u6301 seek\u3001\u5012\u64ad\u6216\u4efb\u610f\u65f6\u523b\u7684\u91cd\u6392\u3002 - \u7b97\u6cd5\u7b80\u964b\uff1a\u6811\u5e03\u5c40\u91c7\u7528\u56fa\u5b9a\u5bbd\u5ea6\u5e73\u5206\u6cd5\uff0c\u5bfc\u81f4\u6df1\u5ea6\u589e\u52a0\u65f6\u8282\u70b9\u91cd\u53e0\u3002 - \u4e2a\u6027\u5316\u4e0d\u8db3\uff1a\u96be\u4ee5\u652f\u6301 Huffman\uff08\u53cc\u533a\uff09\u3001Git\uff08\u591a Lane\uff09\u7b49\u590d\u6742\u7ed3\u6784\u7684\u4e2a\u6027\u5316\u9700\u6c42\u3002</p>"},{"location":"design/layout_v2/#2","title":"2. \u6838\u5fc3\u8bbe\u8ba1\u539f\u5219","text":"<ul> <li>\u62d3\u6251\u611f\u77e5 (Topology-Aware)\uff1aLayout \u76f4\u63a5\u8bbf\u95ee Model \u7684\u903b\u8f91\u7ed3\u6784\uff0c\u800c\u975e\u731c\u6307\u4ee4\u3002</li> <li>\u65e0\u72b6\u6001\u8ba1\u7b97 (Stateless Calculation)\uff1a\u5e03\u5c40\u8ba1\u7b97\u5e94\u4e3a\u7eaf\u51fd\u6570 <code>f(Snapshot) -&gt; Positions</code>\u3002</li> <li>\u58f0\u660e\u5f0f\u63d0\u793a (Layout Hints)\uff1aModel \u901a\u8fc7 Ops \u643a\u5e26\u5e03\u5c40\u63d0\u793a\uff0c\u5f15\u5bfc\u5f15\u64ce\u51b3\u7b56\u3002</li> <li>\u7b97\u6cd5\u5347\u7ea7\uff1a\u5f15\u5165 Buchheim / Reingold-Tilford \u7b49\u4e13\u4e1a\u6811\u5e03\u5c40\u7b97\u6cd5\u3002</li> </ul>"},{"location":"design/layout_v2/#3","title":"3. \u67b6\u6784\u7ec4\u4ef6","text":""},{"location":"design/layout_v2/#31-layoutable","title":"3.1 <code>Layoutable</code> \u534f\u8bae","text":"<p>Model \u9700\u5b9e\u73b0\u6b64\u534f\u8bae\u4ee5\u66b4\u9732\u62d3\u6251\u4fe1\u606f\uff1a <pre><code>class Layoutable(Protocol):\n    def get_topology_snapshot(self) -&gt; TopologySnapshot:\n        ...\n</code></pre> <code>TopologySnapshot</code> \u5305\u542b\uff1a - \u8282\u70b9\u5217\u8868\u53ca\u5176\u5c5e\u6027\uff08kind, label, hints\uff09\u3002 - \u8fb9\u5217\u8868\uff08src, dst, type\uff09\u3002 - \u5bb9\u5668\u5173\u7cfb\uff08parent_container, children\uff09\u3002</p>"},{"location":"design/layout_v2/#32-layoutengine-v2","title":"3.2 <code>LayoutEngine V2</code>","text":"<p>\u63a5\u53e3\u53d8\u66f4\uff1a <pre><code>class LayoutEngineV2(Protocol):\n    def compute_layout(self, snapshot: TopologySnapshot, config: LayoutConfig) -&gt; Dict[str, Tuple[float, float]]:\n        ...\n</code></pre></p>"},{"location":"design/layout_v2/#33-scenegraph","title":"3.3 <code>SceneGraph</code> \u534f\u8c03\u5668","text":"<ul> <li>\u8d1f\u8d23\u4ece Model \u83b7\u53d6 Snapshot\u3002</li> <li>\u8c03\u7528\u5bf9\u5e94\u7684 <code>LayoutEngine</code> \u8ba1\u7b97\u5750\u6807\u3002</li> <li>\u5bf9\u6bd4\u65b0\u65e7\u5750\u6807\uff0c\u81ea\u52a8\u751f\u6210 <code>SET_POS</code> \u6307\u4ee4\u5e76\u6ce8\u5165 <code>Timeline</code>\u3002</li> </ul>"},{"location":"design/layout_v2/#4-buchheim","title":"4. \u5173\u952e\u7b97\u6cd5\uff1aBuchheim \u6811\u5e03\u5c40","text":"<p>\u9488\u5bf9\u6811\u7ed3\u6784\u91cd\u53e0\u95ee\u9898\uff0c\u5f15\u5165 Buchheim \u7b97\u6cd5\uff1a - \u7b2c\u4e00\u904d\u904d\u5386\uff1a\u521d\u6b65\u5206\u914d\u76f8\u5bf9\u5750\u6807\uff0c\u5904\u7406\u5b50\u6811\u95f4\u7684\u95f4\u8ddd\uff08Modifier\uff09\u3002 - \u7b2c\u4e8c\u904d\u904d\u5386\uff1a\u7d2f\u52a0 Modifier\uff0c\u8ba1\u7b97\u7edd\u5bf9\u5750\u6807\u3002 - \u4f18\u52bf\uff1a\u8282\u70b9\u95f4\u8ddd\u6700\u5c0f\u5316\uff0c\u7edd\u4e0d\u91cd\u53e0\uff0c\u652f\u6301\u53d8\u5bbd\u8282\u70b9\u3002</p>"},{"location":"design/layout_v2/#5-huffmangit","title":"5. \u6df7\u5408\u5e03\u5c40\u652f\u6301 (Huffman/Git)","text":"<ul> <li>Zone-based Layout\uff1a\u652f\u6301\u5c06\u753b\u5e03\u5212\u5206\u4e3a\u591a\u4e2a\u533a\u57df\uff08\u5982 Huffman \u7684 Queue \u533a\u548c Tree \u533a\uff09\u3002</li> <li>Lane-based Layout\uff1aGit \u4e13\u7528\uff0c\u652f\u6301\u591a\u5206\u652f\u5e76\u884c Lane \u5e03\u5c40\u3002</li> </ul>"},{"location":"design/layout_v2/#6","title":"6. \u8fc1\u79fb\u8def\u5f84","text":"<ol> <li>\u5b9a\u4e49 <code>Layoutable</code> \u548c <code>TopologySnapshot</code>\u3002</li> <li>\u91cd\u6784 <code>BaseModel</code> \u548c\u73b0\u6709\u6a21\u578b\u4ee5\u652f\u6301 <code>Layoutable</code>\u3002</li> <li>\u5b9e\u73b0 <code>StatelessLayoutManager</code> \u66ff\u4ee3\u73b0\u6709\u7684 <code>apply_layout</code> \u903b\u8f91\u3002</li> <li>\u9010\u6b65\u66ff\u6362 <code>TreeLayoutEngine</code> \u4e3a Buchheim \u5b9e\u73b0\u3002</li> </ol>"},{"location":"design/layout_v2/#7","title":"7. \u9884\u671f\u6548\u679c","text":"<ul> <li>\u5f7b\u5e95\u89e3\u51b3\u6811\u8282\u70b9\u91cd\u53e0\u95ee\u9898\u3002</li> <li>\u5929\u7136\u652f\u6301\u52a8\u753b\u56de\u653e\u3001\u8df3\u8f6c\uff08Seek\uff09\u3002</li> <li>\u6781\u5927\u7b80\u5316\u65b0\u6570\u636e\u7ed3\u6784\u7684\u5e03\u5c40\u5f00\u53d1\u5de5\u4f5c\u3002</li> </ul>"},{"location":"design/llm/","title":"LLM \u9002\u914d\u8bbe\u8ba1\uff08\u5360\u4f4d\uff09","text":"<p>\u672c\u6587\u4ef6\u63cf\u8ff0\u5f53\u524d\u9636\u6bb5\u7684 LLM \u9002\u914d\u5c42\u63a5\u53e3\u3001\u5047\u8bbe\u4e0e\u540e\u7eed\u65b9\u5411\u3002\u73b0\u9636\u6bb5\u4ec5\u63d0\u4f9b\u672c\u5730\u53ef\u63d2\u62d4\u63a5\u53e3\u4e0e\u5360\u4f4d\u5b9e\u73b0\uff0c\u4e0d\u8c03\u7528\u4efb\u4f55\u771f\u5b9e LLM\u3002</p>"},{"location":"design/llm/#1","title":"1. \u76ee\u6807\u4e0e\u8303\u56f4","text":"<ul> <li>\u76ee\u6807\uff1a\u5b9a\u4e49\u201c\u81ea\u7136\u8bed\u8a00 \u2192 DSL/JSON \u2192 Command\u201d \u7684\u6700\u5c0f\u63a5\u53e3\uff0c\u4e3a\u672a\u6765 LLM \u96c6\u6210\u7559\u597d\u6302\u8f7d\u70b9\u3002</li> <li>\u8303\u56f4\uff1a<code>LLMClient</code> \u534f\u8bae\u3001<code>LLMAdapter</code> \u6865\u63a5\u3001prompt \u524d\u7f00\u914d\u7f6e\uff1b\u4e0d\u6d89\u53ca\u6a21\u578b\u9009\u62e9/\u5bf9\u8bdd\u5b58\u50a8/\u5b89\u5168\u8fc7\u6ee4\u3002</li> </ul>"},{"location":"design/llm/#2-v01","title":"2. \u5f53\u524d\u5b9e\u73b0\uff08v0.1\uff09","text":"<ul> <li>\u534f\u8bae\uff1a<code>LLMClient.generate(prompt: str) -&gt; str</code>\uff0c\u9700\u8fd4\u56de\u53ef\u88ab DSL \u89e3\u6790\u7684\u6587\u672c\u3002</li> <li>\u9002\u914d\u5668\uff1a<code>LLMAdapter(client=None, prompt_prefix=\"\")</code></li> <li><code>to_dsl(request)</code>\uff1a\u65e0 client \u65f6\u76f4\u63a5\u8fd4\u56de\u8f93\u5165\uff1b\u6709 client \u65f6\u62fc\u63a5\u524d\u7f00\u540e\u8c03\u7528 <code>generate</code>\u3002</li> <li><code>to_commands(request)</code>\uff1a<code>to_dsl</code> \u540e\u8c03\u7528 <code>parse_dsl</code>\uff08\u5f53\u524d DSL \u4ecd\u662f JSON \u5360\u4f4d\uff09\u3002</li> <li>\u9ed8\u8ba4\u884c\u4e3a\uff1a\u672a\u6ce8\u5165 client \u65f6\uff0c\u4f20\u5165\u7684\u8bf7\u6c42\u88ab\u5f53\u4f5c DSL/JSON \u76f4\u63a5\u89e3\u6790\u3002</li> </ul>"},{"location":"design/llm/#3","title":"3. \u5047\u8bbe\u4e0e\u9650\u5236","text":"<ul> <li>\u65e0\u5916\u90e8\u7f51\u7edc/\u6a21\u578b\u8c03\u7528\uff1b\u4e0d\u542b\u9274\u6743\u6216\u901f\u7387\u63a7\u5236\u3002</li> <li>\u65e0\u5bf9 prompt/\u56de\u590d\u7684\u5b89\u5168\u8fc7\u6ee4\uff1b\u9700\u5728\u63a5\u5165\u771f\u5b9e LLM \u65f6\u8865\u5145\u3002</li> <li>\u4e0d\u7ef4\u62a4\u5bf9\u8bdd\u72b6\u6001\uff1b\u6bcf\u6b21\u8c03\u7528\u4e3a\u5355\u8f6e\u8bf7\u6c42\u3002</li> <li>DSL \u89e3\u6790\u80fd\u529b\u53d7\u9650\u4e8e\u5f53\u524d\u5360\u4f4d\uff08\u4ec5 JSON\uff09\uff1b\u590d\u6742\u81ea\u7136\u8bed\u8a00\u9700\u6c42\u65e0\u6cd5\u76f4\u63a5\u6ee1\u8db3\u3002</li> </ul>"},{"location":"design/llm/#4","title":"4. \u672a\u6765\u65b9\u5411","text":"<ul> <li>\u652f\u6301\u591a\u8f6e\u5bf9\u8bdd\u4e0e\u4e0a\u4e0b\u6587\u8bb0\u5fc6\uff1b\u53ef\u63d2\u62d4 System Prompt \u6a21\u677f\u3002</li> <li>\u5b89\u5168\u7b56\u7565\uff1a\u6ce8\u5165 schema \u6821\u9a8c\u540e\u7684\u201c\u62d2\u7edd/\u4fee\u6b63\u201d\u56de\u8def\uff0c\u907f\u514d\u5371\u9669/\u65e0\u6548\u547d\u4ee4\u3002</li> <li>\u63d0\u4f9b provider \u9002\u914d\u5668\uff08OpenAI/Azure/local \u6a21\u578b\u7b49\uff09\uff0c\u5e76\u9694\u79bb\u7f51\u7edc\u4f9d\u8d56\u3002</li> <li>UI/CLI \u96c6\u6210\uff1a\u4ea4\u4e92\u5f0f\u5bf9\u8bdd\u7a97\u3001\u751f\u6210\u7ed3\u679c\u9884\u89c8\u4e0e\u4eba\u5de5\u786e\u8ba4\u3002</li> <li>\u4e0e\u771f\u5b9e DSL \u8bed\u6cd5\u7ed3\u5408\uff1aLLM \u8f93\u51fa\u7ed3\u6784\u5316 DSL \u800c\u975e\u88f8 JSON\u3002</li> </ul>"},{"location":"design/llm/#5","title":"5. \u5173\u8054\u6587\u4ef6","text":"<ul> <li><code>src/ds_vis/llm/adapter.py</code> \u2014 \u63a5\u53e3\u4e0e\u5360\u4f4d\u5b9e\u73b0\u3002</li> <li><code>docs/design/dsl.md</code> \u2014 DSL \u5360\u4f4d\u4e0e\u672a\u6765\u8bed\u6cd5\u3002</li> <li><code>docs/design/json.md</code> \u2014 Command JSON \u4ea4\u6362\u683c\u5f0f\u3002</li> </ul>"},{"location":"design/model/","title":"MODEL \u2014 \u8bbe\u8ba1\u8bf4\u660e\uff08\u8f7b\u91cf\uff09","text":"<p>\u672c\u6587\u4ef6\u63cf\u8ff0 Model \u5c42\u804c\u8d23\u8fb9\u754c\u4e0e\u6269\u5c55\u65b9\u5f0f\uff0c\u907f\u514d\u5b9e\u73b0\u7ec6\u8282\u8026\u5408\u3002</p>"},{"location":"design/model/#1","title":"1. \u89d2\u8272\u4e0e\u804c\u8d23","text":"<ul> <li>\u7ef4\u62a4\u771f\u5b9e\u6570\u636e\u7ed3\u6784\u72b6\u6001\uff08\u903b\u8f91\u62d3\u6251\u3001\u503c\u3001\u5173\u7cfb\uff09\u3002</li> <li>\u5c06\u64cd\u4f5c\u62c6\u89e3\u4e3a\u7ed3\u6784 Ops\uff08\u4e0d\u542b\u4f4d\u7f6e\uff09\u3002</li> <li>\u4fdd\u8bc1 ID/EdgeKey \u7a33\u5b9a\uff08\u81f3\u5c11\u5728\u7ed3\u6784\u751f\u547d\u5468\u671f\u5185\u5355\u8c03\uff09\u3002</li> </ul>"},{"location":"design/model/#2","title":"2. \u8f93\u5165\u8f93\u51fa","text":"<ul> <li>\u8f93\u5165\uff1aSceneGraph \u4f20\u5165\u7684 model op + payload\u3002</li> <li>\u8f93\u51fa\uff1a<code>Timeline</code>\uff08\u5305\u542b\u7ed3\u6784 Ops\uff09\u3002</li> </ul>"},{"location":"design/model/#3","title":"3. \u7ea6\u675f\u4e0e\u8fb9\u754c","text":"<ul> <li>\u4e0d\u5f97\u4f9d\u8d56 Layout/Renderer/UI/SceneGraph \u5b9e\u73b0\u7ec6\u8282\u3002</li> <li>\u4e0d\u5f97\u8f93\u51fa <code>SET_POS</code>\uff08\u7531 Layout \u6ce8\u5165\uff09\u3002</li> <li>\u4e0d\u5f97\u541e\u5f02\u5e38\uff1a\u903b\u8f91\u9519\u8bef\u629b <code>ModelError</code>\u3002</li> <li>\u5e94\u8f93\u51fa <code>kind</code>\uff0c\u7528\u4e8e\u6e32\u67d3/\u5e03\u5c40\u8bed\u4e49\uff08\u89c1 ops_spec\uff09\u3002</li> </ul>"},{"location":"design/model/#4","title":"4. \u6269\u5c55\u70b9","text":"<ul> <li>\u65b0\u7ed3\u6784\u5b9e\u73b0\uff1a\u7ee7\u627f <code>BaseModel</code>\uff0c\u5b9e\u73b0 <code>kind</code>/<code>node_count</code>/<code>apply_operation</code>\u3002</li> <li>L2 \u52a8\u753b\uff1a\u5c06\u9ad8\u5c42\u64cd\u4f5c\u62c6\u89e3\u4e3a\u591a\u4e2a Step\uff08Highlight \u2192 Structural \u2192 Restore \u7b49\uff09\u3002</li> </ul>"},{"location":"design/model/#5","title":"5. \u63a8\u8350\u5b9e\u73b0\u6a21\u5f0f\uff08\u53ef\u9009\uff09","text":"<p>\u4e3a\u63d0\u5347 L2 \u52a8\u753b\u7684\u53ef\u8bfb\u6027\u4e0e\u590d\u7528\u6027\uff0c\u5efa\u8bae\u4f7f\u7528\u201cbuilder + step \u7f16\u6392 (emitter)\u201d\u7684\u8f7b\u91cf\u6a21\u5f0f\uff1a</p> <ul> <li>Builder \u4ec5\u4f5c\u4e3a\u53ef\u9009 helper\uff1a\u4f8b\u5982 <code>_build_create_node_op</code>\u3001<code>_build_create_edge_op</code>\u3001<code>_add_state_step</code>\u3002</li> <li>\u4e0d\u5f3a\u5236\u7edf\u4e00\u62bd\u8c61\uff1a\u65e0\u8fb9\u7ed3\u6784\uff08\u5982 seqlist\uff09\u53ef\u5b8c\u5168\u4e0d\u4f7f\u7528 edge builder\uff0c\u4ec5\u4f7f\u7528\u8282\u70b9/\u6807\u7b7e/\u72b6\u6001 helper\u3002</li> <li>\u6838\u5fc3\u539f\u5219\uff1a\u4e0d\u5f15\u5165\u8de8\u5c42\u8026\u5408\uff0c\u4e0d\u8981\u6c42\u6240\u6709\u6a21\u578b\u9075\u5faa\u540c\u4e00\u5957 builder \u7c7b\u6216\u57fa\u7c7b\u3002</li> </ul> <p>\u8be5\u6a21\u5f0f\u662f\u63a8\u8350\u5b9e\u8df5\uff0c\u4e0d\u662f\u534f\u8bae\u6216\u5f3a\u5236\u89c4\u8303\u3002</p>"},{"location":"design/model/#6-p07","title":"6. \u5f53\u524d\u9650\u5236\uff08P0.7\uff09","text":"<ul> <li>\u53ef\u590d\u7528\u7684 builder \u5e93\u4ecd\u4e3a\u8f7b\u91cf helper\uff0c\u672a\u5f62\u6210\u5f3a\u5236\u5171\u7528\u62bd\u8c61\uff08\u52a8\u753b\u7ec6\u5316\u9700\u6309\u6a21\u578b\u81ea\u5b9a\u4e49\uff09\u3002</li> <li>ID \u7a33\u5b9a\u6027\u7b56\u7565\u5df2\u7528\u4e8e list/bst\uff0c\u5176\u4ed6\u6a21\u578b\u5f85\u8865\uff1b\u8de8\u6a21\u578b\u7edf\u4e00 allocator \u7b56\u7565\u4ecd\u9700\u8bc4\u4f30\u3002</li> <li>\u975e\u963b\u585e/seek \u672a\u843d\u5730\uff0c\u6a21\u578b\u4fa7\u7f3a\u5c11\u91cd\u653e/\u91cd\u5efa\u63a5\u53e3\uff08\u9700\u4e0e Layout/Renderer \u534f\u540c\uff09\u3002</li> </ul>"},{"location":"design/model/#7-listmodel-p07","title":"7. ListModel \u5b9e\u73b0\u5907\u6ce8\uff08P0.7\uff09","text":"<ul> <li>\u64cd\u4f5c\u8986\u76d6\uff1acreate / insert / delete_index / delete_all / search\uff08index/value\uff09/ update\uff08index/value\uff09\uff0c\u5747\u8f93\u51fa L2 \u5fae\u6b65\u9aa4\u3002</li> <li>sentinel \u4ec5\u7528\u4e8e\u5c55\u793a\u7a7a\u8868\uff1a\u4e0d\u8ba1\u5165 <code>_node_ids</code> / <code>node_count</code>\uff0cID \u901a\u8fc7 allocator \u751f\u6210\uff0c\u7a7a\u8868\u63d2\u5165\u524d\u4f1a\u5220\u9664 sentinel\u3002</li> <li>\u989c\u8272\u8bed\u4e49\uff1a\u904d\u5386\u7c7b\u6b65\u9aa4\u4f7f\u7528 <code>secondary</code>\uff0c\u65e7\u8fb9\uff08\u5f85\u91cd\u8fde\uff09\u4f7f\u7528 <code>to_delete</code>\uff0c\u5173\u952e\u8282\u70b9/\u65b0\u8fb9\u4f7f\u7528 <code>highlight</code>\u3002</li> <li>\u6d88\u606f\u63d0\u793a\uff1ainsert/search/update \u5728\u6b65\u9aa4\u524d\u540e\u7528 <code>SET_MESSAGE</code>\uff0c\u7ed3\u675f\u540e <code>CLEAR_MESSAGE</code>\uff1bPySide6 Renderer \u5c06\u6d88\u606f\u951a\u5b9a\u573a\u666f bbox \u9876\u90e8\u5c45\u4e2d\u3002</li> </ul>"},{"location":"design/model/#8-seqlistmodel-p08","title":"8. SeqlistModel \u5b9e\u73b0\u5907\u6ce8\uff08P0.8\uff09","text":"<ul> <li>kind=<code>seqlist</code>\uff0c\u987a\u5e8f\u8868\uff08\u65e0\u8fb9\uff09\uff1b\u64cd\u4f5c\uff1acreate/insert/delete_index/delete_all/search/update\u3002</li> <li>\u5fae\u6b65\u9aa4\uff1a\u6d88\u606f\u63d0\u793a \u2192 \u76ee\u6807/\u533a\u95f4\u9ad8\u4eae\uff08highlight/secondary\uff09\u2192 \u7ed3\u6784\u53d8\u66f4\uff08CREATE_NODE/DELETE_NODE/SET_LABEL\uff09\u2192 \u7edf\u4e00 Restore\uff08CLEAR_MESSAGE+SET_STATE normal\uff09\u3002</li> <li>ID \u7a33\u5b9a\uff1a\u8282\u70b9\u7528 allocator \u5355\u8c03\u751f\u6210\uff1b\u4e0d\u590d\u7528\u65e7 ID\u3002</li> <li>\u89c6\u89c9\u4e0e\u5e03\u5c40\uff1a\u77e9\u5f62\u5355\u5143 + \u6876\u5bb9\u5668\uff0c\u5e03\u5c40\u7531 SceneGraph \u8def\u7531 LINEAR\uff08horizontal\uff09\u6ce8\u5165 SET_POS\u3002</li> <li>\u5f02\u5e38\uff1a\u53c2\u6570\u7f3a\u5931\u6216\u8d8a\u754c\u629b ModelError\u3002</li> </ul>"},{"location":"design/model/#9-stackmodel-p08","title":"9. StackModel \u5b9e\u73b0\u5907\u6ce8\uff08P0.8\uff09","text":"<ul> <li>kind=<code>stack</code>\uff0c\u6808\uff08\u65e0\u8fb9\uff09\uff1b\u64cd\u4f5c\uff1acreate/push/pop/delete_all/search\uff08\u7ebf\u6027\u626b\u63cf\uff0c\u6559\u5b66\u53ef\u89c6\u5316\uff09\u3002</li> <li>\u987a\u5e8f\uff1a\u5185\u90e8 <code>values</code>/<code>_node_ids</code> \u6309 top\u2192bottom \u5b58\u50a8\uff0ccreate \u5c06\u8f93\u5165\u89c6\u4e3a push \u5e8f\u5217\uff08\u6700\u540e\u4e00\u4e2a\u4e3a\u6808\u9876\uff09\u3002</li> <li>\u5fae\u6b65\u9aa4\uff1aPush=\u6d88\u606f+\u6876\u9ad8\u4eae\u2192CREATE_NODE\u2192\u5bb9\u5668 resize\u2192Restore\uff1bPop=\u9ad8\u4eae\u6808\u9876\u2192DELETE_NODE\u2192\u5bb9\u5668 resize\u2192Restore\uff1bSearch=\u81ea\u9876\u5411\u4e0b\u9ad8\u4eae/secondary \u6807\u8bb0\uff1b\u6240\u6709\u6b65\u9aa4\u7ed3\u5c3e CLEAR_MESSAGE + \u72b6\u6001\u6062\u590d\u3002</li> <li>\u89c6\u89c9\u4e0e\u5e03\u5c40\uff1a\u77e9\u5f62\u5355\u5143 + \u6876\u5bb9\u5668\uff0cLINEAR \u7eb5\u5411\u5e03\u5c40\uff08orientation=vertical\uff0cspacing\u224880\uff09\uff0c\u6876\u4f4d\u7f6e\u6309\u8282\u70b9 bbox \u7eb5\u5411\u5c45\u4e2d\u3002</li> <li>\u5f02\u5e38\uff1apush/pop \u4ec5\u63a5\u53d7 index=0 \u6216\u7701\u7565\uff1b\u53c2\u6570\u7f3a\u5931\u629b ModelError\u3002</li> </ul>"},{"location":"design/model/#10-huffmanmodel-p08","title":"10. HuffmanModel \u5b9e\u73b0\u5907\u6ce8\uff08P0.8\uff09","text":"<ul> <li>kind=<code>huffman</code>\uff1b\u64cd\u4f5c\uff1abuild\uff08\u8f93\u5165\u6743\u503c\u5217\u8868\uff09/delete_all\u3002</li> <li>\u903b\u8f91\uff1a\u4f7f\u7528\u5c0f\u9876\u5806\u7ef4\u62a4\u5019\u9009\u961f\u5217\uff0c\u6bcf\u8f6e\u53d6\u6700\u5c0f\u4e24\u8282\u70b9\u751f\u6210\u7236\u8282\u70b9\uff08\u6743\u503c\u76f8\u52a0\uff09\uff0c\u7236\u8282\u70b9\u5165\u5806\uff1b\u6700\u7ec8\u6839\u4e3a Huffman \u6811\u6839\u3002</li> <li>\u5fae\u6b65\u9aa4\uff1a\u9ad8\u4eae\u4e24\u6700\u5c0f \u2192 \u521b\u5efa\u7236\u8282\u70b9\u4e0e\u4e24\u6761\u8fb9\uff08L/R\uff09\u2192 \u6309\u6743\u503c\u91cd\u65b0\u5165\u961f\u5e76\u66f4\u65b0 queue_index \u2192 CLEAR_MESSAGE\uff1b\u5b8c\u6210\u540e\u7a81\u51fa\u6839\u8282\u70b9\u3002</li> <li>\u89c6\u89c9\u4e0e\u5e03\u5c40\uff1a\u8282\u70b9\u9ed8\u8ba4 circle\uff0c\u5229\u7528 <code>queue_index</code> \u6807\u6ce8\u961f\u5217\u987a\u5e8f\uff1bTreeLayout \u652f\u6301 <code>queue_spacing/queue_start_y/tree_offset_y/tree_span</code> \u5c06\u961f\u5217\u6839\u6a2a\u6392\u3001\u5b50\u6811\u5411\u4e0b\u5c55\u5f00\u3002</li> <li>\u5f02\u5e38\uff1a\u6743\u503c\u9700\u4e3a\u6570\u5b57\uff1b\u65e0\u6570\u636e\u65f6\u63d0\u793a\u6d88\u606f\u3002</li> </ul>"},{"location":"design/model/#11-p07","title":"11. \u65b0\u6a21\u578b\u5f00\u53d1\u6307\u5317\uff08\u6a21\u677f\uff0cP0.7\uff09","text":"<ul> <li>\u72b6\u6001/\u989c\u8272\uff1a\u4f18\u5148\u4f7f\u7528\u7edf\u4e00\u72b6\u6001\u503c\uff08\u89c1 animation.md\uff09\uff0c\u907f\u514d\u81ea\u5b9a\u4e49\u6563\u4e71\u547d\u540d\u3002</li> <li>\u5fae\u6b65\u9aa4\u62c6\u89e3\u6a21\u677f\uff1a\u904d\u5386/\u5b9a\u4f4d\uff08secondary\uff09\u2192 \u5173\u952e\u8282\u70b9/\u8fb9\u9ad8\u4eae\uff08highlight\uff09\u2192 \u7ed3\u6784\u53d8\u66f4\uff08CREATE/DELETE/SET_LABEL \u7b49\uff09\u2192 \u6062\u590d\uff08normal\uff09\u3002</li> <li>\u6d88\u606f\uff1a\u5728\u64cd\u4f5c\u5f00\u59cb/\u7ed3\u679c\u4f7f\u7528 <code>SET_MESSAGE</code>\uff0c\u5b8c\u6210\u540e <code>CLEAR_MESSAGE</code>\uff1b\u5c0a\u91cd RendererConfig.show_messages\u3002</li> <li>ID/\u8fb9\u547d\u540d\uff1a\u4f7f\u7528 allocator\uff0c\u8fb9 key \u7a33\u5b9a\uff08<code>structure_id|kind|src-&gt;dst</code>\uff09\uff1bsentinel \u4ec5\u5c55\u793a\u3002</li> <li>\u6d4b\u8bd5\u5efa\u8bae\uff1a\u6b63/\u8bef\u8def\u5f84\uff0cID \u7a33\u5b9a\u6027\uff0c\u5fae\u6b65\u9aa4\u6807\u7b7e/\u72b6\u6001\u8986\u76d6\uff1b\u82e5\u590d\u6742\u884c\u4e3a\u672a\u5b9e\u73b0\u53ef\u7528 xfail \u9501\u5b9a\u9884\u671f\u3002</li> </ul> <p>\u4ea4\u53c9\u5f15\u7528\uff1aOps \u8bed\u4e49\u89c1 <code>ops_spec.md</code>\uff0c\u67b6\u6784\u8fb9\u754c\u89c1 <code>architecture.md</code>\u3002</p>"},{"location":"design/model/#12-bst-p07","title":"12. BST \u5b9e\u73b0\u5907\u6ce8\uff08P0.7\uff09","text":"<ul> <li>\u76ee\u6807\uff1a\u6811\u7c7b\u6a21\u578b\u7684\u9996\u4e2a\u53ef\u4ea4\u4ed8\u7248\u672c\uff0c\u4e3a AVL/Huffman \u7b49\u590d\u7528\u5fae\u6b65\u9aa4\u8303\u5f0f\u4e0e\u6ce8\u518c\u65b9\u5f0f\u3002</li> <li>\u5b9e\u73b0\u8981\u70b9\uff1a</li> <li>kind=<code>bst</code>\uff0c\u652f\u6301 create/insert/search/delete_value/delete_all\uff1b\u91cd\u590d\u952e\u7b56\u7565\uff1a\u8d70\u53f3\u5b50\u6811\u3002</li> <li>\u72b6\u6001\uff1a\u8282\u70b9\u5b58 key/left/right/parent\uff1bID \u5355\u8c03\uff1b\u8fb9 key <code>edge_id(edge_kind, src, dst)</code>\uff08edge_kind=<code>left</code>/<code>right</code>\uff09\u3002</li> <li>\u5fae\u6b65\u9aa4\uff1a\u67e5\u627e/\u63d2\u5165/\u5220\u9664\u8def\u5f84\u8282\u70b9\u9ad8\u4eae\uff0c\u8fb9\u7528 secondary\uff1b\u5220\u9664\u53cc\u5b50\u6811\u4f7f\u7528\u540e\u7ee7\u66ff\u6362\u6cd5\uff0c\u91cd\u8fde\u8fb9\u540e\u5220\u9664\u540e\u7ee7\uff0c\u7edf\u4e00 Restore \u72b6\u6001\uff1b\u6d88\u606f\u5728\u6b65\u9aa4\u5f00\u5934\u63d0\u793a\u3001\u7ed3\u5c3e\u6e05\u7a7a\u3002</li> <li>Layout/Pos\uff1a\u4e0d\u76f4\u63a5\u751f\u6210 SET_POS\uff0c\u7531 SceneGraph \u8def\u7531\u5230 TreeLayout \u5e76\u6ce8\u5165\u504f\u79fb\u3002</li> <li>\u9650\u5236/\u5f85\u529e\uff1a</li> <li>\u540e\u7ee7\u904d\u5386/\u5220\u9664\u53ef\u8fdb\u4e00\u6b65\u5206\u6b65\u63d0\u793a\uff1b\u65cb\u8f6c/\u5e73\u8861\u672a\u5b9e\u73b0\uff08AVL/\u7ea2\u9ed1\u6811\u7559\u5f85\u540e\u7eed\uff09\u3002</li> <li>\u6df7\u6392\u5206\u533a\u4e3a\u5e38\u91cf\u504f\u79fb\uff0c\u6811\u5c3a\u5bf8\u672a\u53c2\u4e0e\u8ba1\u7b97\uff1b\u7bad\u5934/\u7aef\u70b9\u88c1\u526a\u4e0e\u6e10\u7ed8\u4f9d\u8d56 Renderer P0.8\u3002</li> <li>DSL \u4ecd\u4e3a JSON \u5360\u4f4d\uff0c\u672a\u7ed1\u5b9a\u6811\u8bed\u4e49\uff1bGit/Huffman/DAG kind \u9884\u7559\u672a\u5b9e\u73b0\u3002</li> </ul>"},{"location":"design/ops_spec/","title":"OPS_SPEC \u2014 AnimationOps \u89c4\u8303","text":"<p>\u672c\u89c4\u8303\u5b9a\u4e49\u4e86\u672c\u9879\u76ee\u4e2d \u201c\u52a8\u753b\u6307\u4ee4\u5c42\uff08AnimationOps\uff09\u201d \u7684\u7edf\u4e00\u534f\u8bae\uff0c \u7528\u4e8e\u5728 \u6a21\u578b / SceneGraph \u4e0e \u6e32\u67d3\u5668 \u4e4b\u95f4\u4f20\u9012\u201c\u5e94\u8be5\u5c55\u793a\u4ec0\u4e48\u52a8\u753b\u201d\u3002</p> <p>\u4ea4\u53c9\u5f15\u7528\uff1a\u5173\u4e8e <code>kind</code> \u7684\u8bed\u4e49\u7c7b\u578b\u4e0e Style/Metrics \u914d\u7f6e\u8fb9\u754c\uff0c\u8bf7\u53c2\u89c1 <code>docs/design/architecture.md</code> \u7b2c 6.3 \u8282\uff08Style / Metrics \u914d\u7f6e\uff09\u3002</p> <p>\u76ee\u6807\uff1a</p> <ul> <li>\u4e0e\u6570\u636e\u7ed3\u6784\u6a21\u578b\u3001UI\u3001DSL \u89e3\u8026\u3002</li> <li>\u4e0e\u5177\u4f53\u6e32\u67d3\u6280\u672f\u89e3\u8026\uff08PySide6 / Web / CLI\uff09\u3002</li> <li>\u9002\u5408\u5e8f\u5217\u5316\u4e3a JSON\uff08\u65b9\u4fbf DSL\u3001Web\u3001\u8de8\u8fdb\u7a0b\uff09\u3002</li> </ul> <p>\u8fd9\u4e2a\u534f\u8bae\u56de\u7b54\u4e86\u4e09\u4e2a\u95ee\u9898\uff1a</p> <ol> <li>\u8981\u52a8\u54ea\u4e9b\u5bf9\u8c61\uff1f     \u2192 \u54ea\u4e9b node / edge / label / \u5168\u5c40\u63d0\u793a\u8981\u53d8\u5316\uff1f</li> <li>\u53d8\u5316\u6210\u4ec0\u4e48\u72b6\u6001\uff1f     \u2192 \u53d8\u6210\u4ec0\u4e48\u4f4d\u7f6e\u3001\u6587\u672c\u3001\u72b6\u6001\uff08normal/active/...\uff09\uff1f</li> <li>\u7528\u591a\u957f\u65f6\u95f4\u5b8c\u6210\u8fd9\u4e00\u6b65\uff1f     \u2192 \u8fd9\u4e00\u201c\u6559\u5b66\u6b65\u9aa4\u201d\u7528\u591a\u5c11\u6beb\u79d2\u64ad\u653e\u5b8c\uff1f</li> </ol> <p>\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u8bbe\u8ba1\u4e09\u7c7b\u4e1c\u897f\uff1a</p> <ul> <li>AnimationOp\uff1a\u4e00\u4e2a\u201c\u72b6\u6001\u53d8\u5316\u6307\u4ee4\u201d\uff08\u539f\u5b50\u64cd\u4f5c\uff0c\u6ca1\u6709\u65f6\u95f4\uff09</li> <li>AnimationStep\uff1a\u4e00\u7ec4\u5c5e\u4e8e\u540c\u4e00\u4e2a\u201c\u6559\u5b66\u5fae\u6b65\u9aa4\u201d\u7684 Ops + \u65f6\u957f</li> <li>Timeline\uff1a\u82e5\u5e72 Step \u7684\u6709\u5e8f\u5217\u8868</li> </ul> <p>\u5176\u5b83\uff08\u5e76\u884c/\u987a\u5e8f\u3001\u5b58\u50a8/\u91cd\u653e\u3001Undo \u7b49\uff09\u90fd\u662f\u56f4\u7ed5\u8fd9\u4e2a\u6838\u5fc3\u534f\u8bae\u6784\u5efa\u7684\u7b56\u7565\uff0c\u7559\u7ed9\u540e\u7eed\u8bbe\u8ba1\u89e3\u51b3\u3002</p>"},{"location":"design/ops_spec/#1","title":"1. \u603b\u4f53\u8bbe\u8ba1\u601d\u60f3","text":""},{"location":"design/ops_spec/#11-step-ops","title":"1.1 \u57fa\u672c\u5355\u4f4d\uff1aStep + Ops","text":"<p>\u52a8\u753b\u88ab\u62bd\u8c61\u4e3a\u4e00\u4e2a \u6309\u987a\u5e8f\u64ad\u653e\u7684 Step \u5217\u8868\uff1a</p> <ul> <li>\u6bcf\u4e2a Step \u6709\u4e00\u4e2a\u7edf\u4e00\u7684 <code>duration_ms</code>\uff08\u65f6\u957f\uff09\u3002</li> <li>\u4e00\u4e2a Step \u5185\u90e8\u5305\u542b\u82e5\u5e72\u4e2a AnimationOp\uff0c\u5b83\u4eec\u88ab\u8ba4\u4e3a\u662f\u5e76\u884c\u53d1\u751f\u7684\u3002</li> <li>\u6e32\u67d3\u5668\u8d1f\u8d23\u5728 <code>duration_ms</code> \u65f6\u95f4\u7a97\u53e3\u5185\uff0c\u4ece\u4e0a\u4e00 Step \u72b6\u6001\u5e73\u6ed1\u8fc7\u6e21\u5230\u5f53\u524d Step \u72b6\u6001\u3002</li> </ul> <p>\u8fd9\u610f\u5473\u7740\uff1a</p> <ul> <li>\u65f6\u95f4\u8f74\u53ea\u5728 Step \u8fd9\u4e00\u5c42\u51fa\u73b0\uff08\u4e0d\u5728\u5355\u4e2a Op \u4e0a\u63a7\u5236\u65f6\u95f4\uff09\u3002</li> <li>\u7edd\u5927\u90e8\u5206\u6559\u5b66\u52a8\u753b\u53ef\u4ee5\u770b\u4f5c \u201c\u4e00\u7cfb\u5217\u72b6\u6001\u5207\u6362 + \u6bcf\u4e00\u6b65\u7684\u8fc7\u6e21\u6548\u679c\u201d\u3002</li> </ul>"},{"location":"design/ops_spec/#12-node-edge-global","title":"1.2 \u5bf9\u8c61\u6a21\u578b\uff1aNode / Edge / Global","text":"<p>AnimationOps \u64cd\u4f5c\u7684\u5bf9\u8c61\u5206\u4e3a\u4e09\u7c7b\uff1a</p> <ul> <li>Node\uff1a\u53ef\u89c6\u5316\u4e2d\u7684\u57fa\u672c\u5143\u7d20\uff08\u6570\u7ec4\u683c\u3001\u94fe\u8868\u7ed3\u70b9\u3001\u6811\u7ed3\u70b9\u3001Git commit \u7b49\uff09\u3002</li> <li>Edge\uff1a\u8282\u70b9\u4e4b\u95f4\u7684\u8fde\u63a5\uff08\u6307\u9488\u3001\u6811\u8fb9\u3001Git \u7236\u5b50\u5173\u7cfb, \u53ef\u80fd\u6709\u65b9\u5411\uff09\u3002</li> <li>Global\uff1a\u5168\u5c40\u63d0\u793a\u6587\u672c\u7b49\uff0c\u4e0d\u5c5e\u4e8e\u5177\u4f53\u8282\u70b9\u6216\u8fb9\u3002</li> </ul>"},{"location":"design/ops_spec/#13-id","title":"1.3 ID \u7ea6\u5b9a","text":"<ul> <li><code>node_id</code> / <code>edge_id</code> / <code>structure_id</code> \u7b49 ID \u5747\u4e3a\u5b57\u7b26\u4e32\u3002</li> <li>ID \u7531\u6a21\u578b/SceneGraph \u8d1f\u8d23\u5206\u914d\uff0c\u6e32\u67d3\u5668\u53ea\u4f7f\u7528\uff0c\u4e0d\u4fee\u6539\u3002</li> </ul>"},{"location":"design/ops_spec/#2-timeline","title":"2. Timeline \u7ed3\u6784","text":""},{"location":"design/ops_spec/#21","title":"2.1 \u6982\u5ff5\u7ed3\u6784","text":"<p>\u4e00\u4e2a\u5b8c\u6574\u52a8\u753b\u65f6\u95f4\u7ebf\u7528\u4ee5\u4e0b\u7ed3\u6784\u8868\u793a\uff1a</p> <pre><code>{\n  \"steps\": [\n    {\n      \"duration_ms\": 400,\n      \"label\": \"BST \u63d2\u5165\uff1a\u67e5\u627e\u4f4d\u7f6e\",\n      \"ops\": [\n        { \"op\": \"SET_STATE\", \"target\": \"node_5\", \"data\": { \"state\": \"active\" } }\n      ]\n    },\n    {\n      \"duration_ms\": 400,\n      \"label\": \"BST \u63d2\u5165\uff1a\u521b\u5efa\u65b0\u8282\u70b9\",\n      \"ops\": [\n        { \"op\": \"CREATE_NODE\", \"target\": \"node_7\", \"data\": { \"structure_id\": \"tree_1\", \"kind\": \"bst_node\", \"label\": \"7\" } },\n        { \"op\": \"CREATE_EDGE\", \"target\": \"edge_5_7\", \"data\": { \"from\": \"node_5\", \"to\": \"node_7\", \"directed\": true } }\n      ]\n    }\n  ]\n}\n</code></pre> <p>\u5b9e\u73b0\u5efa\u8bae\uff08Renderer \u89c6\u89d2\uff09\uff1a</p> <ol> <li>\u7ef4\u62a4\u4e00\u4e2a\u5185\u90e8\u201c\u53ef\u89c6\u72b6\u6001\u201d\uff08\u5f53\u524d node/edge \u96c6\u5408\u53ca\u5176\u5c5e\u6027 + \u5168\u5c40\u6d88\u606f\uff09\u3002</li> <li>\u5bf9\u4e8e\u6bcf\u4e2a Step\uff1a</li> <li>\u4ece\u4e0a\u4e00 Step \u7ed3\u675f\u65f6\u7684\u53ef\u89c6\u72b6\u6001\u4f5c\u4e3a\u201c\u8d77\u70b9\u201d\uff1b</li> <li>\u5e94\u7528\u672c Step \u7684\u6240\u6709 Ops\uff0c\u5f97\u5230\u201c\u7ec8\u6001\u201d\uff1b</li> <li>\u5728 duration_ms \u5185\uff0c\u628a\u753b\u9762\u4ece\u8d77\u70b9\u63d2\u503c\u5230\u7ec8\u6001\uff1b</li> <li>Step \u7ed3\u675f\u65f6\u7684\u72b6\u6001\u6210\u4e3a\u4e0b\u4e00\u4e2a Step \u7684\u8d77\u70b9\u3002</li> </ol>"},{"location":"design/ops_spec/#22-step-animationstep-ops","title":"2.2 Step \u5b57\u6bb5(AnimationStep: \u65f6\u95f4\u7c92\u5ea6 + \u4e00\u7ec4 Ops)","text":""},{"location":"design/ops_spec/#221","title":"2.2.1 \u7ed3\u6784","text":"<ul> <li> <p><code>duration_ms: int</code></p> </li> <li> <p>\u672c Step \u7684\u64ad\u653e\u65f6\u957f\uff08\u6beb\u79d2\uff09\u3002</p> </li> <li>\u63a8\u8350\u9ed8\u8ba4\u503c\uff1a300\u2013600ms\u3002</li> <li> <p><code>label: string | null</code></p> </li> <li> <p>\u53ef\u9009\uff0c\u4eba\u7c7b\u53ef\u8bfb\u7684 Step \u540d\uff0c\u65b9\u4fbf UI \u6216\u8c03\u8bd5\u3002</p> </li> <li> <p><code>ops: AnimationOp[]</code></p> </li> <li> <p>\u672c Step \u5185\u8981\u6267\u884c\u7684\u6240\u6709\u52a8\u753b\u64cd\u4f5c\u3002</p> </li> </ul>"},{"location":"design/ops_spec/#222","title":"2.2.2 \u8bed\u4e49\u8bf4\u660e\uff1a","text":"<ul> <li>Step \u662f\u6559\u5b66\u4e0a\u7684\u539f\u5b50\u6b65\u9aa4\uff1aUI \u7684\u201c\u4e0b\u4e00\u6b65 / \u4e0a\u4e00\u6b65\u201d\u5c31\u662f\u5728 Step \u5c42\u9762\u8df3\u3002</li> <li>Step \u5185\u7684\u6240\u6709 Ops\uff1a</li> <li>\u8bed\u4e49\u4e0a\u5c5e\u4e8e\u540c\u4e00\u4e2a\u65f6\u95f4\u7a97\u53e3\uff1b</li> <li>\u5e94\u5728 duration_ms \u5185\u5168\u90e8\u5b8c\u6210\u6548\u679c\uff1b</li> <li>\u5141\u8bb8 Renderer \u987a\u5e8f\u5904\u7406\u3002</li> </ul>"},{"location":"design/ops_spec/#223","title":"2.2.3 \u7ea6\u675f","text":"<ul> <li>\u4e0d\u5141\u8bb8\u5728\u540c\u4e00 Step \u5185\u5bf9\u540c\u4e00\u4e2a target \u505a\u81ea\u76f8\u77db\u76fe\u64cd\u4f5c\uff1a</li> <li>\u6bd4\u5982\u540c\u65f6 CREATE_NODE \u548c DELETE_NODE\u3002</li> <li>\u5141\u8bb8\u5bf9\u540c\u4e00 target \u5728\u4e00 Step \u5185\u505a\u591a\u4e2a\u201c\u517c\u5bb9\u64cd\u4f5c\u201d\uff1a</li> <li>\u5982\u5148 SET_POS \u518d SET_STATE\uff0cRenderer \u53ef\u4ee5\u5728\u8fd9\u6bb5\u65f6\u95f4\u5185\u540c\u65f6\u79fb\u52a8 + \u9ad8\u4eae\u3002</li> <li>ops \u53ef\u4ee5\u4e3a\u7a7a\uff1a</li> <li>\u4ee3\u8868\u201c\u7eaf\u505c\u987f\u201d\uff0c\u53ea\u7531 duration_ms \u51b3\u5b9a\u8fd9\u4e00\u6b65\u7b49\u5f85\u591a\u4e45\u3002</li> </ul>"},{"location":"design/ops_spec/#3-animationop","title":"3. AnimationOp \u7ed3\u6784","text":"<p>\u7edf\u4e00\u7ed3\u6784\uff1a</p> <pre><code>{\n  \"op\": \"OP_CODE\",                       /* \u64cd\u4f5c\u7c7b\u578b\uff0c\u4f8b\u5982 CREATE_NODE */\n  \"target\": \"object_id or null\",         /* \u76ee\u6807\u5bf9\u8c61 ID\uff08node/edge/\u7279\u6b8a UI \u5143\u7d20\uff09\uff0c\u5168\u5c40\u64cd\u4f5c\u53ef\u4e3a null */\n  \"data\": { /* op-specific payload */ }  /* \u5177\u4f53\u53c2\u6570\uff0c\u7531 op \u7c7b\u578b\u51b3\u5b9a */\n}\n</code></pre> <p>\u5173\u952e\u70b9\uff1a</p> <ul> <li>Op \u4e0d\u5e26\u65f6\u95f4\u6982\u5ff5</li> <li>Op \u4e0d\u5173\u5fc3\u201c\u4ece\u54ea\u91cc\u52a8\u5230\u54ea\u91cc\u201d\uff0c\u53ea\u5173\u5fc3 \u7ec8\u6001\u662f\u4ec0\u4e48\uff08\u6bd4\u5982\u6700\u7ec8\u5750\u6807\u3001\u6700\u7ec8\u72b6\u6001\uff09</li> <li>\u65f6\u95f4\u63a7\u5236\u7edf\u4e00\u653e\u5728 Step \u4e0a</li> </ul>"},{"location":"design/ops_spec/#_1","title":"\u5b57\u6bb5\u8bf4\u660e\uff1a","text":"<ul> <li> <p><code>op: string</code></p> </li> <li> <p>\u679a\u4e3e\u503c\uff0c\u6307\u660e\u64cd\u4f5c\u7c7b\u578b\uff0c\u5982 <code>CREATE_NODE</code>\u3002</p> </li> <li> <p><code>target: string | null</code></p> </li> <li> <p>\u4e3b\u8981\u64cd\u4f5c\u5bf9\u8c61 ID\uff08\u8282\u70b9\u3001\u8fb9\u3001\u6216\u5176\u4ed6\uff09\u3002</p> </li> <li>\u82e5\u64cd\u4f5c\u662f\u5168\u5c40\u6027\u8d28\uff08\u5982 <code>SET_MESSAGE</code>\uff09\uff0c\u53ef\u4ee5\u4e3a <code>null</code>\u3002</li> <li> <p><code>data: object</code></p> </li> <li> <p>\u4e0d\u540c <code>op</code> \u7c7b\u578b\u7684\u53c2\u6570\u8f7d\u8377\uff0c\u7ed3\u6784\u5728\u4e0b\u9762\u9010\u4e00\u5b9a\u4e49\u3002</p> </li> </ul>"},{"location":"design/ops_spec/#4-op-v01","title":"4. \u6807\u51c6 Op \u96c6\u5408\uff08v0.1\uff09","text":"<p>\u4ee5\u4e0b\u662f v0.1 \u7ea6\u5b9a\u7684\u6700\u5c0f\u3001\u53ef\u6269\u5c55 AnimationOps \u96c6\u5408\uff0c \u5b83\u4eec\u5e94\u8db3\u4ee5\u8986\u76d6\uff1a\u6570\u7ec4\u3001\u94fe\u8868\u3001\u6808\u3001BST\u3001AVL\u3001Huffman\u3001GitGraph \u7684\u6559\u5b66\u52a8\u753b\u9700\u6c42\u3002</p> <p>\u91cd\u8981\uff1a</p> <ul> <li>\u7ed3\u6784\u53d8\u5316\uff08\u521b\u5efa\u3001\u5220\u9664\u3001\u8fde\u8fb9\uff09 \u2192 \u7ed3\u6784\u7c7b\u64cd\u4f5c</li> <li>\u89c6\u89c9\u6548\u679c\uff08\u9ad8\u4eae\u3001\u6de1\u51fa\u3001\u6807\u7b7e\u53d8\u5316\uff09 \u2192 \u72b6\u6001\u7c7b\u64cd\u4f5c</li> <li>\u5168\u5c40\u63d0\u793a\uff08\u89e3\u91ca\u5f53\u524d\u6b65\u9aa4\uff09 \u2192 \u5168\u5c40\u7c7b\u64cd\u4f5c</li> </ul>"},{"location":"design/ops_spec/#41-structural-ops","title":"4.1 \u7ed3\u6784\u7c7b\uff08Structural Ops\uff09","text":""},{"location":"design/ops_spec/#411-create_node","title":"4.1.1 <code>CREATE_NODE</code>","text":"<p>\u5728\u753b\u5e03\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 Node\u3002</p> <ul> <li><code>target</code>: <code>node_id</code></li> <li><code>data</code>:</li> </ul> <pre><code>{\n  \"structure_id\": \"tree_1\",\n  \"kind\": \"bst_node\",     // \u6e32\u67d3/\u5e03\u5c40\u7684\u8bed\u4e49\u7c7b\u578b\uff0c\u5f3a\u70c8\u5efa\u8bae\u5fc5\u586b\uff1b\u7f3a\u5931\u5219\u56de\u9000\u9ed8\u8ba4\u6837\u5f0f\n  \"label\": \"42\",          // \u663e\u793a\u5728\u8282\u70b9\u4e0a\u7684\u6587\u672c\n  \"index\": 1,             // \u53ef\u9009\uff0c\u5e03\u5c40\u63d0\u793a\uff1a\u5728\u5f53\u524d\u884c\u7684\u63d2\u5165\u4f4d\u7f6e\uff08\u7528\u4e8e\u975e\u8ffd\u52a0\u5f0f\u63d2\u5165\uff09\n  \"meta\": {               // \u53ef\u9009\uff0c\u6a21\u578b\u9644\u5e26\u4fe1\u606f\n    \"key\": 42\n  }\n}\n</code></pre>"},{"location":"design/ops_spec/#412-delete_node","title":"4.1.2 <code>DELETE_NODE</code>","text":"<p>\u4ece\u753b\u5e03\u4e2d\u5220\u9664\u4e00\u4e2a\u73b0\u6709 Node\u3002</p> <ul> <li><code>target</code>: <code>node_id</code></li> <li><code>data</code>: <code>{}</code>\uff08\u7a7a\u5bf9\u8c61\uff09</li> </ul> <p>\u6e32\u67d3\u5668\u53ef\u6839\u636e\u5f53\u524d Step \u7684 <code>duration_ms</code> \u51b3\u5b9a\u662f\u7acb\u5373\u6d88\u5931\u8fd8\u662f\u6de1\u51fa\u3002</p>"},{"location":"design/ops_spec/#413-create_edge","title":"4.1.3 <code>CREATE_EDGE</code>","text":"<p>\u5728\u4e24\u4e2a Node \u4e4b\u95f4\u521b\u5efa\u4e00\u6761 Edge\u3002</p> <ul> <li><code>target</code>: <code>edge_id</code></li> <li><code>data</code>:</li> </ul> <pre><code>{\n  \"structure_id\": \"tree_1\",\n  \"from\": \"node_5\",\n  \"to\": \"node_7\",\n  \"directed\": true,\n  \"label\": \"\"        // \u5982 \"left\" / \"next\" / \"parent\" \u7b49\uff0c\u53ef\u9009\n}\n</code></pre>"},{"location":"design/ops_spec/#414-delete_edge","title":"4.1.4 <code>DELETE_EDGE</code>","text":"<p>\u5220\u9664\u73b0\u6709\u8fb9\u3002</p> <ul> <li><code>target</code>: <code>edge_id</code></li> <li><code>data</code>: <code>{}</code></li> </ul>"},{"location":"design/ops_spec/#42-layout-position-ops","title":"4.2 \u5e03\u5c40\u4e0e\u4f4d\u7f6e\uff08Layout / Position Ops\uff09","text":"<p>\u5e03\u5c40\u7b97\u6cd5\u901a\u5e38\u7531 <code>core.layout</code> \u51b3\u5b9a\uff0c AnimationOps \u7528\u4e8e\u901a\u77e5\u6e32\u67d3\u5668\u201c\u67d0\u4e2a Node \u5e94\u8be5\u5728\u65b0\u4f4d\u7f6e\u201d\u3002</p> <p>SET_POS \u7531\u6838\u5fc3 Layout \u6a21\u5757\u751f\u6210\uff0cDomain Model \u4e0d\u5e94\u76f4\u63a5\u4f9d\u8d56\u5177\u4f53\u5750\u6807\uff0c\u800c\u662f\u901a\u8fc7\u7ed3\u6784\u4fe1\u606f\uff08\u5982\u5c42\u7ea7\u3001\u5e8f\u53f7\uff09\u9a71\u52a8 Layout\u3002</p>"},{"location":"design/ops_spec/#421-set_pos","title":"4.2.1 <code>SET_POS</code>","text":"<p>\u8bbe\u7f6e Node \u7684\u663e\u793a\u4f4d\u7f6e\uff08\u5750\u6807\u5355\u4f4d\u7531\u6e32\u67d3\u5668\u89e3\u91ca\uff0c\u901a\u5e38\u4e3a\u50cf\u7d20\uff09\u3002</p> <ul> <li><code>target</code>: <code>node_id</code></li> <li><code>data</code>:</li> </ul> <pre><code>{\n  \"x\": 120.0,\n  \"y\": 80.0\n}\n</code></pre> <p>\u6e32\u67d3\u5668\u53ef\u5728 Step \u7684 <code>duration_ms</code> \u65f6\u95f4\u5185\u63d2\u503c\u4ece\u4e0a\u4e00\u4f4d\u7f6e\u79fb\u52a8\u5230\u65b0\u4f4d\u7f6e\uff0c\u4ece\u800c\u5f62\u6210\u5e73\u6ed1\u79fb\u52a8\u6548\u679c\u3002</p>"},{"location":"design/ops_spec/#43-state-visual-ops","title":"4.3 \u72b6\u6001\u4e0e\u6837\u5f0f\uff08State / Visual Ops\uff09","text":"<p>\u4e3a\u4fdd\u6301\u6837\u5f0f\u7b80\u5355\u4f46\u53ef\u6269\u5c55\uff0c\u6211\u4eec\u91c7\u7528\u201c\u903b\u8f91\u72b6\u6001\u6807\u7b7e\u201d\uff0c\u5177\u4f53\u89c6\u89c9\u6837\u5f0f\u7531\u6e32\u67d3\u5668\u81ea\u884c mapping\u3002</p>"},{"location":"design/ops_spec/#431-set_state","title":"4.3.1 <code>SET_STATE</code>","text":"<p>\u8bbe\u7f6e Node \u6216 Edge \u7684\u903b\u8f91\u72b6\u6001\u3002</p> <ul> <li><code>target</code>: <code>node_id</code> \u6216 <code>edge_id</code></li> <li><code>data</code>:</li> </ul> <pre><code>{\n  \"state\": \"active\"   // \u4f8b\u5982: \"normal\", \"active\", \"secondary\", \"to_delete\", \"faded\", \"error\"\n}\n</code></pre> <p>\u63a8\u8350\u72b6\u6001\u503c\u96c6\u5408\uff08\u53ef\u6269\u5c55\uff09\uff1a</p> <ul> <li><code>normal</code>\uff1a\u9ed8\u8ba4\u72b6\u6001</li> <li><code>active</code>\uff1a\u5f53\u524d\u64cd\u4f5c\u7126\u70b9\u8282\u70b9</li> <li><code>highlight</code>\uff1a\u77ed\u65f6\u5f3a\u8c03\uff08\u4f8b\u5982\u63d2\u5165/\u5220\u9664\u7684\u90bb\u63a5\u8282\u70b9\uff09</li> <li><code>secondary</code>\uff1a\u8f85\u52a9\u9ad8\u4eae\uff08\u5982\u67e5\u627e\u8def\u5f84\u4e2d\u7684\u975e\u5f53\u524d\u8282\u70b9\uff09</li> <li><code>to_delete</code>\uff1a\u5373\u5c06\u88ab\u5220\u9664\u7684\u8282\u70b9</li> <li><code>faded</code>\uff1a\u5f31\u5316\u663e\u793a</li> <li><code>error</code>\uff1a\u9519\u8bef\u63d0\u793a\uff08\u5982\u975e\u6cd5\u64cd\u4f5c\uff09</li> </ul>"},{"location":"design/ops_spec/#432-set_label","title":"4.3.2 <code>SET_LABEL</code>","text":"<p>\u4fee\u6539 Node \u6216 Edge \u7684\u6587\u672c\u6807\u7b7e\u3002</p> <ul> <li><code>target</code>: <code>node_id</code> \u6216 <code>edge_id</code></li> <li><code>data</code>:</li> </ul> <pre><code>{\n  \"text\": \"5\"\n}\n</code></pre> <p>\u9002\u7528\u4e8e\uff1a</p> <ul> <li>\u66f4\u65b0\u6570\u7ec4\u5355\u5143\u683c\u5185\u5bb9\uff1b</li> <li>\u66f4\u65b0\u6811\u7ed3\u70b9 key\uff1b</li> <li>\u66f4\u65b0 Git commit \u7684\u77ed SHA / message \u6458\u8981\u3002</li> </ul>"},{"location":"design/ops_spec/#44-global-ops","title":"4.4 \u5168\u5c40\u63d0\u793a\uff08Global Ops\uff09","text":""},{"location":"design/ops_spec/#441-set_message","title":"4.4.1 <code>SET_MESSAGE</code>","text":"<p>\u8bbe\u7f6e\u5f53\u524d Step \u7684\u5168\u5c40\u63d0\u793a\u6587\u672c\uff08\u4f8b\u5982\u5728\u754c\u9762\u4e0b\u65b9\u663e\u793a\uff09\u3002</p> <ul> <li><code>target</code>: <code>null</code></li> <li><code>data</code>:</li> </ul> <pre><code>{\n  \"text\": \"\u5f53\u524d\u64cd\u4f5c\uff1a\u5728\u7ed3\u70b9 5 \u7684\u53f3\u5b50\u6811\u63d2\u5165 7\"\n}\n</code></pre> <p>\u6e32\u67d3\u5668\u53ef\u4ee5\u9009\u62e9\uff1a</p> <ul> <li>\u5728\u4e00\u4e2a\u56fa\u5b9a\u533a\u57df\u663e\u793a\u8be5\u6587\u672c\uff1b</li> <li>\u6216\u4ee5\u6d6e\u52a8\u63d0\u793a\u65b9\u5f0f\u5448\u73b0\u3002</li> </ul>"},{"location":"design/ops_spec/#442-clear_message","title":"4.4.2 <code>CLEAR_MESSAGE</code>","text":"<p>\u6e05\u9664\u5168\u5c40\u63d0\u793a\u3002</p> <ul> <li><code>target</code>: <code>null</code></li> <li><code>data</code>: <code>{}</code></li> </ul>"},{"location":"design/ops_spec/#5-git-ops","title":"5. Git \u6559\u5b66\u52a8\u753b\u4e2d\u7684 Ops \u4f7f\u7528\u7ea6\u5b9a\uff08\u793a\u4f8b\uff09","text":"<p>\u4ee5\u865a\u62df <code>git commit</code> \u52a8\u753b\u4e3a\u4f8b\uff0c\u63a8\u8350\u4f7f\u7528\u5982\u4e0b Ops \u7ec4\u5408\uff1a</p>"},{"location":"design/ops_spec/#51-git-commit-m-msg","title":"5.1 git commit -m \"msg\"","text":"<p>\u5047\u8bbe\u5f53\u524d HEAD \u5728 <code>commit_a</code>\uff0c\u65b0 commit \u662f <code>commit_b</code>\uff0c\u6240\u5728\u7ed3\u6784 ID \u4e3a <code>repo_1</code>\u3002</p> <ol> <li>\u9ad8\u4eae\u5f53\u524d HEAD\uff1a</li> </ol> <pre><code>{ \"op\": \"SET_STATE\", \"target\": \"commit_a\", \"data\": { \"state\": \"active\" } }\n</code></pre> <ol> <li>\u521b\u5efa\u65b0\u8282\u70b9 + \u8fb9\uff1a</li> </ol> <pre><code>{\n  \"op\": \"CREATE_NODE\",\n  \"target\": \"commit_b\",\n  \"data\": {\n    \"structure_id\": \"repo_1\",\n    \"kind\": \"git_commit\",\n    \"label\": \"b1c2d3\",\n    \"meta\": { \"message\": \"msg\" }\n  }\n}\n</code></pre> <pre><code>{\n  \"op\": \"CREATE_EDGE\",\n  \"target\": \"edge_a_b\",\n  \"data\": {\n    \"structure_id\": \"repo_1\",\n    \"from\": \"commit_a\",\n    \"to\": \"commit_b\",\n    \"directed\": true\n  }\n}\n</code></pre> <ol> <li>\u8bbe\u7f6e HEAD / branch \u6807\u7b7e\u7684 POS / STATE\uff08\u53ef\u9009\uff09    \uff08HEAD / branch label \u53ef\u4ee5\u5efa\u6a21\u4e3a\u7279\u6b8a kind \u7684 Node,     \u7ed1\u5b9a\u4e00\u6761\u8fb9\u6307\u5411\u7279\u5b9a\u7684branch / git_commit Node\uff09</li> </ol>"},{"location":"design/ops_spec/#6-python-coreops","title":"6. Python \u6620\u5c04\uff08\u4e0e core/ops \u5bf9\u5e94\uff09","text":"<p>\u5728 Python \u4fa7\uff0cAnimationOps \u89c4\u8303\u5bf9\u5e94\u5982\u4e0b\u57fa\u7840\u7c7b\u578b\uff08Phase 0\u20131\uff09\uff1a</p> <pre><code>from dataclasses import dataclass\nfrom enum import Enum, auto\nfrom typing import Any, Mapping\n\n\nclass OpCode(Enum):\n    CREATE_NODE = auto()\n    DELETE_NODE = auto()\n    CREATE_EDGE = auto()\n    DELETE_EDGE = auto()\n    SET_POS = auto()\n    SET_STATE = auto()\n    SET_LABEL = auto()\n    SET_MESSAGE = auto()\n    CLEAR_MESSAGE = auto()\n\n\n@dataclass(frozen=True)\nclass AnimationOp:\n    op: OpCode\n    target: str | None\n    data: Mapping[str, Any]\n</code></pre> <p>\u65f6\u95f4\u7ebf\u5c42\uff1a</p> <pre><code>from dataclasses import dataclass, field\nfrom typing import List, Sequence\n\n\n@dataclass\nclass AnimationStep:\n    duration_ms: int = 400\n    label: str | None = None\n    ops: List[AnimationOp] = field(default_factory=list)\n\n\n@dataclass\nclass Timeline:\n    steps: List[AnimationStep] = field(default_factory=list)\n\n    def add_step(self, step: AnimationStep) -&gt; None:\n        self.steps.append(step)\n\n    def __iter__(self) -&gt; Sequence[AnimationStep]:\n        return iter(self.steps)\n\n    def __len__(self) -&gt; int:\n        return len(self.steps)\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <ul> <li>\u76ee\u524d\u53ea\u4fdd\u8bc1\u63a5\u53e3\u5b9a\u4e49\u548c\u8bed\u4e49\u7a33\u5b9a\uff1b</li> <li>\u5177\u4f53\u5b9e\u73b0\uff08\u5982\u4f55\u751f\u6210\u8fd9\u4e9b ops\u3001\u5982\u4f55\u5728 PySide6/Web \u4e0a\u6e32\u67d3\uff09\u7531\u540e\u7eed Phase \u548c Coding Agents \u5b9e\u73b0\u3002</li> </ul>"},{"location":"design/ops_spec/#7-v02","title":"7. \u6f14\u8fdb\u8ba1\u5212\uff08v0.2+\uff09","text":"<p>\u672a\u6765\u53ef\u80fd\u6269\u5c55\u7684\u5185\u5bb9\uff08\u4e0d\u5728\u5f53\u524d\u8bfe\u8bbe\u786c\u6027\u8303\u56f4\u5185\uff09\uff1a</p> <ul> <li>\u589e\u52a0 <code>GROUP</code>/<code>PARALLEL</code> \u7b49\u66f4\u590d\u6742\u65f6\u95f4\u7ed3\u6784\u3002</li> <li>\u589e\u52a0\u66f4\u7ec6\u7c92\u5ea6\u7684\u89c6\u89c9 control\uff08\u5982\u989c\u8272\u901a\u9053\u3001\u7ebf\u578b\u3001\u8282\u70b9\u5f62\u72b6\uff09\u3002</li> <li>\u589e\u52a0 <code>ATTACH_OVERLAY</code>\u3001<code>HIDE_NODE</code> \u7b49\u66f4\u4e30\u5bcc\u4ea4\u4e92\u3002</li> </ul> <p>\u4f46\u5728\u5f53\u524d\u9636\u6bb5\uff0c\u672c\u89c4\u8303\u5217\u51fa\u7684 Op \u96c6\u5408\u5df2\u7ecf\u8db3\u4ee5\u652f\u6301 L2 \u6559\u5b66\u7ea7\u52a8\u753b + Git \u6559\u5b66\u6a21\u5757\u3002</p>"},{"location":"design/renderer/","title":"RENDERER \u2014 \u8bbe\u8ba1\u8bf4\u660e\uff08\u8f7b\u91cf\uff09","text":"<p>\u672c\u6587\u4ef6\u63cf\u8ff0 Renderer \u7684\u804c\u8d23\u3001\u8f93\u5165\u8f93\u51fa\u4e0e\u6269\u5c55\u70b9\uff0c\u907f\u514d\u5199\u5165\u5177\u4f53 UI \u5b9e\u73b0\u7ec6\u8282\u3002</p>"},{"location":"design/renderer/#1","title":"1. \u89d2\u8272\u4e0e\u804c\u8d23","text":"<ul> <li>\u6d88\u8d39 <code>Timeline</code> \u5e76\u6309 Step \u987a\u5e8f\u6e32\u67d3\u3002</li> <li>\u53ea\u8d1f\u8d23\u201c\u753b\u9762\u8868\u73b0\u201d\uff0c\u4e0d\u6539\u5199 Model/SceneGraph \u72b6\u6001\u3002</li> <li>\u9075\u5b88 Ops \u534f\u8bae\uff0c\u4fdd\u6301\u8de8\u6e32\u67d3\u5668\u4e00\u81f4\u8bed\u4e49\u3002</li> </ul>"},{"location":"design/renderer/#2","title":"2. \u8f93\u5165\u8f93\u51fa","text":"<ul> <li>\u8f93\u5165\uff1a<code>Timeline</code>\uff08<code>AnimationStep</code> \u5217\u8868\uff09\u3002</li> <li>\u8f93\u51fa\uff1a\u53ef\u89c6\u72b6\u6001\uff08\u8282\u70b9/\u8fb9/\u6587\u672c/\u63d0\u793a\uff09\u3002</li> </ul>"},{"location":"design/renderer/#3","title":"3. \u7ea6\u675f\u4e0e\u8fb9\u754c","text":"<ul> <li>\u4e0d\u5f97\u53cd\u5411\u8bbf\u95ee Model \u6216 SceneGraph\u3002</li> <li>\u4e0d\u5f97\u76f4\u63a5\u64cd\u7eb5\u7ed3\u6784\u903b\u8f91\uff08\u53ea\u80fd\u6d88\u8d39 Ops\uff09\u3002</li> <li>\u5fc5\u987b\u652f\u6301 <code>SET_POS</code>\u3001<code>SET_STATE</code>\u3001CREATE/DELETE\u3001SET_LABEL\u3001\u6d88\u606f Ops\u3002</li> </ul>"},{"location":"design/renderer/#4-p06","title":"4. \u52a8\u753b\u63a7\u5236\uff08P0.6 \u57fa\u7ebf\uff09","text":"<ul> <li>\u652f\u6301\u57fa\u4e8e <code>duration_ms</code> \u7684\u57fa\u7840\u52a8\u753b\uff08\u7ebf\u6027\u63d2\u503c\u3001\u6de1\u5165\u6de1\u51fa\uff09\u3002</li> <li>\u652f\u6301\u5168\u5c40\u901f\u5ea6\u56e0\u5b50\u4e0e\u52a8\u753b\u5f00\u5173\u3002</li> <li>Step \u7c92\u5ea6\u64ad\u653e\uff0c\u4e0d\u652f\u6301 seek/\u5012\u64ad/skip\uff08\u540e\u7eed\u9636\u6bb5\u6269\u5c55\uff09\u3002</li> </ul>"},{"location":"design/renderer/#5-p07","title":"5. \u914d\u7f6e\u5316\uff08P0.7 \u589e\u91cf\uff09","text":"<ul> <li>RendererConfig\uff08\u5f53\u524d PySide6 \u5b9e\u73b0\uff09\uff1a</li> <li><code>node_radius</code>\uff1a\u9ed8\u8ba4 20</li> <li><code>colors</code>\uff1a\u72b6\u6001\u989c\u8272\u8868\uff08\u9ed8\u8ba4\u4e0e\u65e7\u7248\u4e00\u81f4\uff1anormal/active/highlight/secondary/to_delete/faded/error\uff09</li> <li><code>max_frames</code>\uff1a\u52a8\u753b\u5e27\u6570\u4e0a\u9650\uff08\u9ed8\u8ba4 10\uff0c\u4fdd\u6301\u539f\u884c\u4e3a\uff09</li> <li><code>show_messages</code>\uff1a\u662f\u5426\u6e32\u67d3 SET_MESSAGE/CLEAR_MESSAGE\uff08\u53ef\u7981\u7528\uff09</li> <li><code>easing</code>\uff1a\u5360\u4f4d\uff08\u5f53\u524d\u4ec5\u7ebf\u6027\uff09</li> <li>\u9ed8\u8ba4\u6784\u9020\u4fdd\u6301\u89c6\u89c9/\u963b\u585e\u64ad\u653e\u4e0d\u53d8\uff0c\u914d\u7f6e\u4e3a\u53ef\u9009\u6ce8\u5165\u3002</li> <li>\u6d88\u606f\u7b56\u7565\uff1aSET_MESSAGE \u9ed8\u8ba4\u951a\u5b9a\u573a\u666f bbox \u9876\u90e8\u5c45\u4e2d\uff08PySide6 \u57fa\u7ebf\uff09\uff0c\u82e5 show_messages=False \u5219\u5ffd\u7565\u6d88\u606f Ops\uff1b\u540e\u7eed\u53ef\u6309\u7ed3\u6784 bbox \u5b9a\u5236\u6216\u63d0\u4f9b\u5bcc\u63d0\u793a\u3002</li> </ul>"},{"location":"design/renderer/#6-p08","title":"6. \u5f62\u6001\u6269\u5c55\uff08P0.8 \u8ba1\u5212\uff09","text":"<ul> <li>\u5f62\u72b6\u4e0e\u5bb9\u5668\uff1a</li> <li>\u987a\u5e8f\u8868/\u6808\uff1a\u77e9\u5f62\u5355\u5143 + \u80cc\u666f\u201c\u6876\u201d\uff0c\u6808\u7ad6\u5411\u5806\u53e0\u3001\u987a\u5e8f\u8868\u6a2a\u5411\uff1b\u5f53\u524d PySide6 \u5df2\u652f\u6301 <code>shape=rect/bucket</code> \u6e32\u67d3\u4e0e\u63cf\u8fb9\u9ad8\u4eae\uff0c\u5c3a\u5bf8\u4f9d\u8d56\u6a21\u578b\u4f20\u5165\u7684 width/height\u3002</li> <li>Huffman\uff1a\u961f\u5217\u533a\u8282\u70b9\u53ef\u590d\u7528\u77e9\u5f62/\u5706\u5f62\uff0c\u9700\u80fd\u6807\u8bb0\u201c\u5019\u9009\u961f\u5217\u201d\u5bb9\u5668\uff1b\u6811\u533a\u4ecd\u7528\u6811\u8282\u70b9\u5f62\u6001\u3002</li> <li>Git DAG\uff1a\u5c0f\u5706\u70b9 + \u6807\u7b7e\uff0c\u652f\u6301 lane \u95f4\u6a2a\u5411\u504f\u79fb\uff0c\u53ef\u80fd\u9700\u8981 edge label \u6216\u8f7b\u91cf\u7bad\u5934\uff08\u5360\u4f4d\uff09\u3002</li> <li>\u6d88\u606f\u951a\u70b9\uff1a\u4fdd\u6301\u5168\u5c40 bbox \u9876\u90e8\uff0c\u4f46\u9700\u9884\u7559\u6309\u7ed3\u6784 bbox \u7684\u951a\u70b9\u4ee5\u51cf\u5c11\u906e\u6321\uff08\u4e0e UI \u6d88\u606f\u533a\u534f\u4f5c\uff09\u3002</li> <li>\u914d\u7f6e\uff1a\u901a\u8fc7 RendererConfig \u6216\u6309 kind \u7684\u6837\u5f0f registry \u6ce8\u5165\uff0c\u4e0d\u5f97\u786c\u7f16\u7801\u5728\u6a21\u578b/SceneGraph\u3002</li> <li>\u5bb9\u5668\u652f\u6301\uff1a\u77e9\u5f62\u5355\u5143\u4e0e\u6876\uff08bucket\uff09\u3001lane \u6807\u8bb0\u5747\u901a\u8fc7 CREATE_NODE \u7684 <code>shape</code>/<code>width</code>/<code>height</code> \u6e32\u67d3\uff1b\u72b6\u6001\u53d8\u66f4\u5bf9\u6876\u4ec5\u6539\u63cf\u8fb9\u8272\u3002</li> </ul>"},{"location":"design/renderer/#7","title":"7. \u6269\u5c55\u70b9","text":"<ul> <li>\u65b0 OpCode \u7684\u6e32\u67d3\uff1a\u5728 Renderer \u6dfb\u52a0 handler\uff0c\u4fdd\u6301\u9ed8\u8ba4\u56de\u9000\u3002</li> <li>\u65b0\u6837\u5f0f\u9700\u6c42\uff1a\u901a\u8fc7\u914d\u7f6e\uff08\u6216\u672a\u6765 StyleRegistry\uff09\u6309 <code>kind</code> \u9009\u62e9\u6837\u5f0f\u3002</li> <li>\u975e\u963b\u585e\u52a8\u753b\uff1a\u53ef\u5f15\u5165\u8c03\u5ea6\u5668\u6216 Qt Animation\uff0c\u4f46\u5fc5\u987b\u4fdd\u6301 Step \u8bed\u4e49\u4e0d\u53d8\uff08\u8ba1\u5212 P0.8\uff09\u3002</li> </ul>"},{"location":"design/renderer/#8-p07","title":"8. \u5f53\u524d\u9650\u5236\uff08P0.7\uff09","text":"<ul> <li>\u52a8\u753b\u4ecd\u4e3a\u540c\u6b65\u963b\u585e\u63d2\u503c\uff0c\u53ef\u80fd\u5bfc\u81f4 UI \u5361\u987f\uff1bmax_frames/easing \u4ec5\u5360\u4f4d\u3002</li> <li>\u6d88\u606f\u951a\u5b9a\u573a\u666f bbox\uff0c\u672a\u6309\u7ed3\u6784/\u8282\u70b9\u505a\u7cbe\u51c6\u5b9a\u4f4d\uff1b\u65e0\u5bcc\u63d0\u793a\u3002</li> <li>\u914d\u7f6e\u4e0e Layout \u672a\u8054\u52a8\uff08\u5c3a\u5bf8/\u95f4\u8ddd\u4ecd\u5728 SimpleLayout/TreeLayout \u5185\u786c\u7f16\u7801\uff09\u3002</li> </ul> <p>\u4ea4\u53c9\u5f15\u7528\uff1aOps \u534f\u8bae\u89c1 <code>ops_spec.md</code>\uff0cStyle/Metrics \u7ea6\u675f\u89c1 <code>architecture.md</code> \u7b2c 7 \u8282\u3002</p>"},{"location":"design/requirements/","title":"REQUIREMENTS \u2014 \u9879\u76ee\u9700\u6c42\u4e0e\u76ee\u6807\u8bf4\u660e","text":""},{"location":"design/requirements/#1","title":"1. \u8bfe\u7a0b\u8bbe\u8ba1\u9898\u76ee\u6458\u8981","text":"<p>\u8bfe\u7a0b\u9898\u76ee\uff1a\u7ebf\u6027\u4e0e\u6811\u5f62\u6570\u636e\u7ed3\u6784\u7684\u53ef\u89c6\u5316\u6a21\u62df\u5668</p> <p>\u8981\u6c42\u8981\u70b9\uff1a</p> <ul> <li>\u901a\u8fc7\u56fe\u5f62\u754c\u9762\uff08\u975e\u63a7\u5236\u53f0\uff09\u52a8\u6001\u5c55\u793a\u4ee5\u4e0b\u7ed3\u6784\u4e0e\u7b97\u6cd5\u7684\u6784\u5efa\u4e0e\u64cd\u4f5c\u8fc7\u7a0b\uff1a</li> <li>\u7ebf\u6027\u7ed3\u6784<ul> <li>\u987a\u5e8f\u8868\u3001\u94fe\u8868\uff1a\u6784\u5efa\u3001\u63d2\u5165\u3001\u5220\u9664</li> <li>\u6808\uff1a\u6784\u5efa\u3001\u5165\u6808\u3001\u51fa\u6808</li> </ul> </li> <li>\u6811\u7ed3\u6784<ul> <li>\u4e8c\u53c9\u6811\uff1a\u94fe\u5f0f\u5b58\u50a8\u7ed3\u6784\u6784\u5efa</li> <li>\u4e8c\u53c9\u641c\u7d22\u6811\uff08BST\uff09\uff1a\u6784\u5efa\u3001\u67e5\u627e\u3001\u5220\u9664</li> <li>\u54c8\u592b\u66fc\u6811\uff1a\u6784\u5efa\u8fc7\u7a0b</li> </ul> </li> <li>\u5e03\u5c40\u826f\u597d\u3001\u4fe1\u606f\u5b8c\u6574\u7684\u53ef\u89c6\u5316\u5c55\u793a</li> </ul> <p>\u6269\u5c55\u8981\u6c42\uff08\u9009\u505a\uff09\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\uff1a</p> <ul> <li>\u4fdd\u5b58\u4e0e\u52a0\u8f7d\u5df2\u7ed8\u5236\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5e76\u652f\u6301\u518d\u6b21\u7f16\u8f91</li> <li>AVL \u6811\u6784\u5efa\u4e0e\u5e73\u8861\u65cb\u8f6c\u8c03\u6574\u8fc7\u7a0b\u7684\u5c55\u793a</li> <li>\u4f7f\u7528\u81ea\u5b9a\u4e49 DSL \u63cf\u8ff0\u6570\u636e\u7ed3\u6784\u5e76\u81ea\u52a8\u7ed8\u5236</li> <li>\u5229\u7528 LLM \u63a5\u6536\u81ea\u7136\u8bed\u8a00\u63cf\u8ff0\u5e76\u751f\u6210\u76f8\u5e94\u6570\u636e\u7ed3\u6784\u4e0e\u64cd\u4f5c</li> </ul> <p>\u8bfe\u7a0b\u8981\u6c42\u8fd8\u5f3a\u8c03\uff1a</p> <ul> <li>\u4e1a\u52a1\u903b\u8f91\uff08\u6570\u636e\u7ed3\u6784\u4e0e\u7b97\u6cd5\uff09\u5e94\u4e0e UI \u5206\u79bb\uff0c\u5efa\u8bae\u91c7\u7528 MV/MVC \u7b49\u6a21\u5f0f\u3002</li> <li>DSL \u89e3\u6790\u53ef\u4f7f\u7528 Lexer/Parser \u6846\u67b6\uff0c\u5982 ANTLR \u7b49\u3002</li> </ul>"},{"location":"design/requirements/#2","title":"2. \u672c\u9879\u76ee\u5728\u8bfe\u7a0b\u8981\u6c42\u4e0a\u7684\u6269\u5c55","text":"<p>\u5728\u6ee1\u8db3\u8bfe\u7a0b\u8981\u6c42\u7684\u57fa\u7840\u4e0a\uff0c\u672c\u9879\u76ee\u989d\u5916\u76ee\u6807\uff1a</p> <ol> <li>\u6784\u5efa\u4e00\u4e2a\u53ef\u6269\u5c55\u7684\u6570\u636e\u7ed3\u6784\u53ef\u89c6\u5316\u5f15\u64ce\uff0c\u800c\u975e\u4e00\u6b21\u6027 Demo \u7a0b\u5e8f\u3002</li> <li>\u660e\u786e\u5206\u5c42\uff1a</li> <li>\u6570\u636e\u7ed3\u6784\u6a21\u578b\uff08Model\uff09</li> <li>\u573a\u666f\u7ba1\u7406\u4e0e\u7edf\u4e00\u547d\u4ee4\uff08SceneGraph + Command\uff09</li> <li>\u62bd\u8c61\u52a8\u753b\u6307\u4ee4\uff08AnimationOps + Timeline\uff09</li> <li>\u6e32\u67d3\u5668\uff08PySide6 / \u672a\u6765 Web\uff09</li> <li>UI / DSL / Persistence</li> <li>\u652f\u6301\u6559\u5b66\u7ea7\u52a8\u753b\uff1a\u5bf9\u64cd\u4f5c\u8fc7\u7a0b\u8fdb\u884c\u5fae\u6b65\u9aa4\u62c6\u5206\uff08micro-steps\uff09\uff0c\u4fbf\u4e8e\u8bb2\u89e3\u4e0e\u7406\u89e3\u3002</li> <li>\u9884\u7559 DSL \u548c LLM \u96c6\u6210\u80fd\u529b\uff1a</li> <li>DSL \u5c06\u9ad8\u5c42\u64cd\u4f5c\u63cf\u8ff0\u4e3a\u547d\u4ee4\uff0c\u4ea4\u7531 SceneGraph \u548c Model \u6267\u884c\u3002</li> <li>LLM \u5c06\u81ea\u7136\u8bed\u8a00\u8f6c\u6362\u4e3a DSL \u6216 Command \u5e8f\u5217\u3002</li> <li>\u589e\u52a0\u4e00\u4e2a Git \u63d0\u4ea4\u56fe\u53ef\u89c6\u5316\u4e0e\u6559\u5b66\u6a21\u5757\uff1a    \u672c\u6a21\u5757\u4e0d\u5b9e\u73b0\u771f\u5b9e Git \u5ba2\u6237\u7aef\uff0c\u800c\u662f\u6784\u5efa\u4e00\u4e2a\u7b80\u5316\u7684 Git \u5185\u90e8\u6570\u636e\u7ed3\u6784\u6a21\u578b\uff08GitGraph\uff09\u3002    \u52a8\u753b\u4ec5\u6f14\u793a Git \u5185\u90e8\u7684\u7ed3\u6784\u53d8\u5316\uff0c\u5305\u62ec\uff1a</li> <li>commit DAG\uff08\u7236\u5b50\u5173\u7cfb\uff09</li> <li>HEAD\u3001branch ref \u7684\u79fb\u52a8</li> <li>merge \u4ea7\u751f\u7684\u53cc\u7236\u8282\u70b9    \u4e3a\u4f7f\u8be5\u6a21\u5757\u5177\u5907\u6559\u5b66\u4ef7\u503c\uff0c\u5c06\u652f\u6301\u4e00\u7ec4\u201c\u865a\u62df Git \u64cd\u4f5c\u201d\u547d\u4ee4\uff08\u4e0d\u4e0e\u672c\u5730\u4ed3\u5e93\u4ea4\u4e92\uff09\uff1a</li> <li>git init</li> <li>git commit -m \"\" <li>git branch  <li>git checkout  <li>git merge \uff08\u7b80\u5316\u7248\uff0c\u65e0\u51b2\u7a81\uff09    \u6240\u6709\u865a\u62df Git \u547d\u4ee4\u5c06\u901a\u8fc7 DSL \u6216 UI \u8f6c\u6362\u4e3a\u5185\u90e8 Command\uff0c\u7531 SceneGraph \u548c GitGraphModel     \u6267\u884c\u5e76\u8fd4\u56de AnimationOps\u3002    \u8be5\u529f\u80fd\u65e8\u5728\u5c55\u793a Git \u5185\u90e8\u6570\u636e\u7ed3\u6784\u4e0e\u6307\u9488\u79fb\u52a8\u7684\u6559\u5b66\u52a8\u753b\u4ee5\u53ca\u672c\u9879\u76ee\u826f\u597d\u7684\u6269\u5c55\u6027\uff0c\u800c\u975e\u5b9e\u73b0\u6587\u4ef6\u7cfb\u7edf\u5c42\u9762\u7684 Git \u884c\u4e3a\u3002"},{"location":"design/requirements/#3-v01-v02","title":"3. \u529f\u80fd\u8303\u56f4\uff08v0.1 \u548c v0.2\uff09","text":""},{"location":"design/requirements/#31-v01","title":"3.1 v0.1 \u5fc5\u505a\u529f\u80fd","text":"<ul> <li>\u987a\u5e8f\u8868\u3001\u94fe\u8868\u3001\u6808\uff1a\u6784\u5efa + \u64cd\u4f5c\u52a8\u753b</li> <li>BST\uff1a\u6784\u5efa + \u67e5\u627e\u3001\u5220\u9664</li> <li>Huffman Tree\uff1a\u6784\u5efa\u52a8\u753b</li> <li>\u57fa\u672c SceneGraph\uff08\u5355\u573a\u666f + \u5355\u6570\u636e\u7ed3\u6784\uff09</li> <li>\u57fa\u672c PySide6 Renderer\uff08QGraphicsView \u6846\u67b6 + \u8282\u70b9/\u8fb9\u6e32\u67d3\uff09</li> <li>\u57fa\u7840 Persistence\uff08\u4fdd\u5b58\u5f53\u524d\u6570\u636e\u7ed3\u6784\u72b6\u6001\uff09</li> <li>Git DAG\uff1acommit \u65b0\u8282\u70b9 + HEAD \u5207\u6362 \u7684\u57fa\u672c\u52a8\u753b</li> </ul>"},{"location":"design/requirements/#32-v02","title":"3.2 v0.2 \u6269\u5c55","text":"<ul> <li>AVL \u6811\uff1a\u5e73\u8861\u68c0\u6d4b + \u65cb\u8f6c\u52a8\u753b</li> <li>DSL\uff1a\u6587\u672c\u8bed\u6cd5 \u2192 Command \u5e8f\u5217</li> <li>Git \u6559\u5b66\u64cd\u4f5c\u52a8\u753b\uff08\u865a\u62df Git \u5b50\u96c6\uff09\uff1a</li> <li>git init / commit / branch / checkout / merge \u7684\u7ed3\u6784\u53d8\u5316\u52a8\u753b</li> <li>\u652f\u6301\u901a\u8fc7 DSL \u811a\u672c\u6267\u884c Git \u6559\u5b66\u5e8f\u5217</li> <li>\u652f\u6301\u7279\u6b8a\u7684Persistence\uff08\u4f8b\u5982\u5bfc\u5165<code>.git</code> repo\uff09</li> <li>SceneGraph\uff1a\u591a\u6570\u636e\u7ed3\u6784\u540c\u573a\u666f</li> <li>Persistence\uff1a\u4fdd\u5b58\u52a8\u753b\u5386\u53f2 / \u56de\u653e</li> </ul>"},{"location":"design/requirements/#4","title":"4. \u975e\u76ee\u6807\uff08\u5f53\u524d\u9636\u6bb5\u4e0d\u505a\uff09","text":"<p>\u4ee5\u4e0b\u5185\u5bb9\u6682\u4e0d\u5728\u5f53\u524d\u8bfe\u8bbe\u8303\u56f4\u5185\uff1a</p> <ul> <li>\u5b8c\u6574\u7684 Git \u5ba2\u6237\u7aef\u529f\u80fd\uff08commit\u3001rebase\u3001merge \u7b49\u5b9e\u9645 Git \u64cd\u4f5c\uff09\u3002</li> <li>\u5206\u5e03\u5f0f\u573a\u666f\u540c\u6b65\u3001\u591a\u7528\u6237\u534f\u4f5c\u3002</li> <li>\u9488\u5bf9\u8d85\u5927\u578b\u6570\u636e\u96c6\uff08&gt; \u6570\u5343\u8282\u70b9\uff09\u7684\u6027\u80fd\u4f18\u5316\u3002</li> <li>\u6240\u6709\u6570\u636e\u7ed3\u6784\u7684\u4e25\u8083\u6027\u80fd benchmark\u3002</li> </ul> <p>\u8fd9\u4e9b\u5185\u5bb9\u53ef\u5728\u8bfe\u7a0b\u7ed3\u675f\u540e\u4f5c\u4e3a\u957f\u671f\u4f18\u5316\u65b9\u5411\u8003\u8651\u3002</p>"},{"location":"design/scene_graph/","title":"SCENE_GRAPH \u2014 \u8bbe\u8ba1\u8bf4\u660e","text":"<p>\u672c\u6587\u4ef6\u63cf\u8ff0 SceneGraph \u7684\u804c\u8d23\u8fb9\u754c\u3001\u6307\u4ee4\u89e3\u6790\u903b\u8f91\u4e0e\u6269\u5c55\u70b9\u3002</p>"},{"location":"design/scene_graph/#1","title":"1. \u89d2\u8272\u4e0e\u804c\u8d23","text":"<ul> <li>\u751f\u547d\u5468\u671f\u7ba1\u7406\uff1a\u7ef4\u62a4\u573a\u666f\u4e2d\u6240\u6709\u7ed3\u6784\u5b9e\u4f8b\uff08\u6309 <code>structure_id</code> \u7ba1\u7406\uff09\u3002</li> <li>\u6307\u4ee4\u5206\u53d1\uff1a\u63a5\u6536 <code>Command</code>\uff0c\u6267\u884c Late-binding \u7c7b\u578b\u89e3\u6790\uff0c\u5e76\u8def\u7531\u5230 Model\u3002</li> <li>\u6d41\u6c34\u7ebf\u4e32\u8054\uff1aModel (\u7ed3\u6784 Ops) -&gt; Layout (\u4f4d\u7f6e Ops) -&gt; Renderer (\u64ad\u653e)\u3002</li> <li>\u72b6\u6001\u5bfc\u51fa\uff1a\u63d0\u4f9b\u5f53\u524d\u573a\u666f\u6240\u6709\u7ed3\u6784\u7684\u6307\u4ee4\u5e8f\u5217\uff0c\u652f\u6301\u6301\u4e45\u5316\u3002</li> </ul>"},{"location":"design/scene_graph/#2-late-binding-v061","title":"2. \u6307\u4ee4\u89e3\u6790\u4e0e Late-binding (v0.6.1)","text":"<p>\u4e3a\u4e86\u652f\u6301 DSL \u7684\u7075\u6d3b\u6027\uff0cSceneGraph \u5b9e\u73b0\u4e86\u5ef6\u8fdf\u7c7b\u578b\u7ed1\u5b9a\uff1a - \u81ea\u52a8\u8865\u5168 kind\uff1a\u5982\u679c <code>Command.payload</code> \u4e2d\u7f3a\u5c11 <code>kind</code> \u5b57\u6bb5\uff0cSceneGraph \u4f1a\u5c1d\u8bd5\u4ece\u5df2\u5b58\u5728\u7684\u7ed3\u6784\u4e2d\u67e5\u627e\u8be5 ID \u5bf9\u5e94\u7684\u7c7b\u578b\u5e76\u81ea\u52a8\u8865\u5168\u3002 - \u6821\u9a8c\u65f6\u673a\uff1a\u5728\u8865\u5168 <code>kind</code> \u540e\uff0cSceneGraph \u4f1a\u8c03\u7528 <code>SCHEMA_REGISTRY</code> \u8fdb\u884c\u4e25\u683c\u7684\u5b57\u6bb5\u6821\u9a8c\u3002 - \u521b\u5efa\u7ea6\u675f\uff1a<code>CREATE_STRUCTURE</code> \u6307\u4ee4\u5fc5\u987b\u663e\u5f0f\u63d0\u4f9b <code>kind</code>\u3002</p>"},{"location":"design/scene_graph/#3","title":"3. \u5e03\u5c40\u8def\u7531\u4e0e\u5206\u533a","text":"<ul> <li>\u7b56\u7565\u8def\u7531\uff1a\u6839\u636e <code>kind</code> \u81ea\u52a8\u9009\u62e9\u5e03\u5c40\u7b56\u7565\uff08\u5982 <code>list -&gt; LINEAR</code>, <code>bst -&gt; TREE</code>\uff09\u3002</li> <li>\u81ea\u52a8\u504f\u79fb\uff1a\u4e3a\u6bcf\u4e2a\u7ed3\u6784\u5206\u914d <code>(dx, dy)</code> \u504f\u79fb\uff0c\u9632\u6b62\u591a\u4e2a\u7ed3\u6784\u5728\u573a\u666f\u4e2d\u91cd\u53e0\u3002</li> </ul>"},{"location":"design/scene_graph/#4","title":"4. \u6269\u5c55\u70b9","text":"<ul> <li>\u65b0\u589e\u6a21\u578b\uff1a\u5b9e\u73b0 <code>BaseModel</code> \u5e76\u901a\u8fc7 <code>register_model_factory</code> \u6ce8\u518c\u3002</li> <li>\u65b0\u589e\u547d\u4ee4\uff1a\u5728 <code>command_schema.py</code> \u4e2d\u6ce8\u518c <code>CommandType + kind</code> \u7684\u6620\u5c04\u3002</li> </ul>"},{"location":"design/scene_graph/#5","title":"5. \u9519\u8bef\u5904\u7406","text":"<ul> <li>CommandError\uff1a\u6821\u9a8c\u5931\u8d25\u6216\u6307\u4ee4\u975e\u6cd5\u65f6\u629b\u51fa\u3002</li> <li>ModelError\uff1a\u6a21\u578b\u903b\u8f91\u9519\u8bef\uff08\u5982\u7a7a\u6808\u5f39\u51fa\uff09\u65f6\u629b\u51fa\uff0c\u7531 UI \u6355\u83b7\u5e76\u5c55\u793a\u3002</li> </ul>"},{"location":"diagrams/","title":"Diagrams","text":""},{"location":"diagrams/#immport-dependency-graph","title":"Immport Dependency Graph","text":"<p>\u4e0b\u56fe\u662f pydeps \u4ece\u6e90\u7801\u81ea\u52a8\u751f\u6210, \u5c55\u793a\u6a21\u5757\u95f4\u7684import\u4f9d\u8d56\u5173\u7cfb(max-bacon=2), \u53ef\u4ee5\u68c0\u67e5\u67b6\u6784\u5c42\u7ea7\u95f4\u7684\u4f9d\u8d56\u8bbe\u8ba1.</p> <p>\u6267\u884c\u7684\u547d\u4ee4\u4e3a: <pre><code>uv run pydeps src/ds_vis \\\n --noshow \\\n --max-bacon=2 \\\n --cluster \\\n -T svg \\\n -o docs/diagrams/imports.svg\n</code></pre></p> <p></p> <p>\u4f7f\u7528<code>scripts/arch_graph.py</code>\u751f\u6210\u7684\u6548\u679c. (outdated)</p> <pre><code>graph TD\n    classDef default fill:#f9f9f9,stroke:#333,stroke-width:2px;\n    classDef core fill:#e1f5fe,stroke:#01579b;\n    classDef protocol fill:#f3e5f5,stroke:#4a148c,stroke-dasharray: 5 5;\n    UI_Layer[\"UI (Window)\"]\n    Renderer_Layer[\"Renderers (PySide6)\"]\n    Scene_Layer[\"SceneGraph (Coordinator)\"]:::core\n    Models_Layer[\"Models (Data Structure)\"]:::core\n    Layout_Layer[\"Layout Engine\"]\n    Ops_Protocol[\"Ops (Protocol)\"]:::protocol\n    DSL_Layer[\"DSL / Parser\"]</code></pre>"},{"location":"diagrams/#uml-pyreverse","title":"UML (pyreverse)","text":"<p>\u4e0b\u56fe\u662f pyreverse(from pylint) \u4ece\u6e90\u7801\u81ea\u52a8\u751f\u6210\uff0c\u5c55\u793aUML\u56fe</p> <p>\u6267\u884c\u7684\u6307\u4ee4\u4e3a\uff1a <pre><code>uv run pyreverse -o dot -p ds_vis src/ds_vis -d docs/diagrams/uml\ndot -Grankdir=LR -Tsvg docs/diagrams/uml/classes_ds_vis.dot -o docs/diagrams/uml/classes_ds_vis.svg\n# \u6b63\u5e38\u7248\u672c\u7684UML\ndot -Tsvg docs/diagrams/uml/classes_ds_vis.dot -o docs/diagrams/uml/classes_ds_vis.td.svg\ndot -Tsvg docs/diagrams/uml/packages_ds_vis.dot -o docs/diagrams/uml/packages_ds_vis.svg\n</code></pre></p>"},{"location":"diagrams/#packages","title":"Packages","text":""},{"location":"diagrams/#classes","title":"Classes","text":""},{"location":"diagrams/#runtime-call-graph","title":"Runtime Call Graph","text":"<p>\u8be5\u56fe\u7531 cProfile + gprof2dot + graphviz \u4ece\u4e00\u6b21\u201c\u6700\u5c0f\u6848\u4f8b\u8fd0\u884c\u201d\u81ea\u52a8\u751f\u6210\uff0c \u7528\u4e8e\u63d0\u4f9b\u8fd0\u884c\u65f6\u8bc1\u636e\uff08\u6267\u884c\u8def\u5f84\u4e0e\u70ed\u70b9\uff09\u3002</p> <p>\u6267\u884c\u6307\u4ee4\uff1a <pre><code>uv run python -m cProfile -o docs/diagrams/profile/case.pstats tools/profile_case.py\nuv run gprof2dot -f pstats docs/diagrams/profile/case.pstats &gt; docs/diagrams/profile/case.dot\ndot -Tsvg docs/diagrams/profile/case.dot -o docs/diagrams/profile/callgraph.svg\n</code></pre></p> <p></p>"},{"location":"engineering/dev_kb/","title":"Developer Knowledge Base (FAQ &amp; Troubleshooting)","text":"<p>Purpose: This document serves as a shared \"long-term memory\" for Developers and Agents. Rule: If you solve a tricky environment issue, clarify a confusing architectural point, or identify a persistent limitation, record it here.</p>"},{"location":"engineering/dev_kb/#1-troubleshooting-environment-tools","title":"1. Troubleshooting (Environment &amp; Tools)","text":""},{"location":"engineering/dev_kb/#q-uv-run-mypy-fails-with-module-not-found-or-import-errors","title":"Q: <code>uv run mypy</code> fails with \"Module not found\" or import errors","text":"<p>A: 1. Ensure you are running commands from the project root. 2. Run <code>uv sync</code> to ensure the virtual environment is up to date. 3. Check if <code>src</code> is correctly recognized. <code>pyproject.toml</code> should have <code>pythonpath = [\"src\"]</code> in the pytest config, but mypy relies on its own config. We have <code>[tool.mypy]</code> configured to be strict.</p>"},{"location":"engineering/dev_kb/#q-tests-fail-with-modulenotfounderror-no-module-named-ds_vis","title":"Q: Tests fail with <code>ModuleNotFoundError: No module named 'ds_vis'</code>","text":"<p>A: Always use <code>uv run pytest</code>. This ensures the <code>src</code> directory is in the <code>PYTHONPATH</code>. Do not run <code>pytest</code> directly unless you have manually activated the venv.</p>"},{"location":"engineering/dev_kb/#q-uv-run","title":"Q: <code>uv run ...</code> \u62a5\u9519\u65e0\u6743\u9650\u8bbf\u95ee\u5168\u5c40\u7f13\u5b58","text":"<p>A: \u5728\u672c\u4ed3\u5e93\u4f7f\u7528\u672c\u5730\u7f13\u5b58\u76ee\u5f55\uff0c\u793a\u4f8b\uff1a <pre><code>UV_CACHE_DIR=./tmp/uv-cache uv run pytest\n</code></pre></p>"},{"location":"engineering/dev_kb/#q-ui-step","title":"Q: UI \u6d4b\u8bd5\u91cc\u624b\u52a8\u63a8\u8fdb step \u4f1a\u5bfc\u81f4\u7ed3\u679c\u4e0d\u7a33\u5b9a\uff1f","text":"<p>A: \u4f7f\u7528 <code>MainWindow._advance_step(schedule_next=False)</code> \u6765\u63a8\u8fdb\u6b65\u9aa4\uff0c\u907f\u514d\u5728\u6e32\u67d3\u540c\u6b65\u52a8\u753b (<code>qWait</code>) \u65f6\u91cd\u65b0\u542f\u52a8\u5b9a\u65f6\u5668\u5bfc\u81f4\u6b65\u8fdb\u9519\u4f4d\u3002</p>"},{"location":"engineering/dev_kb/#2-architecture-faq","title":"2. Architecture FAQ","text":""},{"location":"engineering/dev_kb/#q-why-cant-the-model-return-set_pos-ops","title":"Q: Why can't the Model return <code>SET_POS</code> ops?","text":"<p>A: To enforce Separation of Concerns. - Models (BST, List) handle Logical Topology (who is connected to whom). - Layouts handle Visual Geometry (where they are on screen). - Renderers handle Drawing (pixels/vectors). If a Model decides positions, we cannot easily swap layouts (e.g., switching from Tree Layout to Radial Layout) or reuse the Model for a CLI output.</p>"},{"location":"engineering/dev_kb/#q-how-do-i-add-a-new-animation-operation","title":"Q: How do I add a new Animation Operation?","text":"<p>A: 1. Add the enum member to <code>OpCode</code> in <code>src/ds_vis/core/ops/ops.py</code>. 2. Update <code>docs/design/ops_spec.md</code> to define its payload structure. 3. Update <code>docs/index.md</code> version for OPS_SPEC. 4. Implement handling in the Renderer.</p>"},{"location":"engineering/dev_kb/#3-known-issues-technical-debt-active","title":"3. Known Issues &amp; Technical Debt (Active)","text":"<p>Agents: Before attempting to \"fix\" a bug, check if it's a known limitation.</p> <ul> <li>[Limitation][Layout] SimpleLayout \u4ecd\u4e3a\u6709\u72b6\u6001\u987a\u5e8f\u5f15\u64ce\uff0c\u4e0d\u652f\u6301 seek/\u5012\u64ad\uff1b\u9ed8\u8ba4\u5de6\u5bf9\u9f50\u4e0e\u56fa\u5b9a\u5c3a\u5bf8\u5047\u8bbe\uff0c\u672a\u652f\u6301\u6811/DAG \u5c45\u4e2d\u6216\u53ef\u53d8\u5c3a\u5bf8\u3002</li> <li>[Limitation][Renderer] PySide6 renderer \u786c\u7f16\u7801\u914d\u8272/\u5f62\u72b6\uff1b\u52a8\u753b\u4e3a\u540c\u6b65\u63d2\u503c\uff08qWait\uff09\uff0c\u65e0 seek/skip/\u5f02\u6b65\u8c03\u5ea6\uff0c\u7f13\u52a8\u56fa\u5b9a\u3002</li> <li>[Risk][IDs] ID \u7a33\u5b9a\u6027\u4ec5\u5728 list \u8986\u76d6\uff1b\u5176\u4ed6\u7ed3\u6784\u4ecd\u57fa\u4e8e\u7d22\u5f15\uff0c\u53d8\u66f4\u4f1a\u5bfc\u81f4\u91cd\u547d\u540d\u3002</li> <li>[Limitation][Commands] \u76ee\u524d\u4ec5\u8986\u76d6 list \u7684 CREATE_STRUCTURE/DELETE_STRUCTURE/DELETE_NODE/INSERT/SEARCH/UPDATE\uff1b\u6269\u5c55 BST/GitGraph \u9700\u8865\u6ce8\u518c\u8868\u4e0e\u6a21\u578b op\u3002</li> <li>[Limitation][UI] Main window \u4ec5 Dev playground\uff1a\u5355\u573a\u666f\uff0c\u65e0 seek/skip/\u591a\u65f6\u95f4\u7ebf\u7ba1\u7406\u3002</li> <li>[Gap][Tests] timing \u8bed\u4e49\u3001BST/GitGraph ops\u3001\u6e32\u67d3\u65f6\u5e8f\u4ecd\u7f3a\u8986\u76d6\u3002</li> <li>[Stub][Models] BST/GitGraph models \u4ecd\u4e3a\u7a7a\u58f3\uff1b\u4ec5 list create/delete/insert \u5b9e\u73b0\u3002</li> <li>[Limitation][AnimationDepth] \u4ecd\u7f3a\u53ef\u914d\u7f6e\u7f13\u52a8/\u975e\u963b\u585e\u64ad\u653e\uff1b\u64ad\u653e\u63a7\u5236\u4e3a\u57fa\u7840\u7248\u3002</li> <li>[Note][ListModel] <code>create([])</code> \u4f1a\u751f\u6210 sentinel \u4ec5\u7528\u4e8e\u53ef\u89c6\u5316\u7a7a\u8868\uff08display-only\uff09\uff0c\u5f53\u524d\u5047\u8bbe\u7a7a\u8868\u7528\u4e8e\u5c55\u793a\u800c\u975e\u903b\u8f91\u64cd\u4f5c\u3002</li> <li>[Note][ListModel] <code>insert</code> \u73b0\u5305\u542b\u904d\u5386\u9ad8\u4eae\uff08secondary\uff09\u3001\u65e7\u8fb9\u6807\u8bb0\u4e3a to_delete\u3001\u65b0\u8fb9/\u5173\u952e\u8282\u70b9\u7528 highlight\uff0c\u5e76\u4f7f\u7528 step label \u4fbf\u4e8e UI/\u6d4b\u8bd5\u5b9a\u4f4d\uff1binsert/update/search \u4f1a\u5728\u6b65\u9aa4\u524d\u540e\u7528 SET_MESSAGE\uff0c\u64cd\u4f5c\u7ed3\u675f CLEAR_MESSAGE\u3002</li> <li>[Gap][Animation] \u8fb9\u52a8\u753b\uff08\u9010\u6e10\u7ed8\u5236/\u865a\u7ebf\u5220\u9664\uff09\u672a\u5b9e\u73b0\uff1b\u8282\u70b9\u201c\u4fa7\u8fb9\u60ac\u505c\u201d\u6807\u8bb0\u4e3a Layout \u4f4e\u4f18\u5148\u9700\u6c42\u3002</li> <li>[Risk][Ops] <code>CREATE_NODE.data.kind</code> \u76ee\u524d\u672a\u5f3a\u5236\u5fc5\u586b\uff0cRenderer/Layout \u9700\u9ed8\u8ba4\u56de\u9000\u6837\u5f0f\uff1b\u53ef\u8003\u8651\u52a0\u5165\u544a\u8b66\u6216\u6587\u6863\u5f3a\u5316\u4e3a\u201c\u5f3a\u70c8\u5efa\u8bae\u5fc5\u586b\u201d\u3002</li> <li>[Design][Metrics] \u4e0d\u540c\u7ed3\u6784\u8282\u70b9\u5f62\u6001\u4e0e\u5ea6\u91cf\u5dee\u5f02\u660e\u663e\uff08seqlist/stack/tree\uff09\uff1b\u5efa\u8bae\u5f15\u5165\u53ef\u9009 <code>StyleRegistry</code>/<code>Metrics</code>\uff08<code>kind -&gt; shape/size</code>\uff09\uff0c\u6709\u9ed8\u8ba4\u503c\uff0c\u907f\u514d\u65b0 Model \u5fc5\u987b\u7ba1\u7406\u5e03\u5c40/\u6e32\u67d3\u3002</li> <li>[Design][Layout] SimpleLayout \u7684\u56fa\u5b9a spacing \u5047\u8bbe\u53ef\u80fd\u4e0e\u6e32\u67d3\u5c3a\u5bf8\u4e0d\u5339\u914d\uff1b\u5e94\u5c06\u5c3a\u5bf8/\u95f4\u8ddd\u7531\u914d\u7f6e\u9a71\u52a8\uff0c\u5e03\u5c40\u4e0d\u8bfb\u53d6 renderer\u3002</li> <li>[Idea][Containers] \u53ef\u5728 Renderer \u5c42\u6309 <code>structure_id</code> \u7ed8\u5236\u5bb9\u5668\u6846\uff08\u534a\u900f\u660e\u80cc\u666f+\u5706\u89d2\u8fb9\u6846\uff09\uff0c\u65e0\u9700\u65b0\u589e Ops\uff1b\u7528\u4e8e\u591a\u7ed3\u6784\u540c\u5c4f\u53ef\u89c6\u5206\u533a\u3002\u53ef\u9009\u66ff\u4ee3\u65b9\u6848\uff1a\u591a\u7a97\u53e3\u5c55\u793a\u4ee5\u89c4\u907f\u5e03\u5c40\u51b2\u7a81\u3002</li> <li>[Strategy][Tests] \u6d4b\u8bd5\u901f\u5ea6\u4e0e\u52a8\u753b\u9a8c\u8bc1\u5e73\u8861\uff1a\u9ed8\u8ba4\u7981\u7528\u52a8\u753b\u4ee5\u89c4\u907f <code>qWait</code> \u5ef6\u8fdf\uff1b\u5173\u952e\u52a8\u753b\u5192\u70df\u6d4b\u8bd5\uff08\u63d2\u503c/\u6de1\u5165\u6de1\u51fa\uff09\u5fc5\u987b\u5f00\u542f\u4f46\u4f7f\u7528\u6781\u77ed <code>duration_ms</code> (10ms)\uff1bUI \u6d41\u7a0b\u6d4b\u8bd5\u5f00\u542f\u9ad8\u500d\u901f (100x) \u9a8c\u8bc1\u7a33\u5b9a\u6027\u3002\u4fee\u6539\u6e32\u67d3\u903b\u8f91\u987b\u786e\u4fdd\u8fd9\u4e9b\u6d4b\u8bd5\u901a\u8fc7\u4ee5\u9632\u89c6\u89c9\u6f02\u79fb\u3002</li> <li>[Usage][DSL/CLI/UI] DSL \u5df2\u652f\u6301\u6587\u672c\u8bed\u6cd5\uff08\u5982 <code>list L1 = [1,2]</code>\uff09\u4e0e <code>#</code> \u6ce8\u91ca\u3002UI \u63a7\u5236\u9762\u677f\u65b0\u589e Interactive DSL \u6309\u94ae\uff0c\u652f\u6301\u5b9e\u65f6\u6307\u4ee4\u6ce8\u5165\u3002</li> <li>[Feature][Late-binding] SceneGraph \u652f\u6301\u5ef6\u8fdf\u7c7b\u578b\u7ed1\u5b9a\uff0cDSL \u6307\u4ee4\u53ef\u7701\u7565 <code>kind</code>\uff0c\u7cfb\u7edf\u81ea\u52a8\u6839\u636e <code>structure_id</code> \u8865\u5168\u3002</li> <li>[Persistence][JSON] \u652f\u6301\u573a\u666f\u7ea7\u5bfc\u5165\u5bfc\u51fa\uff0c\u89e3\u51b3\u4e86 Git/Huffman \u5e03\u5c40\u5e72\u6270\u95ee\u9898\u3002</li> <li>[Limits][LLM] <code>LLMAdapter</code> \u4ecd\u4e3a\u63a5\u53e3\u5360\u4f4d\uff0c\u5c1a\u672a\u63a5\u5165\u771f\u5b9e\u6a21\u578b\u3002</li> <li>[Layout][Tree Placeholder] \u6811\u6a21\u578b\u5f53\u524d\u590d\u7528\u7ebf\u6027 SimpleLayout \u884c\u5806\u53e0\uff0c\u4ec5\u7528\u4e8e\u5192\u70df\uff1b\u591a\u7ed3\u6784\u6df7\u6392\u53ef\u80fd\u89c6\u89c9\u62e5\u6324\u3002\u5f15\u5165\u771f\u6b63\u6811\u5e03\u5c40\u6216\u5206\u533a\u524d\uff0c\u5efa\u8bae\u5728 Dev Hook/CLI \u4e2d\u5355\u72ec\u6f14\u793a\u6811\uff0c\u6216\u5728 UI \u7981\u7528\u52a8\u753b+\u9ad8\u500d\u901f\u3002</li> </ul>"},{"location":"engineering/environment/","title":"ENVIRONMENT \u2014 \u5f00\u53d1\u4e0e\u8fd0\u884c\u73af\u5883\u8bf4\u660e","text":""},{"location":"engineering/environment/#1","title":"1. \u8fd0\u884c\u65f6\u73af\u5883","text":"<ul> <li>\u8bed\u8a00\uff1aPython 3.11.x</li> <li>\u64cd\u4f5c\u7cfb\u7edf\uff1a</li> <li>\u63a8\u8350\uff1aWindows 11</li> <li>\u5c3d\u91cf\u4fdd\u6301\u5bf9 Linux / macOS \u7684\u517c\u5bb9\uff08\u4e0d\u4f7f\u7528\u5e73\u53f0\u7279\u5b9a\u8def\u5f84\u6216 API\uff09</li> </ul>"},{"location":"engineering/environment/#2","title":"2. \u5de5\u5177\u94fe","text":"<ul> <li>\u4f9d\u8d56\u4e0e\u865a\u62df\u73af\u5883\u7ba1\u7406\uff1a<code>uv</code></li> <li>\u7248\u672c\u63a7\u5236\uff1aGit\uff08\u63a8\u8350 Git 2.30+\uff09</li> <li>GUI \u6846\u67b6\uff1aPySide6</li> <li>\u6d4b\u8bd5\u6846\u67b6\uff1apytest</li> <li>\u4ee3\u7801\u98ce\u683c\u4e0e\u9759\u6001\u68c0\u67e5\uff08\u5efa\u8bae\uff09\uff1a</li> <li>black</li> <li>ruff</li> <li>mypy\uff08\u53ef\u9009\uff09</li> </ul>"},{"location":"engineering/environment/#3","title":"3. \u5b89\u88c5\u6b65\u9aa4","text":"<p>\u5728\u9879\u76ee\u6839\u76ee\u5f55\uff1a</p> <pre><code># \u5b89\u88c5\u4f9d\u8d56 / \u521b\u5efa\u865a\u62df\u73af\u5883\nuv sync\n````\n\n`uv` \u4f1a\u6839\u636e `pyproject.toml` \u5b89\u88c5\u8fd0\u884c\u65f6\u548c\u5f00\u53d1\u4f9d\u8d56\uff0c\u5e76\u521b\u5efa\u865a\u62df\u73af\u5883\u3002\n\n## 4. \u5e38\u7528\u547d\u4ee4\n\n\u5728\u9879\u76ee\u6839\u76ee\u5f55\u6267\u884c\uff1a\n\n```bash\n# \u8fd0\u884c\u5e94\u7528\uff08\u6682\u5b9a\u5165\u53e3\uff0c\u540e\u7eed\u53ef\u6839\u636e ui \u6a21\u5757\u8bbe\u8ba1\u8c03\u6574\uff09\nuv run python -m ds_vis.ui.main_window\n\n# \u8fd0\u884c\u6d4b\u8bd5\uff08\u81ea\u52a8\u5305\u542b\u8986\u76d6\u7387\u62a5\u544a\uff09\nuv run pytest\n\n# \u4ee3\u7801\u683c\u5f0f\u5316\u4e0e Lint \u4fee\u590d\nuv run ruff check --fix src tests\n\n# \u9759\u6001\u7c7b\u578b\u68c0\u67e5\nuv run mypy src\n</code></pre> <p>\u4ee5\u4e0a\u547d\u4ee4\u7684\u53ef\u7528\u6027\u4f9d\u8d56\u4e8e <code>pyproject.toml</code> \u4e2d\u5bf9\u76f8\u5e94\u5de5\u5177\u7684\u914d\u7f6e\u3002</p>"},{"location":"engineering/environment/#5","title":"5. \u7ea6\u5b9a","text":"<ol> <li> <p>\u6240\u6709\u5f00\u53d1\u4e0e\u8fd0\u884c\u5747\u5e94\u5728 uv \u521b\u5efa\u7684\u865a\u62df\u73af\u5883\u4e2d\u8fdb\u884c\uff0c\u907f\u514d\u6c61\u67d3\u7cfb\u7edf Python\u3002</p> </li> <li> <p>\u4e0d\u5efa\u8bae\u4f7f\u7528\u5168\u5c40 <code>pip install</code> \u4fee\u6539\u73af\u5883\u3002</p> </li> <li> <p>\u5982\u9700\u6dfb\u52a0\u65b0\u4f9d\u8d56\uff0c\u5e94\u901a\u8fc7\uff1a</p> </li> </ol> <pre><code>uv add &lt;package-name&gt;\n</code></pre> <p>\u5e76\u63d0\u4ea4\u66f4\u65b0\u540e\u7684 <code>pyproject.toml</code> / <code>uv.lock</code>\u3002</p> <ol> <li>\u6587\u6863\u4e2d\u7684\u547d\u4ee4\u9ed8\u8ba4\u5728\u9879\u76ee\u6839\u76ee\u5f55\u6267\u884c\u3002</li> </ol>"},{"location":"engineering/environment/#6-ci","title":"6. \u6d4b\u8bd5\u4e0e CI \u7b56\u7565","text":"<p>\u672c\u9879\u76ee\u5f3a\u5236\u91c7\u7528 TDD (\u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1) \u6a21\u5f0f\u3002</p> <p>\u8be6\u7ec6\u7684\u5de5\u4f5c\u6d41\u3001\u6d4b\u8bd5\u5206\u5c42\u7b56\u7565\u548c\u6700\u4f73\u5b9e\u8df5\uff0c\u8bf7\u52a1\u5fc5\u9605\u8bfb\uff1a - docs/engineering/tdd_guide.md</p>"},{"location":"engineering/environment/#61-ci-github-actions","title":"6.1 CI \u6d41\u6c34\u7ebf (GitHub Actions)","text":"<p>\u6bcf\u6b21 Push \u6216 PR\uff0cCI \u4f1a\u81ea\u52a8\u6267\u884c\u4ee5\u4e0b\u68c0\u67e5\uff1a 1. Lint: <code>ruff check</code> (\u4ee3\u7801\u98ce\u683c\u4e0e\u8d28\u91cf) 2. Type Check: <code>mypy</code> (\u9759\u6001\u7c7b\u578b\u5b89\u5168) 3. Test: <code>pytest</code> (\u5355\u5143\u4e0e\u96c6\u6210\u6d4b\u8bd5)</p> <p>\u4efb\u4f55 Agent \u63d0\u4ea4\u7684\u4ee3\u7801\u5fc5\u987b\u901a\u8fc7 CI \u68c0\u67e5\u3002</p>"},{"location":"engineering/environment/#62","title":"6.2 \u6d4b\u8bd5\u5206\u7c7b\u4e0e\u5f00\u53d1\u5de5\u4f5c\u6d41","text":"<p>\u8bf7\u53c2\u9605 TDD Guide \u83b7\u53d6\u5173\u4e8e Unit/Integration/E2E \u6d4b\u8bd5\u7684\u5b9a\u4e49\u4ee5\u53ca Red-Green-Refactor \u7684\u5177\u4f53\u6267\u884c\u6b65\u9aa4\u3002</p>"},{"location":"engineering/full_dev_guide/","title":"\u5168\u6d41\u7a0b\u5f00\u53d1\u6307\u5357\uff08Agent \u5feb\u901f\u4e0a\u624b\uff09","text":"<p>\u76ee\u6807\uff1a\u5e2e\u52a9\u65b0 Agent \u4ece\u9700\u6c42\u5230\u4ea4\u4ed8\u5feb\u901f\u843d\u5730\u4e00\u4e2a\u7ed3\u6784/\u547d\u4ee4\uff08\u4ee5 BST/List \u7ecf\u9a8c\u4e3a\u6a21\u677f\uff09\uff0c\u8986\u76d6 Model \u2192 Layout \u2192 SceneGraph \u2192 Renderer/UI \u2192 \u6d4b\u8bd5 \u2192 \u6587\u6863\u3002</p>"},{"location":"engineering/full_dev_guide/#_1","title":"\u5fc5\u8bfb\u6e05\u5355\u4e0e\u6280\u80fd","text":"<ul> <li>\u5fc5\u8bfb\u6587\u6863\uff1a<code>AGENTS.md</code>\uff08\u89d2\u8272/\u7ea2\u7ebf\uff09\u3001<code>project_state.md</code>\uff08\u5f53\u524d\u9636\u6bb5\u4e0e\u9650\u5236\uff09\u3001<code>index.md</code>\uff08\u7248\u672c\u8868\uff09\u3001<code>animation.md</code>\uff08\u72b6\u6001/\u5fae\u6b65\u9aa4\u8303\u5f0f\uff09\u3001<code>model.md</code>\u3001<code>layout.md</code>\u3001<code>scene_graph.md</code>\u3001<code>renderer.md</code>\u3001<code>dev_kb.md</code>\uff08\u5df2\u77e5\u95ee\u9898/\u6d4b\u8bd5\u5f00\u5173\uff09\u3002</li> <li>\u5de5\u5177\u6280\u80fd\uff1a<code>uv</code>\uff08\u5b89\u88c5/\u8fd0\u884c\uff09\u3001pytest/ruff/mypy\u3001<code>rg</code>\uff08\u641c\u7d22\uff09\u3001PySide6 offscreen \u6d4b\u8bd5\uff08\u73af\u5883\u53d8\u91cf <code>QT_QPA_PLATFORM=offscreen</code> \u5df2\u5728\u6d4b\u8bd5\u4e2d\u4f7f\u7528\uff09\u3002</li> <li>\u5fc3\u667a\u6a21\u578b\uff1a\u4e09\u5c42\u5206\u79bb\uff08Model\u2192Layout\u2192Renderer\uff09\uff0c\u8de8\u5c42\u53ea\u7528 Ops\uff1bSceneGraph \u4e3a\u552f\u4e00\u5165\u53e3\uff0c\u547d\u4ee4\u5fc5\u987b\u6821\u9a8c\u3002</li> </ul>"},{"location":"engineering/full_dev_guide/#_2","title":"\u5feb\u901f\u8def\u5f84\uff08\u6b65\u9aa4\u6e05\u5355\uff09","text":"<p>1) \u5bf9\u9f50\u9700\u6c42\u4e0e\u8303\u5f0f    - \u67e5\u9605 <code>project_state.md</code>\u3001<code>animation.md</code>\u3001<code>model.md</code>\uff0c\u786e\u8ba4\u72b6\u6001/\u989c\u8272/\u6d88\u606f\u8303\u5f0f\u4e0e\u5f53\u524d\u9650\u5236\u3002    - \u660e\u786e\u64cd\u4f5c\u96c6\u5408\u4e0e\u5fae\u6b65\u9aa4\u7c92\u5ea6\uff08\u6559\u5b66\u7ea7 L2\uff1a\u6bd4\u8f83/\u51b3\u7b56/\u79fb\u52a8/\u91cd\u8fde/\u6062\u590d\uff09\u3002 2) \u5148\u5199\u6d4b\u8bd5\uff08TDD\uff09    - \u8986\u76d6\uff1a\u6b63/\u8bef\u8f93\u5165\u3001ID/\u8fb9\u7a33\u5b9a\u6027\u3001\u72b6\u6001/\u6d88\u606f\u5173\u952e\u65ad\u8a00\u3001\u8fb9\u754c\u6848\u4f8b\u3002    - \u5982\u679c\u529f\u80fd\u672a\u5b9e\u73b0\uff0c\u7528 <code>xfail</code> \u9501\u5b9a\u9884\u671f\u3002 3) \u6ce8\u518c\u547d\u4ee4\u4e0e\u6a21\u578b    - \u5728 <code>command_schema.py</code> \u7528 <code>register_command</code> \u6ce8\u518c CommandType + kind \u2192 schema + model_op\u3002    - \u82e5\u65b0 kind\uff1a\u7528 <code>register_model_factory</code> \u6ce8\u518c\u5de5\u5382\uff0c\u907f\u514d SceneGraph \u786c\u7f16\u7801\u3002 4) \u5b9e\u73b0 Model    - <code>kind</code>/<code>apply_operation</code>/ID \u4e0e edge key \u7a33\u5b9a\uff1b\u751f\u6210\u7ed3\u6784 Ops\uff08\u4e0d\u542b SET_POS\uff09\u3002    - \u6309 <code>animation.md</code> \u62c6\u5fae\u6b65\u9aa4\uff1a\u8def\u5f84 secondary\uff0c\u9ad8\u4eae\u5173\u952e\u8282\u70b9/\u8fb9\uff0c\u7ed3\u675f\u7edf\u4e00 Restore + CLEAR_MESSAGE\u3002    - \u5220\u9664/\u91cd\u8fde\u8981\u540c\u6b65\u5185\u5b58\u62d3\u6251\u4e0e Ops\uff08\u5148\u5220\u65e7\u8fb9\uff0c\u518d\u91cd\u8fde\uff0c\u518d\u5220\u8282\u70b9\uff09\u3002 5) \u63a5\u5165 Layout    - \u786e\u8ba4 SceneGraph \u4e2d kind\u2192LayoutStrategy \u8def\u7531\uff08LINEAR/TREE/DAG \u5360\u4f4d\uff09\u548c per-structure <code>(dx, dy)</code> \u504f\u79fb\u3002    - \u82e5\u9700\u65b0\u7b56\u7565\uff0c\u6269\u5c55 LayoutEngine \u5e76\u66f4\u65b0\u8def\u7531\uff1b\u786e\u4fdd\u4e0d\u4e0e\u73b0\u6709\u7ed3\u6784\u91cd\u53e0\u3002 6) Renderer/UI/Dev Hook    - PySide6Renderer\uff1a\u9075\u5faa\u72b6\u6001/\u6d88\u606f\u8bed\u4e49\uff1b\u6d88\u606f\u5f53\u524d\u951a\u5b9a\u573a\u666f bbox \u9876\u90e8\u3002    - UI\uff1a\u6dfb\u52a0 Dev \u83dc\u5355\u5192\u70df Hook\uff08create/insert/search/delete \u7b49\u4e32\u8054\uff09\uff0c\u4fbf\u4e8e\u4eba\u5de5\u9a8c\u6536\u3002 7) DSL/JSON/LLM \u63a5\u53e3    - JSON\uff1a\u786e\u4fdd Command schema \u5f80\u8fd4\uff1bdsl/parser \u76ee\u524d\u63a5\u53d7 JSON \u5360\u4f4d\u3002    - LLM\uff1a\u63a5\u53e3\u5728 <code>llm/adapter.py</code>\uff0c\u6309\u9700\u6269\u5c55 prompt/\u5ba2\u6237\u7aef\uff0c\u4f46\u4fdd\u6301\u53ef\u9009\u3002 8) \u9a8c\u8bc1\u4e0e\u63d0\u4ea4    - \u8fd0\u884c <code>uv run ruff check</code>, <code>uv run mypy src</code>, <code>uv run pytest</code>\uff08\u5fc5\u8981\u65f6\u8bbe\u7f6e <code>UV_CACHE_DIR</code>\uff09\u3002    - \u66f4\u65b0\u6587\u6863\uff1a<code>project_state.md</code>\uff08\u72b6\u6001/\u91cc\u7a0b\u7891\uff09\u3001<code>index.md</code>\uff08\u7248\u672c\u8868\uff09\u3001\u76f8\u5173\u8bbe\u8ba1\u6587\u6863\uff08animation/model/layout/scene_graph/renderer\uff09\u3001\u5982\u6709\u65b0\u589e\u6307\u5357/DSL/JSON/LLM \u8865\u5145\u5bf9\u5e94\u6587\u4ef6\u3002    - \u68c0\u67e5\u524d\u7f6e\u5143\u6570\u636e\uff08front matter\uff09\u4e0e registry \u7248\u672c\u4e00\u81f4\u3002</p>"},{"location":"engineering/full_dev_guide/#_3","title":"\u8be6\u7ec6\u6d41\u7a0b\uff08\u5e26\u68c0\u67e5\u70b9\uff09","text":"<ul> <li>\u9700\u6c42\u62c6\u89e3\uff1a\u628a\u64cd\u4f5c\u62c6\u6210\u5fae\u6b65\u9aa4\u5217\u8868\uff08L2\uff09\uff1b\u6807\u8bb0\u6bcf\u6b65\u7684\u72b6\u6001\u503c\u548c\u6d88\u606f\u6587\u6848\u3002</li> <li>Schema \u6ce8\u518c\uff1a\u65b0\u589e\u547d\u4ee4/\u6a21\u578b\u524d\uff0c\u5148\u5728 <code>command_schema.py</code> \u6ce8\u518c schema \u548c factory\uff0c\u8dd1 <code>tests/core/test_command_validation.py</code>\u3002</li> <li>Model \u5b9e\u73b0\uff1a</li> <li>ID/\u8fb9 key \u7a33\u5b9a\uff08\u7528 allocator\uff1b\u8fb9\u7528 <code>edge_id(kind, src, dst)</code>\uff09\u3002</li> <li>\u64cd\u4f5c\u6d41\u7a0b\uff1a\u5b9a\u4f4d\u8def\u5f84 \u2192 \u6807\u8bb0\u72b6\u6001/\u6d88\u606f \u2192 \u7ed3\u6784\u6539\u52a8\uff08\u521b\u5efa/\u5220\u9664/\u91cd\u8fde/\u6539 label\uff09\u2192 Restore\uff08\u8282\u70b9/\u8fb9/\u6d88\u606f\uff09\u3002</li> <li>\u5185\u5b58\u62d3\u6251\u4e0e Ops \u540c\u6b65\uff1a\u5220\u8fb9\u524d\u65ad\u6307\u9488\uff0c\u91cd\u8fde\u540e\u5199 parent/child\uff0c\u6700\u540e\u5220\u8282\u70b9\u3002</li> <li>Layout \u63a5\u5165\uff1a</li> <li>\u786e\u8ba4 kind \u8def\u7531\u4e0e\u504f\u79fb\uff1b\u82e5\u65b0\u589e\u7b56\u7565\u9700\u8865 LayoutEngine \u5e76\u5728 SceneGraph \u6ce8\u518c\u3002</li> <li>\u907f\u514d\u91cd\u53e0\uff1a\u540c\u7b56\u7565\u591a\u7ed3\u6784\u8981\u53e0\u52a0\u504f\u79fb\uff1b\u5fc5\u8981\u65f6\u5728\u6587\u6863\u6807\u6ce8 TODO\u3002</li> <li>Renderer/UI\uff1a</li> <li>\u6d88\u606f\u951a\u70b9\u5f53\u524d\u7528\u573a\u666f bbox \u9876\u90e8\uff1b\u5982\u9700\u53d8\u66f4\u8bf7\u540c\u6b65 renderer \u6587\u6863\u3002</li> <li>Dev Hook\uff1a\u5728 UI Dev \u83dc\u5355\u6dfb\u52a0\u4e32\u8054\u547d\u4ee4\uff0c\u4fbf\u4e8e\u5192\u70df\uff1b\u4fdd\u6301 duration \u9002\u4e2d\uff08\u5173\u952e\u52a8\u753b\u53ef\u77ed\uff09\u3002</li> <li>DSL/JSON/LLM\uff1a\u4fdd\u6301 JSON \u534f\u8bae\u517c\u5bb9\uff1bDSL \u4ecd\u662f\u5360\u4f4d\uff0c\u52ff\u6df7\u7528\u771f\u5b9e\u8bed\u6cd5\uff1bLLM \u4ec5\u63a5\u53e3\u3002</li> <li>\u6587\u6863\u540c\u6b65\uff1a\u4ee3\u7801\u53d8\u66f4\u6d89\u53ca\u534f\u8bae/\u6d41\u7a0b\u65f6\uff0c\u66f4\u65b0\u8bbe\u8ba1\u6587\u6863 + <code>index.md</code> \u7248\u672c\u53f7 + <code>project_state.md</code> \u9636\u6bb5\u8bf4\u660e\u3002</li> </ul>"},{"location":"engineering/full_dev_guide/#_4","title":"\u5e38\u89c1\u5751\u4f4d\u4e0e\u9632\u5fa1","text":"<ul> <li>\u72b6\u6001\u6062\u590d\u9057\u7559\uff1a\u67e5\u627e/\u5220\u9664\u8def\u5f84\u7684\u8282\u70b9\u4e0e\u8fb9\u9700\u5728\u672b\u5c3e\u6062\u590d normal\uff0c\u6d88\u606f\u9700 CLEAR\u3002</li> <li>\u62d3\u6251\u540c\u6b65\uff1aDELETE/\u91cd\u8fde\u9700\u540c\u65f6\u66f4\u65b0\u5185\u5b58 parent/child \u6307\u9488\u4e0e Ops\uff0c\u907f\u514d\u6e32\u67d3\u6b8b\u7559\u3002</li> <li>\u5e03\u5c40\u6df7\u6392\uff1a\u591a\u7ed3\u6784\u5171\u5b58\u65f6\u6ce8\u610f\u504f\u79fb/\u5206\u533a\uff0c\u907f\u514d SET_POS \u51b2\u7a81\uff1b\u5fc5\u8981\u65f6\u6807\u6ce8 TODO\u3002</li> <li>\u963b\u585e\u52a8\u753b\uff1a\u957f\u94fe/\u5927\u6811\u4f1a\u5361 UI\uff0c\u63a7\u5236 <code>duration_ms</code> / <code>max_frames</code>\uff0c\u5173\u952e\u5192\u70df\u6d4b\u8bd5\u53ef\u51cf\u901f\u4f46\u4fdd\u6301\u8986\u76d6\u3002</li> <li>\u6587\u6863\u7248\u672c\uff1a\u5fd8\u8bb0\u540c\u6b65 <code>index.md</code> / front matter \u4f1a\u5bfc\u81f4\u540e\u7eed Agent \u8bef\u5224\u72b6\u6001\u3002</li> </ul>"},{"location":"engineering/full_dev_guide/#_5","title":"\u8c03\u8bd5\u4e0e\u95ee\u9898\u5b9a\u4f4d\u63d0\u793a","text":"<ul> <li>\u590d\u73b0\u6700\u5c0f\u5316\uff1a\u7f16\u5199/\u8c03\u6574 Dev Hook\uff0c\u628a\u95ee\u9898\u7f29\u5230 2\u20133 \u4e2a\u547d\u4ee4\uff1b\u6216\u7528 JSON/DSL CLI \u91cd\u653e\u3002</li> <li>\u67e5\u770b Ops\uff1a\u5728 Model \u91cc\u6682\u5b58/\u6253\u5370\uff08\u8c03\u8bd5\u65f6\uff09\u751f\u6210\u7684 Timeline\uff0c\u786e\u8ba4 CREATE/DELETE/SET_STATE/SET_LABEL \u987a\u5e8f\u6b63\u786e\u3002</li> <li>\u8fb9/\u6307\u9488\u95ee\u9898\uff1a\u4f18\u5148\u68c0\u67e5\u5185\u5b58\u62d3\u6251\uff08parent/child\uff09\u4e0e <code>_op_delete_edge</code>/<code>_op_create_edge</code> \u8c03\u7528\u987a\u5e8f\u662f\u5426\u4e00\u81f4\u3002</li> <li>\u6d88\u606f/\u72b6\u6001\u6b8b\u7559\uff1a\u786e\u8ba4 Restore \u6b65\u9aa4\u5305\u542b\u6240\u6709 visited \u8282\u70b9\u4e0e traversed \u8fb9\uff0c\u5e76 CLEAR_MESSAGE\u3002</li> <li>Layout \u91cd\u53e0\uff1a\u68c0\u67e5 SceneGraph \u504f\u79fb\u8868\u4e0e LayoutStrategy \u8def\u7531\uff1b\u5fc5\u8981\u65f6\u8c03\u5927 <code>(dx, dy)</code> \u6216\u6dfb\u52a0 TODO\u3002</li> <li>PySide6 \u6d4b\u8bd5\u6027\u80fd\uff1a\u53c2\u8003 <code>dev_kb.md</code> \u7684\u52a8\u753b\u52a0\u901f/\u7981\u7528\u7b56\u7565\uff1b\u5982\u5361\u987f\uff0c\u7f29\u77ed <code>duration_ms</code>\u3002</li> <li>CI/\u5de5\u5177\uff1a<code>uv run ruff check</code>\uff08\u98ce\u683c/\u9519\u8bef\uff09\uff0c<code>uv run mypy src</code>\uff08\u7c7b\u578b\uff09\uff0c<code>uv run pytest</code>\uff08\u5168\u91cf\uff09\uff1b\u9047\u5230 uv \u7f13\u5b58\u6743\u9650\u53ef\u8bbe\u7f6e <code>UV_CACHE_DIR=./tmp/uv-cache</code>\u3002</li> </ul>"},{"location":"engineering/full_dev_guide/#_6","title":"\u5982\u4f55\u907f\u514d\u6f02\u79fb","text":"<ul> <li>\u5148\u8bfb\u540e\u6539\uff1a\u4fee\u6539\u4efb\u4f55\u6838\u5fc3\u8def\u5f84\u524d\u518d\u6b21\u786e\u8ba4 <code>project_state.md</code> \u4e0e <code>index.md</code>\uff0c\u786e\u4fdd\u4e0d\u8986\u76d6\u4ed6\u4eba\u6700\u65b0\u7ea6\u5b9a\u3002</li> <li>\u5c0f\u6b65\u63d0\u4ea4\uff1a\u6bcf\u6b21\u53ea\u6539\u4e00\u4e2a\u4e3b\u9898\uff08\u5982\u201cBST \u5220\u9664\u4fee\u590d\u201d\uff09\uff0c\u9644\u5e26\u5bf9\u5e94\u6d4b\u8bd5\u548c\u6587\u6863\u884c\u3002</li> <li>\u663e\u5f0f\u5047\u8bbe\uff1a\u65b0\u9650\u5236/\u5047\u8bbe\u5199\u5165 <code>project_state.md</code> \u6216 <code>dev_kb.md</code>\uff0c\u907f\u514d\u9690\u6027\u77e5\u8bc6\u3002</li> <li>\u4e00\u81f4\u7684\u72b6\u6001/\u989c\u8272\u547d\u540d\uff1a\u590d\u7528 <code>animation.md</code> \u63a8\u8350\u72b6\u6001\uff0c\u907f\u514d\u81ea\u9020\u72b6\u6001\u5b57\u7b26\u4e32\u3002</li> <li>\u6ce8\u518c\u8868\u5355\u4e00\u5165\u53e3\uff1a\u65b0\u589e\u547d\u4ee4/\u6a21\u578b\u53ea\u6539 <code>command_schema.py</code> \u4e0e\u6ce8\u518c\u51fd\u6570\uff0c\u907f\u514d\u6563\u843d\u786c\u7f16\u7801\u3002</li> </ul>"},{"location":"engineering/full_dev_guide/#_7","title":"\u8d44\u6e90\u4e0e\u67e5\u627e\u8def\u5f84","text":"<ul> <li>\u534f\u8bae/\u8bed\u4e49\uff1a<code>docs/design/ops_spec.md</code>\u3002</li> <li>\u72b6\u6001/\u52a8\u753b\u8303\u5f0f: <code>docs/design/animation.md</code>\u3002</li> <li>\u6a21\u578b\u5f00\u53d1\u6a21\u677f\uff1a<code>docs/design/model.md</code>\u3002</li> <li>SceneGraph \u8def\u7531/\u6ce8\u518c\uff1a<code>docs/design/scene_graph.md</code>\u3002</li> <li>Layout \u504f\u79fb\u4e0e\u7b56\u7565\uff1a<code>docs/design/layout.md</code>\u3002</li> <li>Renderer \u884c\u4e3a/\u6d88\u606f\u951a\u70b9\uff1a<code>docs/design/renderer.md</code>\u3002</li> <li>\u95ee\u9898\u6392\u67e5\uff1a<code>docs/engineering/dev_kb.md</code>\uff08\u6d4b\u8bd5\u5f00\u5173\u3001\u5df2\u77e5\u5751\uff09\u3002</li> </ul>"},{"location":"engineering/tdd_guide/","title":"TDD Guide \u2014 \u6d4b\u8bd5\u9a71\u52a8\u5f00\u53d1\u6307\u5357","text":"<p>\u65b0\u4eba\u5373\u7528\uff1a\u65e0\u987b\u989d\u5916\u63d0\u793a\uff0c\u9ed8\u8ba4\u6240\u6709\u6539\u52a8\u8d70 TDD\u3002\u5148\u5199\uff08\u6216\u66f4\u65b0\uff09\u6d4b\u8bd5\uff0c\u518d\u5b9e\u73b0\uff0c\u518d\u91cd\u6784\uff0c\u4fdd\u6301 CI \u547d\u4ee4\u901a\u8fc7\uff08\u53c2\u89c1 <code>.github/pull_request_template.md</code>\uff09\u3002 \u539f\u5219: \"No Production Code Without a Failing Test.\"</p> <p>\u672c\u9879\u76ee\u5f3a\u5236\u91c7\u7528 TDD (Test-Driven Development)\uff1a - \u4fdd\u969c\u590d\u6742\u5206\u5c42\uff08Model \u2192 Layout \u2192 Renderer \u2192 UI\uff09\u4e0b\u7684\u884c\u4e3a\u53ef\u8bc1\u3002 - \u5c06\u9700\u6c42\u843d\u5728\u201c\u53ef\u6267\u884c\u7684\u89c4\u683c\u201d\u4e0a\uff1a\u65b0\u589e\u529f\u80fd=\u65b0\u589e/\u66f4\u65b0\u6d4b\u8bd5\u3002 \u4ec5\u5f53\u6587\u6863(\u89c1\u4e0b\u6587)\u660e\u786e\u8c41\u514d\u65f6\uff08\u4f8b\u5982\u4e00\u6b21\u6027\u811a\u624b\u67b6\u3001\u5916\u90e8\u4f9d\u8d56\u96be\u4ee5 mock\uff09\uff0c\u624d\u53ef\u6682\u7f13\uff0c\u4f46\u4ecd\u9700\u7559\u4e0b <code>xfail</code> \u6216 TODO \u8bf4\u660e\u3002</p>"},{"location":"engineering/tdd_guide/#1-tdd-the-loop","title":"1. TDD \u6838\u5fc3\u5faa\u73af (The Loop)","text":"<p>\u6211\u4eec\u5728\u6807\u51c6 Red-Green-Refactor \u7684\u57fa\u7840\u4e0a\uff0c\u7ed3\u5408\u672c\u9879\u76ee\u7684 <code>xfail</code> \u5b9e\u8df5\uff0c\u5b9a\u4e49\u4e86\u4ee5\u4e0b\u5de5\u4f5c\u6d41\uff1a</p>"},{"location":"engineering/tdd_guide/#phase-1-red","title":"\ud83d\udd34 Phase 1: Red (\u7f16\u5199\u5931\u8d25\u7684\u6d4b\u8bd5)","text":"<ol> <li>\u660e\u786e\u76ee\u6807: \u4f60\u8981\u5b9e\u73b0\u4ec0\u4e48\u529f\u80fd\uff1f\uff08\u4f8b\u5982\uff1aBST \u65cb\u8f6c\u3001\u53cc\u5411\u94fe\u8868\u5220\u9664\uff09\u3002</li> <li>\u5b9a\u4f4d\u6d4b\u8bd5\u6587\u4ef6:</li> <li>\u7eaf\u903b\u8f91 (Model/Layout): \u5728 <code>tests/core/</code> \u4e0b\u65b0\u5efa\u6216\u4fee\u6539\u3002</li> <li>\u6e32\u67d3/\u89c6\u89c9 (Renderer): \u5728 <code>tests/renderers/</code> \u4e0b\u65b0\u5efa\u6216\u4fee\u6539\u3002</li> <li>\u96c6\u6210/\u5192\u70df (UI/Flow): \u5728 <code>tests/ui/</code> \u6216 <code>tests/core/test_scene_graph_flow.py</code>\u3002</li> <li>\u7f16\u5199\u6d4b\u8bd5\u7528\u4f8b:</li> <li>\u6a21\u62df\u8f93\u5165 (Command / Ops)\u3002</li> <li>\u65ad\u8a00\u9884\u671f\u8f93\u51fa (Timeline / Node Position / ID Stability)\u3002</li> <li>\u6807\u8bb0\u4e3a xfail (\u53ef\u9009\u4f46\u63a8\u8350):</li> <li>\u5982\u679c\u4f60\u6253\u7b97\u5206\u6b65\u63d0\u4ea4\uff0c\u6216\u8005\u8fd9\u662f\u4e00\u4e2a\u5df2\u77e5\u4f46\u6682\u672a\u4fee\u590d\u7684 Bug\uff0c\u4f7f\u7528 <code>@pytest.mark.xfail(reason=\"P0.x: Feature pending\")</code>\u3002</li> <li>\u8fd9\u6837 CI \u4f9d\u7136\u662f\u7eff\u7684\uff0c\u4f46\u660e\u786e\u8bb0\u5f55\u4e86\u201c\u6b20\u503a\u201d\u3002</li> <li>\u8fd0\u884c\u6d4b\u8bd5: \u786e\u8ba4\u5b83\u786e\u5b9e\u5931\u8d25\u4e86\uff08\u6216\u8005 xfail \u4e86\uff09\u3002    <pre><code>uv run pytest tests/path/to/your_test.py\n</code></pre></li> </ol>"},{"location":"engineering/tdd_guide/#phase-2-green","title":"\ud83d\udfe2 Phase 2: Green (\u8ba9\u6d4b\u8bd5\u901a\u8fc7)","text":"<ol> <li>\u7f16\u5199\u6700\u5c0f\u5b9e\u73b0:</li> <li>\u4e0d\u8981\u8fc7\u5ea6\u8bbe\u8ba1\u3002</li> <li>\u53ea\u5199\u80fd\u8ba9\u6d4b\u8bd5\u901a\u8fc7\u7684\u6700\u5c11\u4ee3\u7801\u3002</li> <li>\u8fd0\u884c\u6d4b\u8bd5:</li> <li>\u786e\u4fdd\u521a\u624d\u5199\u7684\u6d4b\u8bd5\u53d8\u7eff (Passed)\u3002</li> <li>\u786e\u4fdd\u6ca1\u6709\u7834\u574f\u5176\u4ed6\u6d4b\u8bd5 (Regression Check)\u3002</li> <li>\u79fb\u9664 xfail: \u5982\u679c\u4e4b\u524d\u52a0\u4e86\u6807\u8bb0\uff0c\u73b0\u5728\u5220\u6389\u5b83\u3002</li> </ol>"},{"location":"engineering/tdd_guide/#phase-3-refactor","title":"\ud83d\udd35 Phase 3: Refactor (\u91cd\u6784)","text":"<ol> <li>\u4f18\u5316\u4ee3\u7801:</li> <li>\u6d88\u9664\u91cd\u590d\u3002</li> <li>\u63d0\u5347\u53ef\u8bfb\u6027\u3002</li> <li>\u4f18\u5316\u7b97\u6cd5\u6548\u7387\u3002</li> <li>\u4fdd\u6301\u6d4b\u8bd5\u901a\u8fc7: \u91cd\u6784\u8fc7\u7a0b\u4e2d\u968f\u65f6\u8fd0\u884c\u6d4b\u8bd5\uff0c\u786e\u4fdd\u5b89\u5168\u7f51\u6709\u6548\u3002</li> </ol>"},{"location":"engineering/tdd_guide/#2","title":"2. \u6d4b\u8bd5\u5206\u5c42\u7b56\u7565\uff08\u76ee\u5f55\u7ed1\u5b9a\uff09","text":"\u5c42\u7ea7 \u76ee\u5f55 \u5173\u6ce8\u70b9 \u4f9d\u8d56\u9650\u5236 Unit (Model) <code>tests/core/models/</code> ID \u751f\u6210\u3001\u6307\u9488\u91cd\u8fde\u3001\u7b97\u6cd5\u903b\u8f91 \u7981\u6b62\u4f9d\u8d56 SceneGraph/Renderer Unit (Layout) <code>tests/core/layout/</code> \u5750\u6807\u8ba1\u7b97\u3001\u95f4\u8ddd\u3001\u91cd\u53e0\u68c0\u6d4b \u7981\u6b62\u4f9d\u8d56 SceneGraph/Renderer Integration (SceneGraph+Layout) <code>tests/core/test_scene_graph_flow.py</code> Command -&gt; Timeline \u5168\u94fe\u8def \u5141\u8bb8 Model + Layout Visual <code>tests/renderers/</code> Timeline -&gt; QGraphicsScene \u5141\u8bb8 Qt (offscreen) UI / Smoke <code>tests/ui/</code> MainWindow dev hook\u3001\u83dc\u5355\u89e6\u53d1 \u5141\u8bb8 QApplication"},{"location":"engineering/tdd_guide/#3-tdd-strategy-by-layer","title":"3. TDD \u9002\u7528\u6027\u7b56\u7565 (Strategy by Layer)","text":"<p>\u5e76\u975e\u6240\u6709\u4ee3\u7801\u90fd\u9002\u5408\u4e25\u683c\u7684 TDD\u3002\u4e3a\u4e86\u5e73\u8861\u5f00\u53d1\u6548\u7387\u4e0e\u8d28\u91cf\uff0c\u8bf7\u9075\u5faa\u4ee5\u4e0b\u7b56\u7565\uff1a</p>"},{"location":"engineering/tdd_guide/#model-layout-scenegraph","title":"\u6838\u5fc3\u5f15\u64ce\u5c42 (Model / Layout / SceneGraph)","text":"<p>\u7b56\u7565\uff1a\u4e25\u683c TDD (Strict TDD) - \u5148\u5199\u6d4b\u8bd5\uff0c\u8986\u76d6\u6210\u529f/\u9519\u8bef\u8def\u5f84\uff1b\u65b0\u589e\u547d\u4ee4/\u5904\u7406\u5668\u65f6\u5fc5\u987b\u6709\u8d1f\u4f8b\u3002</p>"},{"location":"engineering/tdd_guide/#renderer-pyside6","title":"\u6e32\u67d3\u5c42 (Renderer: PySide6)","text":"<p>\u7b56\u7565\uff1a\u5c5e\u6027\u65ad\u8a00 TDD (Property Assertion TDD) - \u6d4b scene item \u5c5e\u6027\uff08<code>pos()</code>, <code>color</code>, <code>text</code>\uff09\uff0c\u4e0d\u505a\u622a\u56fe\u5bf9\u6bd4\u3002</p>"},{"location":"engineering/tdd_guide/#ui-ui-mainwindow-menu-dialogs","title":"UI \u5c42 (UI: MainWindow / Menu / Dialogs)","text":"<p>\u7b56\u7565\uff1a\u5192\u70df\u6d4b\u8bd5 (Smoke Only) - \u786e\u4fdd\u542f\u52a8/\u83dc\u5355\u89e6\u53d1/\u5173\u95ed\u65e0\u5d29\u6e83\uff1b\u590d\u6742\u903b\u8f91\u4e0b\u6c89\u5230 core \u53ef\u6d4b\u8bd5\u5c42\uff08Humble Object Pattern\uff09\u3002</p>"},{"location":"engineering/tdd_guide/#4-best-practices","title":"4. \u6700\u4f73\u5b9e\u8df5 (Best Practices)","text":""},{"location":"engineering/tdd_guide/#41-xfail","title":"4.1 \u4f7f\u7528 <code>xfail</code> \u9501\u5b9a\u9700\u6c42","text":"<p>\u5728\u5f00\u53d1\u590d\u6742\u529f\u80fd\uff08\u5982 P0.3 \u7684 ID \u7a33\u5b9a\u6027\uff09\u65f6\uff0c\u5148\u5199\u4e00\u4e2a <code>xfail</code> \u6d4b\u8bd5\u6765\u5b9a\u4e49\u201c\u5b8c\u6210\u7684\u6807\u51c6\u201d\u3002 <pre><code>@pytest.mark.xfail(reason=\"P0.3: ID stability not implemented yet\")\ndef test_ids_remain_stable_after_delete():\n    # ... assertions ...\n</code></pre> \u8fd9\u76f8\u5f53\u4e8e\u628a\u9700\u6c42\u6587\u6863\u53d8\u6210\u4e86\u53ef\u6267\u884c\u7684\u4ee3\u7801\u3002</p>"},{"location":"engineering/tdd_guide/#42-sleep","title":"4.2 \u907f\u514d \"Sleep\" \u6d4b\u8bd5","text":"<p>\u4e0d\u8981\u5728\u6d4b\u8bd5\u4e2d\u4f7f\u7528 <code>time.sleep()</code> \u7b49\u5f85\u52a8\u753b\u3002 - \u6211\u4eec\u7684\u67b6\u6784\u662f\u57fa\u4e8e Timeline \u7684\u3002 - \u76f4\u63a5\u65ad\u8a00 <code>timeline.steps</code> \u91cc\u7684\u6570\u636e\uff0c\u6216\u8005 <code>renderer</code> \u91cc\u7684\u6700\u7ec8\u72b6\u6001\u3002</p>"},{"location":"engineering/tdd_guide/#43-headless","title":"4.3 Headless \u4f18\u5148","text":"<p>\u6240\u6709\u6d4b\u8bd5\u9ed8\u8ba4\u90fd\u5e94\u8be5\u80fd\u5728\u65e0\u663e\u793a\u5668\u7684\u73af\u5883\u4e0b\u8fd0\u884c\uff08CI \u73af\u5883\uff09\u3002 - \u5c3d\u91cf\u65ad\u8a00 <code>QGraphicsScene</code> \u91cc\u7684 Item \u6570\u636e\uff0c\u800c\u4e0d\u662f\u622a\u56fe\u5bf9\u6bd4\u3002 - \u907f\u514d\u5f39\u51fa\u6a21\u6001\u5bf9\u8bdd\u6846\u3002</p>"},{"location":"engineering/tdd_guide/#44-commanderror","title":"4.4 \u9488\u5bf9 CommandError \u7684\u6d4b\u8bd5","text":"<p>\u4e0d\u8981\u53ea\u6d4b\u201c\u6210\u529f\u8def\u5f84\u201d\u3002\u5fc5\u987b\u6d4b\u8bd5\u201c\u5931\u8d25\u8def\u5f84\u201d\uff1a <pre><code>def test_invalid_command_raises_error(scene_graph):\n    with pytest.raises(CommandError, match=\"Unsupported\"):\n        scene_graph.apply_command(bad_cmd)\n</code></pre></p>"},{"location":"engineering/tdd_guide/#5-agent","title":"5. \u65e5\u5e38\u5de5\u4f5c\u6e05\u5355\uff08\u7ed9\u65b0 Agent\uff09","text":"<ul> <li>\u6539\u4ee3\u7801\u524d\uff1a\u9605\u8bfb <code>AGENTS.md</code>\u3001<code>project_state.md</code>\u3001<code>docs/index.md</code> \u7684 bound phase/version\uff1b\u67e5 <code>dev_kb.md</code> \u5df2\u77e5\u95ee\u9898\u3002</li> <li>\u5148\u5199/\u66f4\u65b0\u6d4b\u8bd5\uff1a\u653e\u5728\u5bf9\u5e94\u76ee\u5f55\uff1b\u5fc5\u8981\u65f6\u5148\u6807\u8bb0 <code>xfail</code>\u3002</li> <li>\u8fd0\u884c\u68c0\u67e5\uff1a<code>uv run ruff check src tests</code>\u3001<code>uv run mypy src</code>\u3001<code>uv run pytest</code>\uff08\u540c PR \u6a21\u677f\uff09\u3002</li> <li>\u4fdd\u6301\u6587\u6863\u540c\u6b65\uff1a\u65b0\u589e\u547d\u4ee4/\u884c\u4e3a\u65f6\u66f4\u65b0 registry \u5bf9\u5e94\u6587\u6863\u7248\u672c\u4e0e\u5143\u6570\u636e\u3002</li> </ul>"},{"location":"engineering/tdd_guide/#6","title":"6. \u5e38\u7528\u547d\u4ee4\u901f\u67e5","text":"<pre><code># \u8fd0\u884c\u6240\u6709\u6d4b\u8bd5\nuv run pytest\n\n# \u8fd0\u884c\u7279\u5b9a\u6587\u4ef6\nuv run pytest tests/core/test_list_model.py\n\n# \u8fd0\u884c\u5305\u542b\u7279\u5b9a\u5173\u952e\u8bcd\u7684\u6d4b\u8bd5 (\u4f8b\u5982\u53ea\u6d4b delete)\nuv run pytest -k \"delete\"\n\n# \u9047\u5230\u7b2c\u4e00\u4e2a\u5931\u8d25\u5c31\u505c\u6b62 (\u5feb\u901f\u53cd\u9988)\nuv run pytest -x\n\n# \u663e\u793a\u8be6\u7ec6\u8f93\u51fa (\u5305\u62ec print)\nuv run pytest -s\n</code></pre>"}]}